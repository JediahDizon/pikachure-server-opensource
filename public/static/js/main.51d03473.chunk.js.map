{"version":3,"sources":["services/pikachure.js","components/context-loading/index.js","components/context-user/index.js","components/context-selected-post/index.js","components/login/index.js","components/settings-user/component.js","components/post/component.js","components/post/index.js","components/post-create/component.js","components/post-create/index.js","components/open-invite-create/component.js","components/open-invite-create/index.js","components/open-invite-list/component.js","components/open-invite-list/index.js","components/post-list/component.js","components/post-list/index.js","components/post-marker/component.js","components/post-marker/index.js","components/place-marker/component.js","components/place-marker/index.js","components/terms-and-conditions/terms-and-conditions.md","components/terms-and-conditions/index.js","components/privacy-policy/privacy-policy.md","components/privacy-policy/index.js","components/map/index.js","components/map-static/index.js","views/root/component.js","views/root/index.js","views/explore/post.js","views/explore/component.js","views/explore/index.js","views/home/component.js","views/home/index.js","views/settings/component.js","views/settings/index.js","views/comments/component.js","views/comments/index.js","index.js"],"names":["URL","this","ContextLoading","React","createContext","ContextUser","ContextSelectedPost","Component","Post","props","state","files","guestGalleryRef","createRef","user","post","minimal","compact","setAutoplay","autoplay","guestVisible","currentSlide","setGuestVisible","menuVisible","setMenuVisible","setCurrentSlide","selectedComment","setSelectedComment","editComment","setEditComment","saveCommentLoading","fileToRemove","setFileToRemove","_","isEmpty","postPhotos","datePosted","cover","place","photos","gallery","id","className","dots","dotPosition","onSwipe","arrows","prevArrow","CaretLeftOutlined","nextArrow","CaretRightOutlined","beforeChange","from","to","lat","lng","renderMapSlide","map","photo","alt","src","name","preview","isObject","justify","align","span","href","Title","level","style","color","margin","Text","openNow","width","opacity","indexOf","undefined","transition","transform","renderGuests","renderDetails","visible","onCancel","footer","bodyStyle","padding","destroyOnClose","maxHeight","overflow","tag","description","Moment","dateCreated","isValid","fromNow","marginTop","TextArea","autoFocus","placeholder","defaultValue","onBlur","value","target","textAlign","onClick","isFunction","onCommentDelete","a","Modal","confirm","title","content","icon","okText","cancelText","onOk","loading","type","disabled","onComment","StaticMap","height","EnvironmentFilled","fontSize","position","top","left","zIndex","guestList","host","concat","guests","filter","split","dataSource","renderItem","Item","justifyContent","onClickProfile","CrownFilled","size","UserOutlined","picture","comment","setComment","uploadPhotoVisibility","setUploadPhotoVisibility","guestGalleryPage","setGuestGalleryPage","savePostPhotoLoading","postsLoading","leavePostLoading","joinPostLoading","postAuthors","isNil","flexWrap","onJoin","SmileFilled","savePostPhoto","AppstoreFilled","current","goTo","CaretDownOutlined","onCommentsClick","MessageFilled","comments","marginBottom","ghost","activeKey","expandIcon","Panel","whiteSpace","guest","index","shape","placement","QuestionCircleFilled","verticalAlign","spinning","indicator","LoadingOutlined","spin","ref","renderGuestGallery","onDelete","onEdit","onLeave","clearTimeout","timeout","setTimeout","SettingFilled","DeleteFilled","EditFilled","FrownFilled","refresh","ReloadOutlined","onPublish","Date","toISOString","setState","owner","marginRight","CheckCircleFilled","format","rows","onChange","SendOutlined","allowUpload","guestPhotos","Array","slice","display","multiple","stateFiles","toConvert","file","push","Promise","resolve","Resizer","imageFileResizer","mimetype","url","createObjectURL","all","toAppend","document","getElementById","chunk","outerIndex","htmlFor","pointerEvents","FileImageFilled","backgroundImage","timeoutCode","backgroundColor","borderRadius","CloseOutlined","toRemove","find","useState","modalVisible","setModalVisible","useContext","zoomDistanceMapping","getZoomDistanceMapping","zoom","key","toNumber","reduce","prev","curr","Math","abs","PostCreate","defaultState","navPages","tooltip","navPage","centered","renderTabBar","tabProps","tabBar","renderHeader","TabPane","renderUploadTab","renderDetailsTab","mentionList","setNavPage","saveLoading","onDraft","marginLeft","max","LeftOutlined","values","onSave","scrollIntoView","behavior","min","setZoom","places","placesLoading","clusterMarkers","Supercluster","minZoom","maxZoom","radius","extent","sum","accumulated","load","markers","getClusters","gutter","plain","orientation","containerStyle","center","onZoomStart","trunc","getZoom","onDragEnd","event","getCenter","easeTo","marker","coordinates","geometry","properties","onSearchPlaces","bottom","isNumber","SearchOutlined","minHeight","Meta","avatar","bordered","first","OpenInviteCreate","renderMapTab","mentionToRemove","setMentionList","setMentionToRemove","searchUsers","searchUsersLoading","coverFiles","afterChange","CaretUpOutlined","border","get","floor","random","image","Empty","PRESENTED_IMAGE_SIMPLE","direction","CloseCircleFilled","stopPropagation","OpenInviteList","displayType","posts","DisplayTypes","GRID","PANEL","isGuestVisible","PostList","onAdd","renderPostsPlaceholder","chunkedPosts","postProps","PlusOutlined","userLoading","PostMarker","PlaceMarker","TermsAndConditions","markdown","setMarkdown","useEffect","fetch","MarkdownDirectory","then","response","text","children","PrivacyPolicy","mapboxgl","workerClass","require","default","MapBox","ReactMapboxGl","accessToken","defaultProps","username","style_id","pitch","bearing","fetchUrl","setFetchUrl","fetchParams","Pikachure","getStaticMap","objectFit","Root","postLoading","ppModal","setPPModal","tsModal","setTSModal","error","GoogleIcon","Icon","component","xmlns","fill","fillRule","d","background","borderBottom","maxWidth","xs","sm","paddingRight","onLogin","tokenId","autoPlay","muted","loop","playsInline","clientId","render","isError","message","onSuccess","onFailure","onError","cookiePolicy","process","rel","closable","queryGetPost","gql","mutationLogin","useQuery","fetchPolicy","variables","queryPostData","data","refetch","useMutation","awaitRefetchQueries","saveUser","setUser","window","scrollTo","localStorage","setItem","activeUser","jwt","complete","sub","console","method","headers","body","JSON","stringify","Provider","loginError","UserBasic","UserHost","Comment","Note","Image","Explore","openInviteMarkersLoading","setOpenInviteMarkersLoading","layout","setDisplayType","openInviteCreateModal","setOpenInviteCreateModal","openInviteEditModal","setOpenInviteEditModal","openInvitePostModal","setOpenInvitePostModal","selectedPost","setSelectedPost","setCenter","centerRef","useRef","selectedCollapse","setSelectedCollapse","openInviteMarkers","userRefetch","match","params","ids","onPostDelete","onPostEdit","onLeavePost","onJoinPost","onSavePostPhoto","getPostProps","documentElement","history","postRefetch","postToDisplay","parallaxData","start","end","startValue","endValue","property","onZoomEnd","openInviteMarkersRefetch","TabletFilled","confirmLoading","toSelect","savePost","search","onSearchUsers","queryUser","queryPosts","queryPlaces","querySearchUsers","mutationSavePost","mutationDeletePost","mutationSaveComment","mutationDeleteComment","mutationSavePostPhoto","mutationLeavePost","mutationJoinPost","mutationSaveUser","queryUserData","queryPostsData","queryPostsLoading","queryPostsError","queryPostRefetch","queryOpenInviteMarkersData","queryOpenInviteMarkersLoading","queryOpenInviteMarkersRefetch","useLazyQuery","queryPlacesRefetch","queryPlacesData","queryPlacesLoading","querySearchUserRefetch","querySearchUsersData","querySearchUsersLoading","refetchQueries","mutationSavePostsLoading","deletePost","saveComment","mutationSaveCommentLoading","deleteComment","mutationDeleteCommentLoading","mutationSavePostPhotoLoading","mutationSaveUserLoading","leavePost","mutationLeavePostLoading","joinPost","mutationJoinPostLoading","deleteCommentLoading","saveUserLoadin","openInvites","location","Home","saveUserLoading","postCreateModal","setPostCreateModal","openInviteModal","setOpenInviteModal","onPostClick","onOpenInviteEdit","result","postedPosts","onAddPost","onAddOpenInvite","fallback","textShadow","click","useHistory","isNull","Settings","setModalVisibility","setName","setTag","feedbackModal","setFeedbackModal","feedback","setFeedback","settingsLoading","sendFeedbackLoading","disableUserLoading","settingKnobs","label","hint","addonBefore","trim","toLowerCase","FontColorsOutlined","apolloClient","cache","reset","replace","goBack","setting","sendFeedback","mutationSaveSettings","mutationSendFeedback","mutationDisableUser","mutationSendFeedbackLoading","disableUser","mutationDisableUserLoading","useApolloClient","Comments","commentsLoading","commentsRefetch","dateModified","queryPost","queryComments","queryCommentsRefetch","queryCommentsData","queryCommentsLoading","queryPostLoading","authLink","setContext","getItem","token","authorization","errorLink","graphQLErrors","networkError","forward","operation","warn","httpLink","HttpLink","uri","uploadLink","createUploadLink","client","ApolloClient","defaultOptions","link","ApolloLink","InMemoryCache","dataIdFromObject","object","__typename","email","cursor","defaultDataIdFromObject","Routes","ConfigProvider","config","theme","primaryColor","exact","path","localToken","verifyRequest","status","removeItem","json","ReactDOM","ApolloProvider","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","reportWebVitals"],"mappings":"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","file":"static/js/main.51d03473.chunk.js","sourcesContent":["class Pikachure {\r\n\tURL = \"\";\r\n\r\n\tconstructor() {\r\n\t\tswitch(process.env.NODE_ENV) {\r\n\t\t\tcase \"production\": {\r\n\t\t\t\tthis.URL = \"https://pikachure-server.online\"\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdefault: \r\n\t\t\tcase \"development\": {\r\n\t\t\t\tthis.URL = \"https://pikachure-server.online\"\r\n\t\t\t\t//this.URL = \"http://192.168.1.109\"\r\n\t\t\t\tthis.URL = \"http://localhost\";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default new Pikachure();","import React from \"react\";\r\n\r\nconst ContextLoading = React.createContext();\r\n\r\nexport default ContextLoading;","import React from \"react\";\r\n\r\nconst ContextUser = React.createContext();\r\n\r\nexport default ContextUser;","import React from \"react\";\r\n\r\nconst ContextSelectedPost = React.createContext();\r\n\r\nexport default ContextSelectedPost;","import React, { Component } from \"react\";\r\nimport { Button } from \"antd\";\r\nimport GoogleLogin from \"react-google-login\";\r\nimport Icon from \"@ant-design/icons\";\r\n\r\nclass Login extends Component {\r\n\trender() {\r\n\t\tconst GoogleIcon = props => <Icon component={() => getGoogleIcon()} {...props} />;\r\n\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<GoogleLogin\r\n\t\t\t\t\tclientId=\"899556945750-5hk7pe4hup0qobi0n9v3lq0efvlgco9g.apps.googleusercontent.com\"\r\n\t\t\t\t\tbuttonText=\"Login\"\r\n\t\t\t\t\trender={() => <Button icon={<GoogleIcon />} size=\"large\">Login</Button>}\r\n\t\t\t\t\tisSignedIn={true}\r\n\t\t\t\t\tonSuccess={() => {}}\r\n\t\t\t\t\tonFailure={() => {}}\r\n\t\t\t\t\tcookiePolicy={\"single_host_origin\"}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nfunction getGoogleIcon() {\r\n\treturn (\r\n\t\t<svg width=\"18\" height=\"18\" xmlns=\"http://www.w3.org/2000/svg\">\r\n\t\t\t<g fill=\"#000\" fill-rule=\"evenodd\">\r\n\t\t\t\t<path d=\"M9 3.48c1.69 0 2.83.73 3.48 1.34l2.54-2.48C13.46.89 11.43 0 9 0 5.48 0 2.44 2.02.96 4.96l2.91 2.26C4.6 5.05 6.62 3.48 9 3.48z\" fill=\"#EA4335\"></path>\r\n\t\t\t\t<path d=\"M17.64 9.2c0-.74-.06-1.28-.19-1.84H9v3.34h4.96c-.1.83-.64 2.08-1.84 2.92l2.84 2.2c1.7-1.57 2.68-3.88 2.68-6.62z\" fill=\"#4285F4\"></path>\r\n\t\t\t\t<path d=\"M3.88 10.78A5.54 5.54 0 0 1 3.58 9c0-.62.11-1.22.29-1.78L.96 4.96A9.008 9.008 0 0 0 0 9c0 1.45.35 2.82.96 4.04l2.92-2.26z\" fill=\"#FBBC05\"></path>\r\n\t\t\t\t<path d=\"M9 18c2.43 0 4.47-.8 5.96-2.18l-2.84-2.2c-.76.53-1.78.9-3.12.9-2.38 0-4.4-1.57-5.12-3.74L.97 13.04C2.45 15.98 5.48 18 9 18z\" fill=\"#34A853\"></path>\r\n\t\t\t\t<path fill=\"none\" d=\"M0 0h18v18H0z\"></path>\r\n\t\t\t</g>\r\n\t\t</svg>\r\n\t);\r\n}\r\n\r\nexport default Login;\r\n\r\n","import { Component } from \"react\";\r\nimport { List } from \"antd\";\r\n\r\nexport  default class Settings extends Component {\r\n\tstate = {\r\n\t\tbackground: \"white\",\r\n\t};\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\tHello World\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n}","import React, { Component } from \"react\";\r\nimport GoogleMapReact from \"google-map-react\";\r\nimport { Button, Row, Col, Carousel, Avatar, List, Modal, Typography, Input, Spin, Collapse, Tooltip, Image } from \"antd\";\r\nimport { AppstoreFilled, SendOutlined, SmileFilled, UserOutlined, CrownFilled, CheckCircleFilled, FileImageFilled, MessageFilled, QuestionCircleFilled, CaretLeftOutlined, CaretRightOutlined, MoreOutlined, DeleteFilled, EditFilled, CaretDownOutlined, CloseOutlined, LoadingOutlined, ReloadOutlined, FrownFilled, EnvironmentFilled, SettingFilled } from '@ant-design/icons';\r\nimport Resizer from \"react-image-file-resizer\";\r\nimport _ from \"lodash\";\r\nimport Moment from \"moment\";\r\n\r\nimport ReactMapGL from 'react-map-gl';\r\n\r\nimport { StaticMap } from \"src/components\";\r\nimport \"./style.css\";\r\nexport default class Post extends Component {\r\n\tstate = {\r\n\t\tfiles: [] // Used for Open Invite posts that lets guests and host upload images\r\n\t};\r\n\t\r\n\tconstructor(props) {\r\n    super(props);\r\n    this.guestGalleryRef = React.createRef();\r\n  }\r\n\r\n\trender() {\r\n\t\tconst { \r\n\t\t\tuser,\r\n\t\t\tpost,\r\n\t\t\tminimal, \r\n\t\t\tcompact,\r\n\t\t\tautoplay, setAutoplay,\r\n\t\t\tguestVisible, setGuestVisible,\r\n\t\t\tmenuVisible, setMenuVisible,\r\n\t\t\tcurrentSlide, setCurrentSlide,\r\n\t\t\tselectedComment, setSelectedComment,\r\n\t\t\teditComment, setEditComment,\r\n\t\t\tsaveCommentLoading,\r\n\t\t\tfileToRemove, setFileToRemove\r\n\t\t} = this.props;\r\n\r\n\t\tif(_.isEmpty(post)) return null;\r\n\t\t\r\n\t\t// If this is an open-invite, show the `Post.cover` photos. Otherwise, show `Post.gallery` photos, `Post.place.photos` or map\r\n\t\t// This indicates that the Post is an open-invite\r\n\t\tlet postPhotos = [];\r\n\t\tif(!_.isEmpty(post.datePosted)) {\r\n\t\t\tif(!_.isEmpty(post.gallery)) postPhotos = post.gallery;\r\n\t\t} else if(!_.isEmpty(post.cover)) {\r\n\t\t\tpostPhotos = post.cover;\r\n\t\t} else if(!_.isEmpty(post.place?.photos)) {\r\n\t\t\tpostPhotos = post.place?.photos;\r\n\t\t}\r\n\r\n\t\t// Show \"Powered By GOogle\" as per the Places API terms and conditions\r\n\t\tconst isPBGVisible = false;\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<div id={post.id} className={`post-container ${minimal ? \"post-container-minimal\" : \"\"}`}>\r\n\t\t\t\t<Carousel \r\n\t\t\t\t\tautoplay={false} \r\n\t\t\t\t\tdots={minimal ? false : true}\r\n\t\t\t\t\tdotPosition=\"bottom\"\r\n\t\t\t\t\tonSwipe={() => !minimal && setAutoplay(false)}\r\n\t\t\t\t\tarrows={minimal ? false : true}\r\n\t\t\t\t\tprevArrow={<CaretLeftOutlined />}\r\n\t\t\t\t\tnextArrow={<CaretRightOutlined />}\r\n\t\t\t\t\tbeforeChange={(from, to) => setCurrentSlide(to)}\r\n\t\t\t\t>\r\n\t\t\t\t\t{ _.isEmpty(post.datePosted) && _.isEmpty(post.cover) && post?.lat && post?.lng ? this.renderMapSlide() : null }\r\n\t\t\t\t\t\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t_.map(postPhotos, photo => (\r\n\t\t\t\t\t\t\t<Image\r\n\t\t\t\t\t\t\t\tkey={typeof photo === \"string\" ? photo : photo.name}\r\n\t\t\t\t\t\t\t\talt=\"post\" \r\n\t\t\t\t\t\t\t\tclassName={`post-image ${minimal ? \"post-image-minimal\" : \"\"}`}\r\n\t\t\t\t\t\t\t\t//onLoad={() => _.isFunction(this.props.onLoad) && this.props.onLoad(post)}\r\n\t\t\t\t\t\t\t\tsrc={typeof photo === \"string\" ? photo : `https://firebasestorage.googleapis.com/v0/b/pikature.appspot.com/o/${photo.name}?alt=media`}\r\n\t\t\t\t\t\t\t\tpreview={!minimal}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t))\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t{ (!_.isEmpty(post.cover) || !_.isEmpty(post.datePosted)) && post?.lat && post?.lng ? this.renderMapSlide() : null }\r\n\t\t\t\t</Carousel>\r\n\r\n\t\t\t\t{\r\n\t\t\t\t\t// This determines if the post is in a certain layout of `Postlist.DisplayTypes.GRID` or `Postlist.DisplayTypes.PANEL`\r\n\t\t\t\t\tminimal ? null : (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t_.isObject(post.place) ? (\r\n\t\t\t\t\t\t\t\t\t<div className={`post-cover-content ${_.isEmpty(post.datePosted) && \"post-cover-content-visible\"}`}>\r\n\t\t\t\t\t\t\t\t\t\t<Row justify=\"space-between\" align=\"start\">\r\n\t\t\t\t\t\t\t\t\t\t\t<Col span={18}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<a href={`https://maps.google.com/?q=${post.place.lat || post.lat},${post.place.lng || post.lng}`}><Typography.Title level={3} style={{ color: \"white\", margin: 0 }}>{post.place.name}</Typography.Title></a>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Typography.Text style={{ color: \"white\" }}>{post.place.openNow ? \"Open\" : \"\"}</Typography.Text>\r\n\t\t\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t\t\t<Col span={6}>\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t_.isEmpty(post.cover) && _.isEmpty(post.datePosted) && !_.isEmpty(post.place?.photos) && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<img \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\talt=\"powered-by-google\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc=\"/powered-by-google.png\" \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ width: \"100%\", opacity: _.isEmpty(post.datePosted) && _.indexOf([undefined, 0], currentSlide) === -1 ? 1 : 0, transition: \"opacity .33s ease-in-out\" }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclassName={`guests-container ${minimal ? \"guests-container-minimal\" : \"\"}`}\r\n\t\t\t\t\t\t\t\tstyle={{ transform: `translate(${guestVisible ? 0 : 200 + \"px\"})`, opacity: guestVisible ? 1 : 0 }}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{ this.renderGuests() }\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t!compact ? (\r\n\t\t\t\t\t\t\t\t\t<div className=\"post-content\" style={{ transform: \"translate(0, -15px)\"}}>\r\n\t\t\t\t\t\t\t\t\t\t{ this.renderDetails() }\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t{/* Modal for editing a comment */}\r\n\t\t\t\t<Modal\r\n\t\t\t\t\tvisible={selectedComment}\r\n\t\t\t\t\tonCancel={() => setSelectedComment()}\r\n\t\t\t\t\t// maskClosable={false}\r\n\t\t\t\t\t// keyboard={false}\r\n\t\t\t\t\tfooter={null}\r\n\t\t\t\t\tbodyStyle={{ padding: 0 }}\r\n\t\t\t\t\tdestroyOnClose\r\n\t\t\t\t>\r\n\t\t\t\t\t<Row style={{ padding: \"20px\", maxHeight: \"calc(100vh - 75px)\", overflow: \"auto\" }}>\r\n\t\t\t\t\t\t<Col span={18}>\r\n\t\t\t\t\t\t\t\t<b>{ selectedComment?.user.tag }</b>\r\n\t\t\t\t\t\t\t\t{ selectedComment?.user.id !== user.id ? \" \" + selectedComment?.description : null }\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t<Col span={6} className=\"comment-date\">\r\n\t\t\t\t\t\t\t<sub>{ Moment(selectedComment?.dateCreated).isValid() ? Moment(selectedComment?.dateCreated).fromNow() : null }</sub>\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tselectedComment?.user.id === user.id ? (\r\n\t\t\t\t\t\t\t\t<Col span={24} style={{ marginTop: \"20px\" }}>\r\n\t\t\t\t\t\t\t\t\t<Input.TextArea\r\n\t\t\t\t\t\t\t\t\t\tautoFocus\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"comment-text\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"Say something...\"\r\n\t\t\t\t\t\t\t\t\t\tdefaultValue={editComment}\r\n\t\t\t\t\t\t\t\t\t\tonBlur={({ target: { value }}) => setEditComment(value)}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</Row>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<div className=\"button-group\" style={{ textAlign: \"right\", padding: \"20px\", overflow: \"auto hidden\" }}>\r\n\t\t\t\t\t\t<Button onClick={() => setSelectedComment()}>Close</Button>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tselectedComment?.user.id !== user.id ? (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t{/*<Button>Report</Button>*/}\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t_.isFunction(this.props.onCommentDelete) ? (\r\n\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={async () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tModal.confirm({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: \"Delete Comment\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontent: \"Are you sure you want to delete this comment? This cannot be undone.\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon: null,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tokText: \"Delete\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcancelText: \"Cancel\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonOk: async () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tawait this.props.onCommentDelete(selectedComment.id, post.id);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetSelectedComment();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\tDelete\r\n\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t<Button \r\n\t\t\t\t\t\t\t\t\t\tloading={saveCommentLoading}\r\n\t\t\t\t\t\t\t\t\t\ttype=\"primary\" \r\n\t\t\t\t\t\t\t\t\t\tdisabled={editComment === selectedComment?.description} \r\n\t\t\t\t\t\t\t\t\t\tonClick={async () => {\r\n\t\t\t\t\t\t\t\t\t\t\tawait this.props.onComment({ id: selectedComment.id, description: editComment }, post.id);\r\n\t\t\t\t\t\t\t\t\t\t\tsetSelectedComment();\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\tSave\r\n\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Modal>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\trenderMapSlide() {\r\n\t\tconst { minimal, post } = this.props;\r\n\r\n\t\treturn (\r\n\t\t\t<Row>\r\n\t\t\t\t<Col span={24} className={`post-map-container ${minimal ? \"post-map-container-minimal\" : \"\"}`}>\r\n\t\t\t\t\t<StaticMap\r\n\t\t\t\t\t\tlat={post?.lat}\r\n\t\t\t\t\t\tlng={post?.lng}\r\n\t\t\t\t\t\t{...minimal ? { height: 200, width: 200 } : {}}\r\n\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t<EnvironmentFilled \r\n\t\t\t\t\t\tstyle={{ \r\n\t\t\t\t\t\t\tfontSize: 40, color: \"var(--ant-primary-color)\",\r\n\t\t\t\t\t\t\tposition: \"absolute\",\r\n\t\t\t\t\t\t\ttop: \"50%\",\r\n\t\t\t\t\t\t\tleft: \"50%\",\r\n\t\t\t\t\t\t\ttransform: \"translate(-50%, -50%)\",\r\n\t\t\t\t\t\t\tzIndex: 10\r\n\t\t\t\t\t\t}} \r\n\t\t\t\t\t/>\r\n\t\t\t\t</Col>\r\n\t\t\t</Row>\r\n\t\t);\r\n\r\n\t\treturn (\r\n\t\t\t<Row>\r\n\t\t\t\t<Col span={24} className={`post-map-container ${minimal ? \"post-map-container-minimal\" : \"\"}`}>\r\n\t\t\t\t\t<GoogleMapReact\r\n\t\t\t\t\t\tid=\"explore-map\"\r\n\t\t\t\t\t\tbootstrapURLKeys={{ \r\n\t\t\t\t\t\t\tkey: \"AIzaSyBBcToE4P-S9EF2A6pS3Ey-4tGj9SRkN54\"\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tcenter={[post?.lat, post?.lng]}\r\n\t\t\t\t\t\tzoom={minimal ? 12 : 13}\r\n\t\t\t\t\t\tdraggable={!minimal}\r\n\t\t\t\t\t\toptions={{\r\n\t\t\t\t\t\t\tdisableDefaultUI: true\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<EnvironmentFilled \r\n\t\t\t\t\t\t\tlat={post?.lat} lng={post?.lng}\r\n\t\t\t\t\t\t\tstyle={{ fontSize: 40, color: \"var(--ant-primary-color)\", transform: \"translate(-20px, -20px)\" }} \r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</GoogleMapReact>\r\n\t\t\t\t</Col>\r\n\t\t\t</Row>\r\n\t\t);\r\n\t}\r\n\t \r\n\trenderGuests() {\r\n\t\tconst { post, user, currentSlide } = this.props;\r\n\t\tconst guestList = _(post.host).concat(post.guests).compact().filter(user => !_.isEmpty(user.tag) /* Null tag names are disabled accounts */).value();\r\n\t\treturn (\r\n\t\t\t<List\r\n\t\t\t\tsplit={false}\r\n\t\t\t\tdataSource={guestList}\r\n\t\t\t\trenderItem={user => (\r\n\t\t\t\t\t<List.Item key={user.id} style={{ justifyContent: \"flex-end\", padding: \"20px 20px 0 0\" }}>\r\n\t\t\t\t\t\t<Button \r\n\t\t\t\t\t\t\tclassName=\"guests-name\" \r\n\t\t\t\t\t\t\tonClick={() => _.isFunction(this.props.onClickProfile) && this.props.onClickProfile(user.tag)}\r\n\t\t\t\t\t\t\ticon={user.id === post.host.id ? <CrownFilled style={{ color: \"#ffde4c\" }} /> : null}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{user.tag}\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t<Avatar\r\n\t\t\t\t\t\t\tsize={50}\r\n\t\t\t\t\t\t\ticon={<UserOutlined />}\r\n\t\t\t\t\t\t\tsrc={user.picture}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t{/* <List.Item.Meta\r\n\t\t\t\t\t\t\tstyle={{ justifyContent: \"flex-end\" }}\r\n\t\t\t\t\t\t\tclassName=\"guests-avatar\"\r\n\t\t\t\t\t\t\tavatar={(\r\n\t\t\t\t\t\t\t\t<Avatar\r\n\t\t\t\t\t\t\t\t\tsize={50}\r\n\t\t\t\t\t\t\t\t\ticon={<UserOutlined />}\r\n\t\t\t\t\t\t\t\t\tsrc={user.picture}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/> */}\r\n\t\t\t\t\t</List.Item>\r\n\t\t\t\t)}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n\r\n\trenderDetails() {\r\n\t\tconst {\r\n\t\t\tuser,\r\n\t\t\tpost, \r\n\t\t\tguestVisible, setGuestVisible,\r\n\t\t\tmenuVisible, setMenuVisible,\r\n\t\t\tcomment, setComment,\r\n\t\t\tsaveCommentLoading,\r\n\t\t\tuploadPhotoVisibility, setUploadPhotoVisibility,\r\n\t\t\tguestGalleryPage, setGuestGalleryPage,\r\n\t\t\tsavePostPhotoLoading,\r\n\t\t\tpostsLoading, \r\n\t\t\tleavePostLoading, joinPostLoading,\r\n\t\t\tselectedComment, setSelectedComment,\r\n\t\t\teditComment, setEditComment\r\n\t\t} = this.props;\r\n\r\n\t\tconst postAuthors = _(post.host).concat(post.guests).compact().filter(user => !_.isEmpty(user.tag)).value();\r\n\t\tconst state = { ...post, ...this.state, gallery: !_.isNil(this.state.gallery) ? this.state.gallery : post.gallery };\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<Row justify=\"space-between\" align=\"top\" className={_.isEmpty(post.datePosted) ? \"post-actions-visible\" : \"post-actions\"} style={{ margin: \"0 20px\", flexWrap: \"nowrap\" /* Prevent overflow on tight screens */ }}>\r\n\t\t\t\t\t<div className=\"button-group\">\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t_.isFunction(this.props.onJoin) ? (\r\n\t\t\t\t\t\t\t<Button icon={<SmileFilled />} loading={joinPostLoading}\r\n\t\t\t\t\t\t\t\tonClick={async () => { await this.props.onJoin(post.id); setUploadPhotoVisibility(true); setMenuVisible(false); }}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tJoin\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t) : null\r\n\t\t\t\t\t}\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t_.isFunction(this.props.savePostPhoto) ? (\r\n\t\t\t\t\t\t\t<Button icon={<AppstoreFilled />} onClick={() => (!uploadPhotoVisibility && this.guestGalleryRef.current?.goTo(_.indexOf(_.map(postAuthors, \"id\"), user.id))) || setUploadPhotoVisibility(!uploadPhotoVisibility)}><CaretDownOutlined style={{ transition: \"transform .33s ease-in-out\", transform: uploadPhotoVisibility ? \"rotate(180deg)\" : null }} /></Button>\r\n\t\t\t\t\t\t) : null\r\n\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<Col className=\"button-group\">\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t_.isFunction(this.props.onCommentsClick) ? (\r\n\t\t\t\t\t\t\t\t<Button icon={<MessageFilled />} onClick={() => this.props.onCommentsClick(post.id)}>{ \" \" + _.size(post.comments) }</Button>\r\n\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t_.isFunction(setGuestVisible) ? (\r\n\t\t\t\t\t\t\t\t<Button icon={<SmileFilled />} onClick={() => setGuestVisible(!guestVisible)}>{ \" \" + _.size(_(post.host).concat(post.guests).filter(user => !_.isEmpty(user.tag)).value()) }</Button>\r\n\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t</Row>\r\n\r\n\t\t\t\t<div  style={{ marginBottom: \"20px\" }}>\r\n\t\t\t\t\t<Collapse \r\n\t\t\t\t\t\tghost\r\n\t\t\t\t\t\tactiveKey={_.isFunction(this.props.savePostPhoto) && uploadPhotoVisibility ? 1 : 0}\r\n\t\t\t\t\t\texpandIcon={props => null}\r\n\t\t\t\t\t\tstyle={{ marginBottom: \"20px\" }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{/* Upload Photo Visibility indicates whether the Panel key is collapsed or not */}\r\n\t\t\t\t\t\t<Collapse.Panel key={1}>\r\n\t\t\t\t\t\t\t<div className=\"guest-gallery-container\" style={{ overflow: \"auto hidden\", whiteSpace: \"nowrap\" }}>\r\n\t\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t_.map(postAuthors, (guest, index) => (\r\n\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\tshape=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\tsize=\"large\"\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"guest-gallery-button\"\r\n\t\t\t\t\t\t\t\t\t\t\ttype={guestGalleryPage === index ? \"primary\" : \"default\"}\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => this.guestGalleryRef.current?.goTo(index)}\r\n\t\t\t\t\t\t\t\t\t\t\ticon={guest.id === post.host.id ? <CrownFilled style={{ color: guestGalleryPage === index ? \"white\" : \"#ffde4c\" }} /> : null}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{ guest.tag }\r\n\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t))\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t\t<Tooltip placement=\"right\" title=\"Upload your photos here and see what others have uploaded.\">\r\n\t\t\t\t\t\t\t\t\t\t<QuestionCircleFilled className=\"guest-gallery-button\" style={{ fontSize: 20, verticalAlign: \"middle\" }} />\r\n\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<Spin spinning={!!(savePostPhotoLoading /* Double negation because undefined counts as true in this component */)} indicator={<LoadingOutlined style={{ fontSize: 60 }} spin />}>\r\n\t\t\t\t\t\t\t\t<Carousel  \r\n\t\t\t\t\t\t\t\t\tref={this.guestGalleryRef}\r\n\t\t\t\t\t\t\t\t\tdotPosition=\"bottom\"\r\n\t\t\t\t\t\t\t\t\tarrows\r\n\t\t\t\t\t\t\t\t\tprevArrow={<CaretLeftOutlined />}\r\n\t\t\t\t\t\t\t\t\tnextArrow={<CaretRightOutlined />}\r\n\t\t\t\t\t\t\t\t\tbeforeChange={(from, to) => setGuestGalleryPage(to)}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{ \r\n\t\t\t\t\t\t\t\t\t\t_.map(postAuthors, guest => (\r\n\t\t\t\t\t\t\t\t\t\t\t<div id={guest.id}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{ this.renderGuestGallery(guest) }\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t))\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t</Carousel>\r\n\t\t\t\t\t\t\t</Spin>\r\n\r\n\t\t\t\t\t\t\t<Row justify=\"space-between\" align=\"middle\" style={{ margin: \"20px 20px 0 20px\" }}>\r\n\t\t\t\t\t\t\t\t<div className=\"button-group\">\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t_.isFunction(this.props.onDelete || this.props.onEdit || this.props.onLeave) && (\r\n\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\tshape=\"circle\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetMenuVisible(!menuVisible);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclearTimeout(this.timeout);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.timeout = setTimeout(() => setMenuVisible(false), 5000);\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\ticon={<SettingFilled style={{ transition: \"transform .33s ease-in-out\", transform: menuVisible ? \"rotate(45deg)\" : null }} />}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t!menuVisible ? null : (\r\n\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t_.isFunction(this.props.onDelete) ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button shape=\"circle\" type=\"danger\" icon={<DeleteFilled />} onClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tModal.confirm({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: _.isEmpty(post.datePosted) ? \"Delete Open Invite\" : \"Delete Post\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent: `Are you sure you want to delete this ${_.isEmpty(post.datePosted) ? \"Open Invite\" : \"Post\"}? This cannot be undone.`,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon: null,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tokText: \"Delete\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcancelText: \"Cancel\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonOk: async () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.props.onDelete(post.id);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetMenuVisible(false);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)\t : null\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t_.isFunction(this.props.onEdit) ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button icon={<EditFilled />} onClick={() => this.props.onEdit(post)}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tEdit\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t_.isFunction(this.props.onLeave) ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button icon={<FrownFilled />} loading={leavePostLoading} \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={async () => Modal.confirm({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: `Leave ${_.isEmpty(post.datePosted) ? \"Open Invite\" : \"Post\"}`,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent: _.isEmpty(post.datePosted) ? \"Your uploaded photos will be removed. This cannot be undone. Continue to leave?\" : \"Your uploaded photos will be removed and you will need to ask the host if you want to join back. This cannot be undone. Continue to leave?\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tokText: \"Leave\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonOk: async () => { \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tawait this.props.onLeave(post.id); \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetUploadPhotoVisibility(false); \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetMenuVisible(false); \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tLeave\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t_.isFunction(this.props.refresh) && (\r\n\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\ticon={<ReloadOutlined />}\r\n\t\t\t\t\t\t\t\t\t\t\t\tloading={postsLoading}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => this.props.refresh()}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\tRefresh\r\n\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t!_.isEmpty(this.state.files) || post.gallery !== state.gallery ? (\r\n\t\t\t\t\t\t\t\t\t\t<Row align=\"middle\">\r\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip placement=\"left\" title=\"Upload your photos while host prepares to publish this post.\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<QuestionCircleFilled style={{ fontSize: 20, marginRight: \"10px\" }} />\r\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\t// disabled={post.gallery === state.gallery /* This lets the user remove photos from the gallery */}\r\n\t\t\t\t\t\t\t\t\t\t\t\tloading={savePostPhotoLoading}\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"primary\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={async () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// Upload will save the uploaded photos which in turn, empties the `this.state.files` which enables the \"Post\" button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tawait this.props.savePostPhoto({ files: this.state.files, id: post.id, gallery: state.gallery });\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.setState({ files: [], gallery: undefined });\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\tSave\r\n\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t) : !_.isEmpty(post.datePosted) ? (\r\n\t\t\t\t\t\t\t\t\t\t\t<span>Posted { Moment(post.datePosted).fromNow() }</span>\r\n\t\t\t\t\t\t\t\t\t\t) : user.id === post.host.id ? ( /* If the user idhost, let them publish the post. Otherwise, let the guest ready up */\r\n\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\ttype=\"primary\"\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={async () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tawait this.props.onPublish({ ...state, datePosted: new Date().toISOString() });\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.setState({ files: [], gallery: undefined });\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetUploadPhotoVisibility(false);\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\tPublish\r\n\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t) : !_.isEmpty(_.concat(_.filter(state.gallery, photo => photo.owner.id === user.id), this.state.files)) ? ( // Determines what tooltip to display based on the content of the guest gallery\r\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip placement=\"left\" title=\"Ready to publish. Waiting for host.\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Row align=\"middle\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<CheckCircleFilled style={{ fontSize: 20, marginRight: \"10px\", color: \"#49cc90\" }} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tReady\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip placement=\"left\" title=\"Upload your photos while host prepares to publish this post.\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Row align=\"middle\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<QuestionCircleFilled style={{ fontSize: 20, marginRight: \"10px\" }} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Button type=\"primary\" disabled>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tSave\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</Row>\r\n\r\n\t\t\t\t\t\t</Collapse.Panel>\r\n\t\t\t\t\t</Collapse>\r\n\r\n\t\t\t\t\t<Row justify=\"space-between\" align=\"top\" style={{ margin: \"0 20px 0 20px\" }}>\r\n\t\t\t\t\t\t<Col span={24}>\r\n\t\t\t\t\t\t\t<Row justify=\"space-between\">\r\n\t\t\t\t\t\t\t\t<Col key={0} span={18}>\r\n\t\t\t\t\t\t\t\t\t<div><b>{ post.host.tag }</b>{\" \"}{ post.description }</div>\r\n\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t<Col key={1} span={6} className=\"comment-date\">\r\n\t\t\t\t\t\t\t\t\t<sub>{ Moment(post.dateCreated).isValid() ? Moment(post.dateCreated).format(\"LL\") : null }</sub>\r\n\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t</Row>\r\n\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t_.map(_.compact(post.comments), (comment, index) => (\r\n\t\t\t\t\t\t\t\t\t<Row justify=\"space-between\" onClick={() => setSelectedComment(comment) || setEditComment(comment.description)}>\r\n\t\t\t\t\t\t\t\t\t\t<Col key={comment.id} span={18}>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"comment\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<b>{ comment.user.tag }</b>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{ \" \" + comment.description }\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t\t<Col key={comment.id + index} span={6} className=\"comment-date\">\r\n\t\t\t\t\t\t\t\t\t\t\t<sub>{ Moment(comment.dateCreated).isValid() ? Moment(comment.dateCreated).fromNow() : null }</sub>\r\n\t\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t</Row>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t_.isFunction(this.props.onComment) ? (\r\n\t\t\t\t\t\t\t<Row justify=\"end\" className=\"comment-form-container\">\r\n\t\t\t\t\t\t\t\t<Input.TextArea\r\n\t\t\t\t\t\t\t\t\tclassName=\"comment-text\"\r\n\t\t\t\t\t\t\t\t\tplaceholder=\"Say something...\"\r\n\t\t\t\t\t\t\t\t\trows={1}\r\n\t\t\t\t\t\t\t\t\tvalue={comment}\r\n\t\t\t\t\t\t\t\t\tonChange={({ target: { value }}) => setComment(value)}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<Button \r\n\t\t\t\t\t\t\t\t\tdisabled={_.size(comment) <= 0}\r\n\t\t\t\t\t\t\t\t\tclassName=\"comment-button\"\r\n\t\t\t\t\t\t\t\t\ttype=\"primary\" icon={<SendOutlined />}\r\n\t\t\t\t\t\t\t\t\tloading={saveCommentLoading}\r\n\t\t\t\t\t\t\t\t\tstyle={{ opacity: _.size(comment) > 0 ? 1 : 0 }}\r\n\t\t\t\t\t\t\t\t\tonClick={async () => {\r\n\t\t\t\t\t\t\t\t\t\tawait this.props.onComment({ description: comment }, post.id);\r\n\t\t\t\t\t\t\t\t\t\tsetComment(\"\")\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\tComment\r\n\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t) : null\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n\r\n\trenderGuestGallery(guest) {\r\n\t\tconst { \r\n\t\t\tuser,\r\n\t\t\tpost,\r\n\t\t\tfileToRemove, setFileToRemove\r\n\t\t} = this.props;\r\n\t\t\r\n\t\tconst state = { ...post, ...this.state, gallery: !_.isNil(this.state.gallery) ? this.state.gallery : post.gallery };\r\n\t\tconst allowUpload = guest.id === user.id && _.isEmpty(post.datePosted);\r\n\t\t\r\n\t\tlet guestPhotos = _.filter(state.gallery, photo => photo.owner.id === guest.id);\r\n\t\t// If the guest is the active user, the gallery will contain the `this.state.files` list as well as upload placeholders \r\n\t\tif(allowUpload) guestPhotos = _.concat(guestPhotos, this.state.files);\r\n\t\tguestPhotos = _(guestPhotos)\r\n\t\t\t.concat(new Array(9))\r\n\t\t\t.slice(0, 9)\r\n\t\t\t.value();\r\n\r\n\t\treturn (\r\n\t\t\t<Col>\r\n\t\t\t\t{/* Hidden Input of type file that is trigered by the label below */}\r\n\t\t\t\t<input\r\n\t\t\t\t\tid={`file-upload-input-${post.id}`}\r\n\t\t\t\t\tstyle={{ display: \"none\" }}\r\n\t\t\t\t\ttype=\"file\" \r\n\t\t\t\t\tmultiple\r\n\t\t\t\t\tonChange={async ({ target: { files } }) => {\r\n\t\t\t\t\t\tconst stateFiles = this.state.files;\r\n\t\t\t\t\t\tconst toConvert = []; // Resize all fils to a max dimentions of 300x300\r\n\t\t\t\t\t\tfor(let file of _.slice(files, 0, 9 - _.size(_.concat(stateFiles, state.gallery)))) {\r\n\t\t\t\t\t\t\ttoConvert.push(new Promise(resolve => {\r\n\t\t\t\t\t\t\t\tResizer.imageFileResizer(file,\r\n\t\t\t\t\t\t\t\t\t1500, 1500, \"JPEG\", 90, 0,\r\n\t\t\t\t\t\t\t\t\tfile => {\r\n\t\t\t\t\t\t\t\t\t\t// We normally use `type` property but this mimetype is for GraphQL Upload file object\r\n\t\t\t\t\t\t\t\t\t\tfile.mimetype = file.type;\r\n\t\t\t\t\t\t\t\t\t\tif (!file.url && !file.preview) {\r\n\t\t\t\t\t\t\t\t\t\t\tfile.preview = URL.createObjectURL(file);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tresolve(file);\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\"file\"\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tconst toAppend = await Promise.all(toConvert);\r\n\t\t\t\t\t\tthis.setState({ files: _(stateFiles).concat(toAppend).slice(0, 9).value() });\r\n\r\n\t\t\t\t\t\t// Clear Value of input to allow uploading of \"same\" file\r\n\t\t\t\t\t\tdocument.getElementById(`file-upload-input-${post.id}`).value = null;\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t{\r\n\t\t\t\t\t// Chunk the photos into a <Row> to fix collapse jumpy bug\r\n\t\t\t\t\t_(guestPhotos).chunk(3).map((guestPhotos, outerIndex) => (\r\n\t\t\t\t\t\t<Row key={outerIndex}>\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t_.map(guestPhotos, (file, index) => (\r\n\t\t\t\t\t\t\t\t\t<Col span={8} key={`${file?.name}${outerIndex}${index}`} style={{ height: \"33vw\", maxHeight: \"192px\" }}>\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t// For each gallery photo, only get those that belong to the current user\r\n\t\t\t\t\t\t\t\t\t\t\t\t_.isEmpty(file?.name) ? ( // This means we show an empty image tha user can upload a file into\r\n\t\t\t\t\t\t\t\t\t\t\t\t<label htmlFor={allowUpload ? `file-upload-input-${post.id}` : null}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Row\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tjustify=\"center\" align=\"middle\" className=\"post-upload-image\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ pointerEvents: allowUpload ? \"auto\" : \"none\" }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FileImageFilled style={{ fontSize: 20, opacity: allowUpload ? 0.33 : 0 }} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t\t\t) : ( // This indicates that the photo is an Upload file\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Row\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tjustify=\"center\" align=\"middle\" className=\"post-upload-image\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ pointerEvents: allowUpload && guest.id === user.id ? \"auto\" : \"none\", backgroundImage: !_.isEmpty(file.preview) ? `url(\"${file.preview}\")` : `url(\"https://firebasestorage.googleapis.com/v0/b/pikature.appspot.com/o/${file.name}?alt=media\")` }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(guest.id === user.id) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetFileToRemove(fileToRemove === file.name ? \"\" : file.name);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclearTimeout(this.timeoutCode);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.timeoutCode = setTimeout(() => setFileToRemove(\"\"), 3000);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tallowUpload && fileToRemove === file.name ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Row\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tjustify=\"center\" align=\"middle\" className=\"post-upload-image\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbackgroundColor: \"#00000066\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor: \"white\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ height: \"60px\", width: \"60px\", borderRadius: \"50%\" }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon={<CloseOutlined style={{ fontSize: 30 }} />}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst toRemove = _.find(guestPhotos, { name: fileToRemove });\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(toRemove?.id) { // This means the photo to remove is found in the gallery\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.setState({ gallery: _.filter(state.gallery, photo => photo !== toRemove) });\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t} else if(toRemove?.name) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.setState({ files: _.filter(state.files, file => file !== toRemove) });\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t)).value()\r\n\t\t\t\t}\r\n\t\t\t</Col>\r\n\t\t);\r\n\t}\r\n}\r\n","import { useState, useContext } from \"react\";\r\nimport { ContextLoading, ContextUser } from \"src/components\";\r\nimport _ from \"lodash\";\r\nimport Post from \"./component\";\r\n\r\nfunction Component(props) {\r\n\tconst [guestVisible, setGuestVisible] = useState(props.guestVisible);\r\n\tconst [menuVisible, setMenuVisible] = useState(false);\r\n\tconst [modalVisible, setModalVisible] = useState(false)\r\n\tconst [autoplay, setAutoplay] = useState(props.autoplay);\r\n\tconst [comment, setComment] = useState(\"\");\r\n\tconst [uploadPhotoVisibility, setUploadPhotoVisibility] = useState(false);\r\n\tconst [fileToRemove, setFileToRemove] = useState(\"\");\r\n\tconst [guestGalleryPage, setGuestGalleryPage] = useState(0);\r\n\tconst [currentSlide, setCurrentSlide] = useState();\r\n\tconst [selectedComment, setSelectedComment] = useState();\r\n\tconst [editComment, setEditComment] = useState(\"\");\r\n\r\n\tconst { postsLoading, saveCommentLoading, savePostPhotoLoading, leavePostLoading, joinPostLoading } = useContext(ContextLoading);\r\n\tconst [user] = useContext(ContextUser);\r\n\r\n\treturn (\r\n\t\t<Post\r\n\t\t\t{...props}\r\n\t\t\tpostsLoading={postsLoading}\r\n\t\t\tleavePostLoading={leavePostLoading}\r\n\t\t\tjoinPostLoading={joinPostLoading}\r\n\t\t\tuser={user || props.user} // This helps the Post component know which guest gallery slide to concatenate locally uploaded files as well as the default key for the guest gallery\r\n\r\n\t\t\tguestVisible={guestVisible} setGuestVisible={setGuestVisible}\r\n\t\t\tmenuVisible={menuVisible} setMenuVisible={setMenuVisible}\r\n\t\t\tmodalVisible={modalVisible} setModalVisible={setModalVisible}\r\n\t\t\tautoplay={autoplay} setAutoplay={setAutoplay}\r\n\t\t\tcurrentSlide={currentSlide} setCurrentSlide={setCurrentSlide}\r\n\r\n\t\t\tcomment={comment} setComment={setComment}\r\n\t\t\tsaveCommentLoading={saveCommentLoading}\r\n\t\t\tselectedComment={selectedComment} setSelectedComment={setSelectedComment}\r\n\t\t\teditComment={editComment} setEditComment={setEditComment}\r\n\r\n\t\t\tuploadPhotoVisibility={uploadPhotoVisibility} setUploadPhotoVisibility={setUploadPhotoVisibility}\r\n\t\t\tfileToRemove={fileToRemove} setFileToRemove={setFileToRemove}\r\n\r\n\t\t\tguestGalleryPage={guestGalleryPage} setGuestGalleryPage={setGuestGalleryPage}\r\n\t\t\tsavePostPhotoLoading={savePostPhotoLoading}\r\n\t\t/>\r\n\t);\r\n}\r\n\r\nexport default Component;","import { Component } from \"react\";\r\nimport { Image, Button, Tooltip, Tabs, Row, Col, Divider, Input, Carousel, Spin, List, Card, Typography, Avatar } from \"antd\";\r\nimport { SearchOutlined, LeftOutlined, QuestionCircleFilled, FileImageFilled, CloseOutlined, CaretLeftOutlined, CaretRightOutlined, LoadingOutlined, EnvironmentFilled, AimOutlined } from \"@ant-design/icons\";\r\nimport GoogleMapReact from \"google-map-react\";\r\nimport Resizer from \"react-image-file-resizer\";\r\nimport Supercluster from \"supercluster\";\r\nimport { Marker } from \"react-mapbox-gl\";\r\nimport _ from \"lodash\";\r\n\r\nimport { PlaceMarker, Map, StaticMap } from \"src/components\";\r\nimport \"./style.css\";\r\n\r\n\r\n// const google = window.google;\r\nconst zoomDistanceMapping = {\r\n\t17: 0.00375,\r\n\t15: 0.0075,\r\n\t13: 0.0375,\r\n\t12: 0.075,\r\n\t10: 0.1875,\r\n\t9: 0.375,\r\n\t8: 0.75,\r\n\t7: 1.875,\r\n\t6: 3.75,\r\n\t5: 7.5,\r\n\t4: 15,\r\n};\r\n\r\n// Nearest Neighbor algorithm for determining the closest zoom value\r\nfunction getZoomDistanceMapping(zoom) {\r\n\treturn _.map(zoomDistanceMapping, (value, key) => _.toNumber(key)).reduce((prev, curr) => \r\n\t\t(Math.abs(curr - zoom) < Math.abs(prev - zoom) ? curr : prev)\r\n\t);\r\n}\r\nexport default class PostCreate extends Component {\r\n\tstatic defaultState = {\r\n\t\tfiles: []\r\n\t};\r\n\tstate = PostCreate.defaultState;\r\n\r\n\tnavPages = [{\r\n\t\tname: \"Photos\",\r\n\t\ttooltip: \"Select the photos you want to upload\"\r\n\t}, {\r\n\t\tname: \"Details\",\r\n\t\ttooltip: \"Preview your post and add a description\"\r\n\t}];\r\n\t\r\n\trender() {\r\n\t\tconst { navPage } = this.props;\r\n\r\n\t\treturn (\r\n\t\t\t<Tabs\r\n\t\t\t\tcentered\r\n\t\t\t\tactiveKey={`${navPage}`}\r\n\t\t\t\trenderTabBar={(tabProps, tabBar) => this.renderHeader(tabProps, tabBar)}\r\n\t\t\t>\r\n\t\t\t\t<Tabs.TabPane key=\"0\" className=\"create-post-tab-container\">\r\n\t\t\t\t\t{ this.renderUploadTab() }\r\n\t\t\t\t</Tabs.TabPane>\r\n\r\n\t\t\t\t<Tabs.TabPane key=\"1\" className=\"create-post-tab-container\">\r\n\t\t\t\t\t{ this.renderDetailsTab() }\r\n\t\t\t\t</Tabs.TabPane>\r\n\t\t\t</Tabs>\r\n\t\t);\r\n\t}\r\n\r\n\trenderHeader() {\r\n\t\tconst { mentionList, navPage, setNavPage, saveLoading } = this.props;\r\n\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<Row justify=\"space-between\" align=\"middle\" style={{ padding: \"20px\" }}>\r\n\t\t\t\t\t<Col><Button shape=\"circle\" icon={<CloseOutlined />} onClick={() => this.props.onDraft() } /></Col>\r\n\r\n\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t<Tooltip placement=\"bottom\" title={this.navPages[navPage].tooltip}>\r\n\t\t\t\t\t\t\t{ this.navPages[navPage].name }\r\n\t\t\t\t\t\t\t<QuestionCircleFilled style={{ marginLeft: \"10px\" }} />\r\n\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t</Col>\r\n\r\n\t\t\t\t\t<Col className=\"button-group\">\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tdisabled={navPage === 0}\r\n\t\t\t\t\t\t\tonClick={() => setNavPage(Math.max(navPage - 1, 0)) }\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<LeftOutlined />\r\n\t\t\t\t\t\t</Button>\r\n\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tdisabled={navPage === _.size(this.navPages) - 1 && _.isEmpty(this.props.values?.datePosted) && _.isEmpty(this.state.files)}\r\n\t\t\t\t\t\t\tloading={saveLoading}\r\n\t\t\t\t\t\t\ttype=\"primary\"\r\n\t\t\t\t\t\t\tonClick={async () => {\r\n\t\t\t\t\t\t\t\tif(navPage === _.size(this.navPages) - 1 ) {\r\n\t\t\t\t\t\t\t\t\tawait this.props.onSave({ \r\n\t\t\t\t\t\t\t\t\t\t...this.state, \r\n\t\t\t\t\t\t\t\t\t\tdatePosted: this.props.values.datePosted || new Date().toISOString() \r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t// Delay the tab transition for elegance\r\n\t\t\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\t\t\tthis.setState({ files: [], description: \"\" });\r\n\t\t\t\t\t\t\t\t\t\tsetNavPage(0);\r\n\t\t\t\t\t\t\t\t\t\tdocument.getElementById(\"profile-content-card\").scrollIntoView({ behavior: \"smooth\" });\r\n\t\t\t\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tsetNavPage(Math.min(navPage + 1, 2))\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{ \r\n\t\t\t\t\t\t\t\tnavPage < _.size(this.navPages) - 1 ? \r\n\t\t\t\t\t\t\t\t\tnavPage === 1 && _.size(mentionList) === 0 ? \"Skip\" : \"Next\" : \r\n\t\t\t\t\t\t\t\t\t_.isEmpty(this.props.values?.datePosted) ? \"Publish\" : \"Save\" \r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t</Row>\r\n\t\t\t\t<Divider style={{ margin: 0 }} />\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n\r\n\trenderUploadTab() {\r\n\t\tconst { \r\n\t\t\tfileToRemove, setFileToRemove,\r\n\t\t\tzoom, setZoom,\r\n\t\t\tplaces, placesLoading,\r\n\t\t\tnavPage, setNavPage, \r\n\t\t} = this.props;\r\n\t\t\t\r\n\t\t// Cluster the map markers based on zoom value\r\n\t\tconst clusterMarkers = new Supercluster({\r\n\t\t\tminZoom: 0,\r\n\t\t\tmaxZoom: 20,\r\n\t\t\tradius: 30,\r\n\t\t\textent: 512,\r\n\t\t\tmap: props => ({ sum: 1 }),\r\n\t\t\treduce: (accumulated, props) => { accumulated.sum += props.sum; }\r\n\t\t});\r\n\t\tclusterMarkers.load(_.map(places, place =>  ({\r\n\t\t\t\"type\": \"Feature\",\r\n\t\t\t\"geometry\": { \"type\": \"Point\", \"coordinates\": [place.lng, place.lat] },\r\n\t\t\tplace\r\n\t\t})));\r\n\t\tconst markers = clusterMarkers.getClusters([-180, -85, 180, 85], zoom);\r\n\r\n\t\t// Append the `Post.gallery` to the `state.files` and append remaining spots out of 9 with placeholder\r\n\t\tconst state = { ...this.props.values, ...this.state };\r\n\t\tconst postPhotos = _(state.gallery)\r\n\t\t\t.concat(this.state.files)\r\n\t\t\t.compact()\r\n\t\t\t.concat(new Array(9))\r\n\t\t\t.slice(0, 9)\r\n\t\t\t.value();\r\n\t\t\r\n\t\tconst allowUpload = _.isEmpty(state.datePosted);\r\n\r\n\t\treturn (\r\n\t\t\t<Row justify=\"space-between\" gutter={0}>\r\n\t\t\t\t<input \r\n\t\t\t\t\tid=\"file-upload-input\"\r\n\t\t\t\t\tstyle={{ display: \"none\" }}\r\n\t\t\t\t\ttype=\"file\" \r\n\t\t\t\t\tmultiple\r\n\t\t\t\t\tonChange={async ({ target: { files } }) => {\r\n\t\t\t\t\t\tconst stateFiles = this.state.files;\r\n\t\t\t\t\t\tconst toConvert = []; // Resize all fils to a max dimentions of 300x300\r\n\t\t\t\t\t\tfor(let file of _.slice(files, 0, 9 - _.size(_.concat(stateFiles, state.gallery)))) {\r\n\t\t\t\t\t\t\ttoConvert.push(new Promise(resolve => {\r\n\t\t\t\t\t\t\t\tResizer.imageFileResizer(file,\r\n\t\t\t\t\t\t\t\t\t1500, 1500, \"JPEG\", 90, 0,\r\n\t\t\t\t\t\t\t\t\tfile => {\r\n\t\t\t\t\t\t\t\t\t\t// We normally use `type` property but this mimetype is for GraphQL Upload file object\r\n\t\t\t\t\t\t\t\t\t\tfile.mimetype = file.type;\r\n\t\t\t\t\t\t\t\t\t\tif (!file.url && !file.preview) {\r\n\t\t\t\t\t\t\t\t\t\t\tfile.preview = URL.createObjectURL(file);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tresolve(file);\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\"file\"\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tconst toAppend = await Promise.all(toConvert);\r\n\t\t\t\t\t\tthis.setState({ files: _(stateFiles).concat(toAppend).slice(0, Math.min(9 - _.size(state.gallery)), 9).value() });\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// Clear Value of input to allow uploading of \"same\" file\r\n\t\t\t\t\t\tdocument.getElementById(\"file-upload-input\").value = null;\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t\t{\r\n\t\t\t\t\t_.map(postPhotos, (file, index) => (\r\n\t\t\t\t\t\t<Col key={index} span={8} style={{ height: \"33vw\", maxHeight: \"173px\" /* .33 width of modal where this component is rendered */ }}>\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t_.isEmpty(file?.name) ? ( // This means we show an empty image tha user can upload a file into\r\n\t\t\t\t\t\t\t\t\t\t<label htmlFor={allowUpload ? `file-upload-input` : null}>\r\n\t\t\t\t\t\t\t\t\t\t\t<Row justify=\"center\" align=\"middle\" className=\"post-upload-image\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<FileImageFilled style={{ fontSize: 20, opacity: allowUpload ? 0.33 : 0 }} />\r\n\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t<Row\r\n\t\t\t\t\t\t\t\t\t\tjustify=\"center\" align=\"middle\" className=\"post-upload-image\"\r\n\t\t\t\t\t\t\t\t\t\tstyle={{ backgroundImage: !_.isEmpty(file.preview) ? `url(\"${file.preview}\")` : `url(\"https://firebasestorage.googleapis.com/v0/b/pikature.appspot.com/o/${file.name}?alt=media\")` }}\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tsetFileToRemove(fileToRemove === index ? \"\" : index);\r\n\t\t\t\t\t\t\t\t\t\t\tclearTimeout(this.timeoutCode);\r\n\t\t\t\t\t\t\t\t\t\t\tthis.timeoutCode = setTimeout(() => setFileToRemove(\"\"), 3000);\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tfileToRemove === index ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Row\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tjustify=\"center\" align=\"middle\" className=\"post-upload-image\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tbackgroundColor: \"#00000066\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor: \"white\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Button \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ height: \"60px\", width: \"60px\", borderRadius: \"50%\" }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon={<CloseOutlined style={{ fontSize: 30 }} />}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => this.setState({ files: _.filter(this.state.files, (a, index) => index !== this.props.fileToRemove)}, () => this.props.setFileToRemove(\"\"))}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t))\r\n\t\t\t\t}\r\n\r\n\t\t\t\t<Col span={24}>\r\n\t\t\t\t\t<Divider plain orientation=\"left\">\r\n\t\t\t\t\t\t<Tooltip placement=\"right\" title=\"Set the photoshoot location\">\r\n\t\t\t\t\t\t\tSet Location\r\n\t\t\t\t\t\t\t<QuestionCircleFilled style={{ marginLeft: \"10px\" }} />\r\n\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t</Divider>\r\n\t\t\t\t</Col>\r\n\r\n\r\n\t\t\t\t<Col id=\"post-create-map-container\">\r\n\t\t\t\t\t\t<Map\r\n\t\t\t\t\t\t\tstyle=\"mapbox://styles/mapbox/outdoors-v11\"\r\n\t\t\t\t\t\t\tcontainerStyle={{\r\n\t\t\t\t\t\t\t\theight: \"100%\",\r\n\t\t\t\t\t\t\t\twidth: \"100%\"\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tcenter={[state.lng, state.lat]}\r\n\t\t\t\t\t\t\tonZoomStart={map => setZoom(Math.trunc(map.getZoom()))}\r\n\t\t\t\t\t\t\tonDragEnd={(map, event) => {\r\n\t\t\t\t\t\t\t\tconst { lat, lng } = map.getCenter();\r\n\t\t\t\t\t\t\t\tthis.setState({ lat, lng });\r\n\t\t\t\t\t\t\t\tmap.easeTo({ center: [lng, lat] });\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t// Get Zoom value for places search\r\n\t\t\t\t\t\t\t\tconst zoom = Math.trunc(map.getZoom());\r\n\t\t\t\t\t\t\t\tsetZoom(zoom);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{ \r\n\t\t\t\t\t\t\t\t_.map(markers, marker => {\r\n\t\t\t\t\t\t\t\t\tconst { geometry: { coordinates }, properties, post } = marker;\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<Marker coordinates={[coordinates[0], coordinates[1]]}>\r\n\t\t\t\t\t\t\t\t\t\t\t<PlaceMarker\r\n\t\t\t\t\t\t\t\t\t\t\t\tmarker={marker}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst { place } = marker;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(_.isEmpty(place)) return;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.setState({ place: place, lat: place.lat, lng: place.lng });\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t//setTimeout(() => setNavPage(Math.min(navPage + 1, 2)), 500);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdocument.getElementById(\"post-create-place-content\").scrollIntoView({ behavior: \"smooth\" });\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</Marker>\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t{/*<Marker coordinates={[state.lng, state.lat]}>\r\n\t\t\t\t\t\t\t\t<EnvironmentFilled \r\n\t\t\t\t\t\t\t\t\tlat={state.lat} lng={state.lng}\r\n\t\t\t\t\t\t\t\t\tstyle={{ fontSize: 40, color: \"var(--ant-primary-color)\" }} \r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Marker>*/}\r\n\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t<EnvironmentFilled \r\n\t\t\t\t\t\t\tstyle={{ \r\n\t\t\t\t\t\t\t\tfontSize: 40, color: \"var(--ant-primary-color)\",\r\n\t\t\t\t\t\t\t\tposition: \"absolute\",\r\n\t\t\t\t\t\t\t\ttop: \"calc(50% - 20px)\",\r\n\t\t\t\t\t\t\t\tleft: \"50%\",\r\n\t\t\t\t\t\t\t\ttransform: \"translate(-50%, -50%)\",\r\n\t\t\t\t\t\t\t\tzIndex: 10\r\n\t\t\t\t\t\t\t}} \r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t_.isFunction(this.props.onSearchPlaces) && (\r\n\t\t\t\t\t\t\t\t<div style={{ \r\n\t\t\t\t\t\t\t\t\tfontSize: 40, color: \"var(--ant-primary-color)\",\r\n\t\t\t\t\t\t\t\t\tposition: \"absolute\",\r\n\t\t\t\t\t\t\t\t\tbottom: \"20px\",\r\n\t\t\t\t\t\t\t\t\tleft: \"50%\",\r\n\t\t\t\t\t\t\t\t\ttransform: \"translateX(-50%)\",\r\n\t\t\t\t\t\t\t\t\tzIndex: 10\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t_.isNumber(zoom) && zoom < 12 ? (\r\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip title=\"Zoom Closer\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Button \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={_.isNumber(zoom) && zoom < 12}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon={<SearchOutlined />}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => this.props.onSearchPlaces({ lat: state.lat, lng: state.lng, radius: zoomDistanceMapping[getZoomDistanceMapping(zoom)] })}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tParks\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\tloading={placesLoading}\r\n\t\t\t\t\t\t\t\t\t\t\t\ticon={<SearchOutlined />}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => this.props.onSearchPlaces({ lat: state.lat, lng: state.lng, radius: zoomDistanceMapping[getZoomDistanceMapping(zoom)] })}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\tParks\r\n\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</Map>\r\n\t\t\t\t</Col>\r\n\r\n\t\t\t\t<Col span={24} style={{ minHeight: \"25vh\" }}>\r\n\t\t\t\t\t<Spin spinning={placesLoading} indicator={<LoadingOutlined style={{ fontSize: 60 }} spin />}>\r\n\t\t\t\t\t\t<List\r\n\t\t\t\t\t\t\tstyle={{ padding: \"20px\" }}\r\n\t\t\t\t\t\t\tsplit={false}\r\n\t\t\t\t\t\t\tdataSource={places}\r\n\t\t\t\t\t\t\trenderItem={place => (\r\n\t\t\t\t\t\t\t\t<List.Item \r\n\t\t\t\t\t\t\t\t\tkey={place.id}\r\n\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\tthis.setState({ place: place, lat: place.lat, lng: place.lng });\r\n\t\t\t\t\t\t\t\t\t\tsetTimeout(() => setNavPage(Math.min(navPage + 1, 2)), 500);\r\n\t\t\t\t\t\t\t\t\t\t//document.getElementById(\"post-create-place-content\").scrollIntoView({ behavior: \"smooth\" });\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t!_.isEmpty(place.photos) ? (\r\n\t\t\t\t\t\t\t\t\t\t\t<Card bordered={false} className=\"search-places-item\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t!_.isEmpty(place.photos) ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Image preview={false} alt=\"place-cover\" className=\"search-places-cover\" src={_.first(place.photos)} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"search-places-content\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography.Title level={3} style={{ color: \"white\", margin: 0 }}>{place.name}</Typography.Title>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography.Text style={{ color: \"white\" }}>{place.openNow ? \"Open\" : \"\"}</Typography.Text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Row className=\"gradient-overlay-inverted\"></Row>\r\n\t\t\t\t\t\t\t\t\t\t\t</Card>\r\n\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t<List.Item.Meta\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"search-places-item\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tavatar={<Avatar src={place.icon} />}\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle={place.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\tdescription={place.openNow ? \"Open\" : \"\"}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t</List.Item>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Spin>\r\n\t\t\t\t</Col>\r\n\t\t\t</Row>\r\n\t\t);\r\n\t}\r\n\r\n\trenderDetailsTab() {\r\n\t\tconst {\r\n\t\t\tvalues,\r\n\t\t\tplaces, placesLoading,\r\n\t\t\tnavPage, setNavPage, \r\n\t\t\tzoom, setZoom \r\n\t\t} = this.props;\r\n\r\n\t\tconst state = { ...this.props.values, ...this.state };\r\n\t\tconst postPhotos = _(state.gallery)\r\n\t\t\t.concat(this.state.files)\r\n\t\t\t.compact()\r\n\t\t\t.value();\r\n\r\n\t\treturn (\r\n\t\t\t<Row>\r\n\t\t\t\t<Col span={24}>\r\n\t\t\t\t\t<Col id=\"post-create-place-content\">\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t!_.isEmpty(state.place) ? (\r\n\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t<Typography.Title level={3} style={{ color: \"white\", margin: 0 }}>{state.place.name}</Typography.Title>\r\n\t\t\t\t\t\t\t\t\t\t<Typography.Text style={{ color: \"white\" }}>{state.place?.openNow ? \"Open\" : \"\"}</Typography.Text>\r\n\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t\t<Carousel \r\n\t\t\t\t\t\t// dots={minimal ? false : true}\r\n\t\t\t\t\t\tdotPosition=\"bottom\"\r\n\t\t\t\t\t\tarrows\r\n\t\t\t\t\t\tprevArrow={<CaretLeftOutlined />}\r\n\t\t\t\t\t\tnextArrow={<CaretRightOutlined />}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t_.map(postPhotos, file => (\r\n\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\talt=\"post\" \r\n\t\t\t\t\t\t\t\t\tkey={file.name}\r\n\t\t\t\t\t\t\t\t\tclassName=\"post-upload-image-preview\"\r\n\t\t\t\t\t\t\t\t\tsrc={!_.isEmpty(file.preview) ? file.preview : `https://firebasestorage.googleapis.com/v0/b/pikature.appspot.com/o/${file.name}?alt=media`}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t))\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tnavPage === 1 &&\t(\r\n\t\t\t\t\t\t\t\t<div className=\"post-upload-image-preview\">\r\n\t\t\t\t\t\t\t\t\t<StaticMap\r\n\t\t\t\t\t\t\t\t\t\tlat={state.lat}\r\n\t\t\t\t\t\t\t\t\t\tlng={state.lng}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t\t\t<EnvironmentFilled \r\n\t\t\t\t\t\t\t\t\t\tstyle={{ \r\n\t\t\t\t\t\t\t\t\t\t\tfontSize: 40, color: \"var(--ant-primary-color)\",\r\n\t\t\t\t\t\t\t\t\t\t\tposition: \"absolute\",\r\n\t\t\t\t\t\t\t\t\t\t\ttop: \"50%\",\r\n\t\t\t\t\t\t\t\t\t\t\tleft: \"50%\",\r\n\t\t\t\t\t\t\t\t\t\t\ttransform: \"translate(-50%, -50%)\",\r\n\t\t\t\t\t\t\t\t\t\t\tzIndex: 10\r\n\t\t\t\t\t\t\t\t\t\t}} \r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t{/* <div className=\"post-image-container\"><img className=\"post-image\" src=\"https://wallpaperaccess.com/full/2382371.jpg\" /></div>\r\n\t\t\t\t\t\t<div className=\"post-image-container\"><img className=\"post-image\" src=\"https://cdn.wallpaperhub.app/cloudcache/4/5/5/4/c/a/4554cad45b7f8130176b0a2921c4748249a2ea9a.jpg\" /></div>\r\n\t\t\t\t\t\t<div className=\"post-image-container\"><img className=\"post-image\" src=\"https://wallpapercave.com/wp/wp8139423.jpg\" /></div> */}\r\n\t\t\t\t\t</Carousel>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<Row justify=\"end\" align=\"bottom\" id=\"post-create-place-actions\">\r\n\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t<div className=\"button-group\" style={{ textAlign: \"right\" }}>\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t!_.isEmpty(state.place) ? (\r\n\t\t\t\t\t\t\t\t\t\t<Button icon={<CloseOutlined />} onClick={() => { this.setState({ place: null /* Don't erase lat/lng */ }); }}>Unmark</Button>\r\n\t\t\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t</Row>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<Row className=\"gradient-overlay-inverted\"></Row>\r\n\t\t\t\t</Col>\r\n\r\n\t\t\t\t<Col span={24} style={{ padding: \"20px\" }}>\r\n\t\t\t\t\t<Input.TextArea\r\n\t\t\t\t\t\tstyle={{ padding: \"20px\" }}\r\n\t\t\t\t\t\tplaceholder=\"Description\"\r\n\t\t\t\t\t\trows={1}\r\n\t\t\t\t\t\tdefaultValue={state.description}\r\n\t\t\t\t\t\tonBlur={({ target: { value }}) => this.setState({ description: value })}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Col>\r\n\t\t\t</Row>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nfunction getBase64(file) {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n    reader.onload = () => resolve(reader.result);\r\n    reader.onerror = error => reject(error);\r\n  });\r\n}\r\n\r\nasync function onPreview(file) {\r\n\tlet src = file.url;\r\n\tif (!src) {\r\n\t\tsrc = await new Promise(resolve => {\r\n\t\t\tconst reader = new FileReader();\r\n\t\t\treader.readAsDataURL(file.originFileObj);\r\n\t\t\treader.onload = () => resolve(reader.result);\r\n\t\t});\r\n\t}\r\n\tconst image = new Image();\r\n\timage.src = src;\r\n\tconst imgWindow = window.open(src);\r\n\timgWindow.document.write(image.outerHTML);\r\n};","import { useState, useContext } from \"react\";\r\nimport _ from \"lodash\";\r\nimport PostCreate from \"./component\";\r\n\r\nimport { ContextLoading } from \"src/components\"; \r\n\r\nfunction Component(props) {\r\n\tconst [fileToRemove, setFileToRemove] = useState(\"\");\r\n\tconst [navPage, setNavPage] = useState(_.isEmpty(props.values?.gallery) ? 0 : 1);\r\n\tconst [zoom, setZoom] = useState(12);\r\n\r\n\tconst { saveLoading, placesLoading } = useContext(ContextLoading);\r\n\r\n\treturn (\r\n\t\t<PostCreate \r\n\t\t\t{...props}\r\n\r\n\t\t\tsaveLoading={saveLoading}\r\n\t\t\tplacesLoading={placesLoading} \r\n\r\n\t\t\tzoom={zoom} setZoom={setZoom}\r\n\r\n\t\t\tfileToRemove={fileToRemove} setFileToRemove={setFileToRemove}\r\n\t\t\tnavPage={navPage} setNavPage={setNavPage}\r\n\t\t/>\r\n\t);\r\n}\r\nexport default Component;","import { Component, createRef } from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\n\r\nimport GoogleMapReact from \"google-map-react\";\r\nimport { Collapse, Divider, Avatar, Input, Row, Col, Button, Carousel, Typography, Space, List, Tabs, Card, Spin, Tooltip, Image, Empty } from \"antd\";\r\nimport { FileImageFilled, LeftOutlined,  CaretLeftOutlined, CaretRightOutlined, CaretUpOutlined, CloseCircleFilled, CloseOutlined, LoadingOutlined, QuestionCircleFilled, EnvironmentFilled, SearchOutlined } from \"@ant-design/icons\";\r\nimport Resizer from \"react-image-file-resizer\";\r\nimport Supercluster from \"supercluster\";\r\nimport { Marker } from \"react-mapbox-gl\";\r\nimport _ from \"lodash\";\r\n\r\nimport { PlaceMarker, Map, StaticMap } from \"src/components\";\r\nimport \"./style.css\";\r\n\r\n// const google = window.google;\r\nconst zoomDistanceMapping = {\r\n\t17: 0.00375,\r\n\t15: 0.0075,\r\n\t13: 0.0375,\r\n\t12: 0.075,\r\n\t10: 0.1875,\r\n\t9: 0.375,\r\n\t8: 0.75,\r\n\t7: 1.875,\r\n\t6: 3.75,\r\n\t5: 7.5,\r\n\t4: 15,\r\n};\r\n\r\n// Nearest Neighbor algorithm for determining the closest zoom value\r\nfunction getZoomDistanceMapping(zoom) {\r\n\treturn _.map(zoomDistanceMapping, (value, key) => _.toNumber(key)).reduce((prev, curr) => \r\n\t\t(Math.abs(curr - zoom) < Math.abs(prev - zoom) ? curr : prev)\r\n\t);\r\n}\r\nexport default class OpenInviteCreate extends Component {\r\n\tstatic defaultState = {\r\n\t\tfiles: [], // Gallery photo uploads (Not used?)\r\n\t\tcoverFiles: [] // Cover photo uploads\r\n\t};\r\n\tstate = { ...OpenInviteCreate.defaultState };\r\n\r\n\tnavPages = [{\r\n\t\tname: \"Photoshoot Site\",\r\n\t\ttooltip: \"Set the location of your open invite\"\r\n\t}, {\r\n\t\tname: \"Details\",\r\n\t\ttooltip: \"Perview open invite and add details\"\r\n\t}];\r\n\ttimeoutCode = 0;\r\n\r\n  componentWillUnmount() {\r\n    // https://developers.google.com/maps/documentation/javascript/events#removing\r\n    // this.Maps && this.Maps.event.clearInstanceListeners(this.mapSearch);\r\n\t\t\r\n\t\tclearTimeout(this.timeoutCode);\r\n  }\r\n\r\n\trender() {\r\n\t\tconst { navPage } = this.props;\r\n\r\n\t\treturn (\r\n\t\t\t<Tabs\r\n\t\t\t\tcentered\r\n\t\t\t\tactiveKey={`${navPage}`}\r\n\t\t\t\trenderTabBar={(tabProps, tabBar) => this.renderTabBar(tabProps, tabBar)}\r\n\t\t\t>\r\n\t\t\t\t<Tabs.TabPane key=\"0\" className=\"open-invite-tab-container\">\r\n\t\t\t\t\t{ this.renderMapTab() }\r\n\t\t\t\t</Tabs.TabPane>\r\n\r\n\t\t\t\t<Tabs.TabPane key=\"1\" className=\"open-invite-tab-container\">\r\n\t\t\t\t\t{ this.renderDetailsTab() }\r\n\t\t\t\t</Tabs.TabPane>\r\n\t\t\t</Tabs>\r\n\t\t);\r\n\t}\r\n\r\n\trenderTabBar() {\r\n\t\tconst { mentionList, navPage, setNavPage, saveLoading, values } = this.props;\r\n\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<Row justify=\"space-between\" align=\"middle\" style={{ padding: \"20px\" }}>\r\n\t\t\t\t\t<Col><Button shape=\"circle\" icon={<CloseOutlined />} onClick={() => this.props.onDraft() } /></Col>\r\n\r\n\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t<Tooltip placement=\"bottom\" title={this.navPages[navPage].tooltip}>\r\n\t\t\t\t\t\t\t{ this.navPages[navPage].name }\r\n\t\t\t\t\t\t\t<QuestionCircleFilled style={{ marginLeft: \"10px\" }} />\r\n\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t</Col>\r\n\r\n\t\t\t\t\t<Col className=\"button-group\">\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tdisabled={saveLoading || navPage === 0}\r\n\t\t\t\t\t\t\tonClick={() => setNavPage(Math.max(navPage - 1, 0)) }\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<LeftOutlined />\r\n\t\t\t\t\t\t</Button>\r\n\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tloading={saveLoading}\r\n\t\t\t\t\t\t\ttype=\"primary\"\r\n\t\t\t\t\t\t\tonClick={async () => {\r\n\t\t\t\t\t\t\t\tif(navPage === _.size(this.navPages) - 1 ) {\r\n\t\t\t\t\t\t\t\t\tawait this.props.onSave({\r\n\t\t\t\t\t\t\t\t\t\t...this.state,\r\n\t\t\t\t\t\t\t\t\t\tid: values?.id || this.state.id\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t// Delay the tab transition for elegance\r\n\t\t\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\t\t\tthis.setState(OpenInviteCreate.defaultState);\r\n\t\t\t\t\t\t\t\t\t\tsetNavPage(0);\r\n\t\t\t\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tsetNavPage(Math.min(navPage + 1, 2))\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{ navPage < _.size(this.navPages) - 1 ? (navPage === 1 && _.size(mentionList) === 0) ? \"Skip\" : \"Next\" : !_.isEmpty(values.id) ? \"Save\" : \"Publish\"}\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t</Row>\r\n\t\t\t\t<Divider style={{ margin: 0 }} />\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n\r\n\trenderMapTab() {\r\n\t\tconst { \r\n\t\t\tvalues,\r\n\t\t\tnavPage, setNavPage, \r\n\t\t\tplaces, placesLoading, \r\n\t\t\tzoom, setZoom \r\n\t\t} = this.props;\r\n\r\n\t\t// Merge original values to state values\r\n\t\tconst state = { ...this.props.values, ...this.state };\r\n\r\n\t\t// Cluster the map markers based on zoom value\r\n\t\tconst clusterMarkers = new Supercluster({\r\n\t\t\tminZoom: 0,\r\n\t\t\tmaxZoom: 20,\r\n\t\t\tradius: 30,\r\n\t\t\textent: 512,\r\n\t\t\tmap: props => ({ sum: 1 }),\r\n\t\t\treduce: (accumulated, props) => { accumulated.sum += props.sum; }\r\n\t\t});\r\n\t\tclusterMarkers.load(_.map(places, place =>  ({\r\n\t\t\t\"type\": \"Feature\",\r\n\t\t\t\"geometry\": { \"type\": \"Point\", \"coordinates\": [place.lng, place.lat] },\r\n\t\t\tplace\r\n\t\t})));\r\n\t\tconst markers = clusterMarkers.getClusters([-180, -85, 180, 85], zoom);\r\n\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<Row id=\"invite-map-container\">\r\n\t\t\t\t\t<Map\r\n\t\t\t\t\t\tstyle=\"mapbox://styles/mapbox/outdoors-v11\"\r\n\t\t\t\t\t\tcontainerStyle={{\r\n\t\t\t\t\t\t\theight: \"100%\",\r\n\t\t\t\t\t\t\twidth: \"100%\"\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tcenter={[state.lng, state.lat]}\r\n\t\t\t\t\t\tonZoomStart={map => setZoom(Math.trunc(map.getZoom()))}\r\n\t\t\t\t\t\tonDragEnd={(map, event) => {\r\n\t\t\t\t\t\t\tconst { lat, lng } = map.getCenter();\r\n\t\t\t\t\t\t\tthis.setState({ lat, lng });\r\n\t\t\t\t\t\t\tmap.easeTo({ center: [lng, lat] });\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// Get Zoom value for places search\r\n\t\t\t\t\t\t\tconst zoom = Math.trunc(map.getZoom());\r\n\t\t\t\t\t\t\tsetZoom(zoom);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{ \r\n\t\t\t\t\t\t\t_.map(markers, marker => {\r\n\t\t\t\t\t\t\t\tconst { geometry: { coordinates }, properties, post } = marker;\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<Marker coordinates={[coordinates[0], coordinates[1]]}>\r\n\t\t\t\t\t\t\t\t\t\t<PlaceMarker\r\n\t\t\t\t\t\t\t\t\t\t\tmarker={marker}\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst { place } = marker;\r\n\t\t\t\t\t\t\t\t\t\t\t\tif(_.isEmpty(place)) return;\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.setState({ place: place, lat: place.lat, lng: place.lng });\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetTimeout(() => setNavPage(Math.min(navPage + 1, 2)), 500);\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</Marker>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t{/*<Marker coordinates={[state.lng, state.lat]}>\r\n\t\t\t\t\t\t\t<EnvironmentFilled \r\n\t\t\t\t\t\t\t\tlat={state.lat} lng={state.lng}\r\n\t\t\t\t\t\t\t\tstyle={{ fontSize: 40, color: \"var(--ant-primary-color)\" }} \r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</Marker>*/}\r\n\r\n\t\t\t\t\t\t<EnvironmentFilled \r\n\t\t\t\t\t\t\tstyle={{ \r\n\t\t\t\t\t\t\t\tfontSize: 40, color: \"var(--ant-primary-color)\",\r\n\t\t\t\t\t\t\t\tposition: \"absolute\",\r\n\t\t\t\t\t\t\t\ttop: \"calc(50% - 20px)\",\r\n\t\t\t\t\t\t\t\tleft: \"50%\",\r\n\t\t\t\t\t\t\t\ttransform: \"translate(-50%, -50%)\",\r\n\t\t\t\t\t\t\t\tzIndex: 10\r\n\t\t\t\t\t\t\t}} \r\n\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t_.isFunction(this.props.onSearchPlaces) && (\r\n\t\t\t\t\t\t\t\t<div style={{ \r\n\t\t\t\t\t\t\t\t\tfontSize: 40, color: \"var(--ant-primary-color)\",\r\n\t\t\t\t\t\t\t\t\tposition: \"absolute\",\r\n\t\t\t\t\t\t\t\t\tbottom: \"20px\",\r\n\t\t\t\t\t\t\t\t\tleft: \"50%\",\r\n\t\t\t\t\t\t\t\t\ttransform: \"translateX(-50%)\",\r\n\t\t\t\t\t\t\t\t\tzIndex: 10\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t_.isNumber(zoom) && zoom < 12 ? (\r\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip title=\"Zoom Closer\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Button \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={_.isNumber(zoom) && zoom < 12}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon={<SearchOutlined />}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => this.props.onSearchPlaces({ lat: state.lat, lng: state.lng, radius: zoomDistanceMapping[getZoomDistanceMapping(zoom)] })}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tParks\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\tloading={placesLoading}\r\n\t\t\t\t\t\t\t\t\t\t\t\ticon={<SearchOutlined />}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => this.props.onSearchPlaces({ lat: state.lat, lng: state.lng, radius: zoomDistanceMapping[getZoomDistanceMapping(zoom)] })}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\tParks\r\n\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</Map>\r\n\t\t\t\t</Row>\r\n\t\t\t\t\t\r\n\t\t\t\t<Row id=\"search-places-container\">\r\n\t\t\t\t\t<Col span={24}>\r\n\t\t\t\t\t\t<Divider plain orientation=\"left\">\r\n\t\t\t\t\t\t\t<Tooltip placement=\"right\" title=\"Set the photoshoot location\">\r\n\t\t\t\t\t\t\t\tSet Location\r\n\t\t\t\t\t\t\t\t<QuestionCircleFilled style={{ marginLeft: \"10px\" }} />\r\n\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t</Divider>\r\n\r\n\t\t\t\t\t\t<Spin spinning={placesLoading} indicator={<LoadingOutlined style={{ fontSize: 60 }} spin />}>\r\n\t\t\t\t\t\t\t<List\r\n\t\t\t\t\t\t\t\tid=\"search-places-list\"\r\n\t\t\t\t\t\t\t\tsplit={false}\r\n\t\t\t\t\t\t\t\tdataSource={places}\r\n\t\t\t\t\t\t\t\trenderItem={place => (\r\n\t\t\t\t\t\t\t\t\t<List.Item \r\n\t\t\t\t\t\t\t\t\t\tkey={place.id}\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tthis.setState({ place: place, lat: place.lat, lng: place.lng });\r\n\t\t\t\t\t\t\t\t\t\t\tsetTimeout(() => setNavPage(Math.min(navPage + 1, 2)), 500);\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t!_.isEmpty(place.photos) ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Card bordered={false} className=\"search-places-item\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t!_.isEmpty(place.photos) ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Image preview={false} alt=\"place-cover\" className=\"search-places-cover\" src={_.first(place.photos)} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Row justify=\"space-between\" align=\"start\" className=\"search-places-content\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col span={18}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography.Title level={3} style={{ color: \"white\", margin: 0 }}>{place.name}</Typography.Title>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography.Text style={{ color: \"white\" }}>{place.openNow ? \"Open\" : \"\"}</Typography.Text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col span={6}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talt=\"powered-by-google\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc=\"/powered-by-google.png\" \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ width: \"100%\" }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/*<div className=\"search-places-content\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography.Title level={3} style={{ color: \"white\", margin: 0 }}>{place.name}</Typography.Title>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography.Text style={{ color: \"white\" }}>{place.openNow ? \"Open\" : \"\"}</Typography.Text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>*/}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Row className=\"gradient-overlay-inverted\"></Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Card>\r\n\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<List.Item.Meta\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"search-places-item\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tavatar={<Avatar src={place.icon} />}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle={place.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdescription={place.openNow ? \"Open\" : \"\"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t</List.Item>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</Spin>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t</Row>\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n\r\n\trenderDetailsTab() {\r\n\t\tconst { \r\n\t\t\tmentionList, setMentionList,\r\n\t\t\tmentionToRemove, setMentionToRemove,\r\n\t\t\tfileToRemove, setFileToRemove,\r\n\t\t\tsearchUsers, searchUsersLoading,\r\n\t\t\tuploadPhotoVisibility, setUploadPhotoVisibility,\r\n\t\t\tnavPage,\r\n\t\t\tcurrentSlide, setCurrentSlide,\r\n\t\t} = this.props;\r\n\r\n\t\t// Merge original values to state values\r\n\t\tconst state = { ...this.props.values, ...this.state };\r\n\r\n\t\t// Merge cover gallery with uploaded photos and trim to 3 items\r\n\t\tconst postPhotos = _(state.cover)\r\n\t\t\t.concat(this.state.coverFiles)\r\n\t\t\t.compact()\r\n\t\t\t.concat(new Array(3))\r\n\t\t\t.slice(0, 3)\r\n\t\t\t.value();\r\n\r\n\t\treturn (\r\n\t\t\t<Row justify=\"center\">\r\n\t\t\t\t<Col id=\"invite-details-container\">\r\n\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t<Row justify=\"space-between\" align=\"start\" className=\"search-places-content\">\r\n\t\t\t\t\t\t\t<Col span={18}>\r\n\t\t\t\t\t\t\t\t<Typography.Title level={3} style={{ color: \"white\", margin: 0 }}>{state.place?.name}</Typography.Title>\r\n\t\t\t\t\t\t\t\t<Typography.Text style={{ color: \"white\" }}>{state.place?.openNow ? \"Open\" : \"\"}</Typography.Text>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t<Col span={6}>\r\n\t\t\t\t\t\t\t\t<img \r\n\t\t\t\t\t\t\t\t\talt=\"powered-by-google\"\r\n\t\t\t\t\t\t\t\t\tsrc=\"/powered-by-google.png\" \r\n\t\t\t\t\t\t\t\t\tstyle={{ width: \"100%\", opacity: _.isEmpty(state.cover) && !_.isEmpty(state.place?.photos) && currentSlide !== _.size(state.place?.photos) ? 1 : 0, transition: \"opacity .33s ease-in-out\" }}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t<Carousel \r\n\t\t\t\t\t\t\tdotPosition=\"bottom\"\r\n\t\t\t\t\t\t\tarrows\r\n\t\t\t\t\t\t\tprevArrow={<CaretLeftOutlined />}\r\n\t\t\t\t\t\t\tnextArrow={<CaretRightOutlined />}\r\n\t\t\t\t\t\t\tafterChange={currentSlide => setCurrentSlide(currentSlide)}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t!_.isEmpty(_.compact(postPhotos)) ? _.map(_.compact(postPhotos), file => ( // This tells react to render images from the `state.coverFiles`\r\n\t\t\t\t\t\t\t\t\t<div className=\"gallery-item\">\r\n\t\t\t\t\t\t\t\t\t\t<Image\r\n\t\t\t\t\t\t\t\t\t\t\talt=\"post\" \r\n\t\t\t\t\t\t\t\t\t\t\tkey={file.name || file.id}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"gallery-cover\"\r\n\t\t\t\t\t\t\t\t\t\t\tsrc={file.preview || `https://firebasestorage.googleapis.com/v0/b/pikature.appspot.com/o/${file.name}?alt=media`}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t)) : _.map(!_.isEmpty(state.cover) ? state.cover : state?.photos || state.place?.photos, photo => ( // This tells React whether to render images from `Post.places (original value)`, `state.place (newly-set value)`, or from the cover gallery\r\n\t\t\t\t\t\t\t\t\t<div className=\"gallery-item\">\r\n\t\t\t\t\t\t\t\t\t\t<Image preview={false} alt=\"post-cover\" className=\"gallery-cover\" src={typeof photo === \"string\" ? photo : `https://firebasestorage.googleapis.com/v0/b/pikature.appspot.com/o/${photo.name}?alt=media`} />\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t<div className=\"gallery-item\">\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tnavPage === 1 &&\t(\r\n\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t<StaticMap\r\n\t\t\t\t\t\t\t\t\t\t\t\tlat={state.lat}\r\n\t\t\t\t\t\t\t\t\t\t\t\tlng={state.lng}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<EnvironmentFilled \r\n\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfontSize: 40, color: \"var(--ant-primary-color)\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tposition: \"absolute\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttop: \"50%\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tleft: \"50%\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttransform: \"translate(-50%, -50%)\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tzIndex: 10\r\n\t\t\t\t\t\t\t\t\t\t\t\t}} \r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</Carousel>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<Row justify=\"end\" align=\"bottom\" id=\"search-places-actions\">\r\n\t\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t\t<div className=\"button-group\" style={{ textAlign: \"right\" }}>\r\n\t\t\t\t\t\t\t\t\t<Button icon={uploadPhotoVisibility ? <CaretUpOutlined /> : <FileImageFilled />} onClick={() => setUploadPhotoVisibility(!uploadPhotoVisibility) || (!uploadPhotoVisibility && document.getElementById(\"search-places-actions\").scrollIntoView({ behavior: \"smooth\" }))}>Cover</Button>\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t!_.isEmpty(state.place) ? (\r\n\t\t\t\t\t\t\t\t\t\t\t<Button icon={<CloseOutlined />} onClick={() => { this.setState({ place: null /* Don't erase lat/lng */ }); }}>Unmark</Button>\r\n\t\t\t\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Row>\r\n\r\n\t\t\t\t\t\t<Row className=\"gradient-overlay-inverted\"></Row>\r\n\t\t\t\t\t</Col>\r\n\r\n\t\t\t\t\t<Collapse \r\n\t\t\t\t\t\tghost\r\n\t\t\t\t\t\tactiveKey={[uploadPhotoVisibility ? 1 : 0]}\r\n\t\t\t\t\t\texpandIcon={props => null}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{/* Upload Photo Visibility indicates whether the Panel key is collapsed or not */}\r\n\t\t\t\t\t\t<Collapse.Panel key={1}> \r\n\t\t\t\t\t\t\t<Row justify=\"space-between\" gutter={0}>\r\n\t\t\t\t\t\t\t\t<input \r\n\t\t\t\t\t\t\t\t\tid=\"file-upload-input\"\r\n\t\t\t\t\t\t\t\t\tstyle={{ display: \"none\" }}\r\n\t\t\t\t\t\t\t\t\ttype=\"file\" \r\n\t\t\t\t\t\t\t\t\tmultiple\r\n\t\t\t\t\t\t\t\t\tonChange={async ({ target: { files } }) => {\r\n\t\t\t\t\t\t\t\t\t\tconst stateFiles = this.state.coverFiles;\r\n\t\t\t\t\t\t\t\t\t\tconst toConvert = []; // Resize all fils to a max dimentions of 300x300\r\n\t\t\t\t\t\t\t\t\t\tfor(let file of _.slice(files, 0, 3 - _.size(_.concat(stateFiles, this.state.cover)))) {\r\n\t\t\t\t\t\t\t\t\t\t\ttoConvert.push(new Promise(resolve => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tResizer.imageFileResizer(file,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t1500, 1500, \"JPEG\", 90, 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfile => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// We normally use `type` property but this mimetype is for GraphQL Upload file object\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfile.mimetype = file.type;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (!file.url && !file.preview) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfile.preview = URL.createObjectURL(file);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tresolve(file);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"file\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tconst toAppend = await Promise.all(toConvert);\r\n\t\t\t\t\t\t\t\t\t\tthis.setState({ coverFiles: _(stateFiles).concat(toAppend).slice(0, 3).value() });\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t// Clear Value of input to allow uploading of \"same\" file\r\n\t\t\t\t\t\t\t\t\t\tdocument.getElementById(\"file-upload-input\").value = null;\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tpostPhotos.map((file, index) => (\r\n\t\t\t\t\t\t\t\t\t\t<Col span={8} key={file?.name || index} style={{ height: \"33vw\", maxHeight: \"192px\" }}>\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t_.isEmpty(file?.name) ? ( // This indicates that the photo comes from the original `Post.cover`\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<label htmlFor=\"file-upload-input\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Row\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tjustify=\"center\" align=\"middle\" className=\"invite-upload-image\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ backgroundColor: \"#00000010\", border: \"1px dashed #00000010\" }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FileImageFilled style={{ fontSize: 20, opacity: 0.33 }} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t) : ( // This indicates that the photo is an Upload file\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Row\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tjustify=\"center\" align=\"middle\" className=\"invite-upload-image\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ backgroundImage: !_.isEmpty(file.preview) ? `url(\"${file.preview}\")` : `url(\"https://firebasestorage.googleapis.com/v0/b/pikature.appspot.com/o/${file.name}?alt=media\")` }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetFileToRemove(fileToRemove === index ? \"\" : index);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclearTimeout(this.timeoutCode);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.timeoutCode = setTimeout(() => setFileToRemove(\"\"), 3000);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfileToRemove === index ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Row\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tjustify=\"center\" align=\"middle\" className=\"invite-upload-image\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbackgroundColor: \"#00000066\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor: \"white\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ height: \"60px\", width: \"60px\", borderRadius: \"50%\" }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon={<CloseOutlined style={{ fontSize: 30 }} />}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst toRemove = _.get(postPhotos, fileToRemove);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(toRemove?.id) { // This means the photo to remove is found in the gallery\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.setState({ cover: _.filter(state.cover, photo => photo !== toRemove )});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t} else if(toRemove?.name) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.setState({ coverFiles: _.filter(state.coverFiles, file => file !== toRemove) });\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t))\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t</Collapse.Panel>\r\n\t\t\t\t\t</Collapse>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<Row style={{ padding: \"20px\" }}>\r\n\t\t\t\t\t\t<Input.TextArea\r\n\t\t\t\t\t\t\tstyle={{ padding: \"20px\" }}\r\n\t\t\t\t\t\t\tplaceholder={`${[\r\n\t\t\t\t\t\t\t\t\"Meetup at 5:30pm. Be there or be square\", \r\n\t\t\t\t\t\t\t\t\"Saturday-night photo trip around this area\",\r\n\t\t\t\t\t\t\t\t\"Bring your pet!\"\r\n\t\t\t\t\t\t\t][Math.floor(_.random(0, 2))]}`}\r\n\t\t\t\t\t\t\trows={4}\r\n\t\t\t\t\t\t\tvalue={state.description}\r\n\t\t\t\t\t\t\tonChange={({ target: { value }}) => this.setState({ description: value })}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Row>\r\n\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t!_.isEmpty(state.id) && (\r\n\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t<Divider plain orientation=\"left\">\r\n\t\t\t\t\t\t\t\t\t<Tooltip placement=\"right\" title=\"Collaborate! People listed here have joined this Open Invite\">\r\n\t\t\t\t\t\t\t\t\t\tGuests\r\n\t\t\t\t\t\t\t\t\t\t<QuestionCircleFilled style={{ marginLeft: \"10px\" }} />\r\n\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t</Divider>\r\n\r\n\t\t\t\t\t\t\t\t<Row>\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t!_.isEmpty(state.guests) ? (\r\n\t\t\t\t\t\t\t\t\t\t\t<Space id=\"invite-people-guests\" size={10} direction=\"horizontal\" align=\"center\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t_.map(state.guests, guest => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"invite-prople-profile-selected\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ position: \"relative\", width: \"50px\", borderRadius: \"50%\", overflow: \"hidden\" }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetMentionToRemove(guest);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclearTimeout(this.timeoutCode);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.timeoutCode = setTimeout(setMentionToRemove, 3000, null);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmentionToRemove?.id === guest.id ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ position: \"absolute\", width: \"100%\", height: \"100%\", backgroundColor: \"#00000066\" }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon={(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<CloseCircleFilled\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ color: \"white\", fontSize: 30 }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={event => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tevent.stopPropagation();  // Prevent the parent `onClick` into calling the mentionToRemove function\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetMentionToRemove(null);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.setState({ guests: _.filter(state.guests, user => user.id !== mentionToRemove.id) });\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talt=\"profile\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={guest?.picture}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ width: \"100%\", margin: \"auto\" }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)) \r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t</Space>\r\n\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t<Col span={24}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Empty image={Empty.PRESENTED_IMAGE_SIMPLE} description=\"No guests yet\" />\r\n\t\t\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t</Row>\r\n\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tfalse && (\r\n\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t<Row style={{ padding: \"20px\" }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Input\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"invite-people-search\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Search\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\taddonBefore=\"@\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={({ target: { value: search }}) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclearTimeout(this.timeoutCode);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!search) return;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetMentionList([]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.timeoutCode = setTimeout(() => this.props.onSearchUsers(search), 1000);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t<Row style={{ padding: \"0 20px\" }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Col span={24} style={{ minHeight: \"25vh\" }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Spin spinning={searchUsersLoading} indicator={<LoadingOutlined style={{ fontSize: 60 }} spin />}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<List\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsplit={false}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdataSource={_.filter(searchUsers, user => _.indexOf(_.map(state.guests, \"id\"), user.id) === -1)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trenderItem={user => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<List.Item\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={user.id}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ cursor: \"pointer\" }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => this.setState({ guests: [..._.filter(state.guests, guest => guest.id !== user.id), user] })}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<List.Item.Meta\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tavatar={(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Avatar\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize={50}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon={<img alt=\"profile\" src={user.picture} />} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle={<Typography.Text style={{ margin: 0 }}>{ user.tag }</Typography.Text>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//description={<Typography.Paragraph>{ _.find(state.guests, { id: user.id }) ? \"Added\" : \"\" }</Typography.Paragraph>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</List.Item>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Spin>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t}\r\n\t\t\t\t</Col>\r\n\t\t\t</Row>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nfunction getBase64(file) {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n    reader.onload = () => resolve(reader.result);\r\n    reader.onerror = error => reject(error);\r\n  });\r\n}","import { useState, useContext } from \"react\";\r\nimport _ from \"lodash\";\r\n\r\nimport { ContextLoading } from \"src/components\";\r\nimport OpenInviteCreate from \"./component\";\r\n\r\n\r\nfunction Component(props) {\r\n\tconst [mentionToRemove, setMentionToRemove] = useState(\"\");\r\n\tconst [fileToRemove, setFileToRemove] = useState(\"\");\r\n\tconst [navPage, setNavPage] = useState(_.isEmpty(props.values.id) ? 0 : 1); // If this is an edit, go to the navPage\r\n\tconst [uploadPhotoVisibility, setUploadPhotoVisibility] = useState(0);\r\n\tconst [currentSlide, setCurrentSlide] = useState();\r\n\tconst [zoom, setZoom] = useState(12);\r\n\r\n\tconst { saveLoading, placesLoading, searchUsersLoading } = useContext(ContextLoading);\r\n\t\r\n\treturn (\r\n\t\t<OpenInviteCreate\r\n\t\t\t{...props}\r\n\t\t\t\r\n\t\t\tsaveLoading={saveLoading} \r\n\t\t\tplacesLoading={placesLoading} \r\n\t\t\tsearchUsersLoading={searchUsersLoading}\r\n\r\n\t\t\tzoom={zoom} setZoom={setZoom}\r\n\t\t\t\r\n\t\t\tmentionToRemove={mentionToRemove} setMentionToRemove={setMentionToRemove}\r\n\t\t\tnavPage={navPage} setNavPage={setNavPage}\r\n\t\t\tcurrentSlide={currentSlide} setCurrentSlide={setCurrentSlide}\r\n\t\t\tfileToRemove={fileToRemove} setFileToRemove={setFileToRemove}\r\n\t\t\tuploadPhotoVisibility={uploadPhotoVisibility} setUploadPhotoVisibility={setUploadPhotoVisibility}\r\n\t\t/>\r\n\t);\r\n}\r\n\r\nexport default Component;\r\n\r\n","import { Component } from \"react\";\r\n\r\nimport GoogleMapReact from \"google-map-react\";\r\nimport { Divider, Avatar, Input, Row, Col, Button, Breadcrumb, Typography, Space, List, Tabs, Upload } from \"antd\";\r\nimport { FileImageFilled, PushpinFilled, LeftOutlined, PlusCircleFilled, CloseCircleFilled, CloseSquareFilled } from \"@ant-design/icons\";\r\nimport _ from \"lodash\";\r\nimport Moment from \"moment\";\r\n\r\nimport { Post } from \"src/components\";\r\nimport \"./style.css\";\r\n\r\nexport default class OpenInviteList extends Component {\r\n\tstatic DisplayTypes = {\r\n\t\tGRID: 0,\r\n\t\tPANEL: 1\r\n\t};\r\n\r\n\tnavPages = [\"Photoshoot Site\", \"Invite\", \"Upload\"];\r\n\ttimeoutCode = 0;\r\n\r\n\trender() {\r\n\t\tconst { displayType, posts } = this.props;\r\n\t\t\r\n\t\tswitch(displayType) {\r\n\t\t\tcase OpenInviteList.DisplayTypes.GRID: {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<List\r\n\t\t\t\t\t\tdataSource={posts}\r\n\t\t\t\t\t\trenderItem={post => (\r\n\t\t\t\t\t\t\t<Post\r\n\t\t\t\t\t\t\t\tpost={post}\r\n\t\t\t\t\t\t\t\tisGuestVisible={post.id === this.props.guestVisible}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tcase OpenInviteList.DisplayTypes.PANEL: {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<List\r\n\t\t\t\t\t\tdataSource={posts}\r\n\t\t\t\t\t\trenderItem={post => (\r\n\t\t\t\t\t\t\t<Post\r\n\t\t\t\t\t\t\t\tpost={post}\r\n\t\t\t\t\t\t\t\tisGuestVisible={post.id === this.props.guestVisible}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tdefault: \r\n\t\t\t\treturn (\r\n\t\t\t\t\t<List\r\n\t\t\t\t\t\tdataSource={posts}\r\n\t\t\t\t\t\trenderItem={post => (\r\n\t\t\t\t\t\t\t<Post\r\n\t\t\t\t\t\t\t\tpost={post}\r\n\t\t\t\t\t\t\t\tisGuestVisible={post.id === this.props.guestVisible}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t)\r\n\t\t}\r\n\t}\r\n}","import { useState, useRef } from \"react\";\r\n\r\nimport OpenInviteList from \"./component\";\r\n\r\nfunction Component(props) {\r\n\tconst [guestVisible, setGuestVisible] = useState();\r\n\r\n\treturn (\r\n\t\t<OpenInviteList\r\n\t\t\t{...props}\r\n\t\t\tguestVisible={guestVisible} setGuestVisible={setGuestVisible}\r\n\t\t/>\r\n\t);\r\n}\r\n\r\nexport default Component;\r\n\r\n","import { Component } from \"react\";\r\n\r\nimport GoogleMapReact from \"google-map-react\";\r\nimport { Spin, Empty, Input, Row, Col, Button, Breadcrumb, Typography, Space, List, Tabs, Card } from \"antd\";\r\nimport { LoadingOutlined, PlusOutlined, CameraFilled, PlusCircleFilled, CloseCircleFilled, CloseSquareFilled } from \"@ant-design/icons\";\r\nimport _, { min } from \"lodash\";\r\nimport Moment from \"moment\";\r\n\r\nimport { Post, ContextLoading } from \"src/components\";\r\nimport \"./style.css\";\r\n\r\nexport default class PostList extends Component {\r\n\tstatic DisplayTypes = {\r\n\t\tGRID: 0,\r\n\t\tPANEL: 1\r\n\t};\r\n\r\n\tnavPages = [\"Photoshoot Site\", \"Invite\", \"Upload\"];\r\n\ttimeoutCode = 0;\r\n\r\n\trender() {\r\n\t\tconst { displayType, loading = false, style } = this.props;\r\n\t\tlet { posts } = this.props;\r\n\t\t// Pre-pend the add button if there is an onAdd function in props\r\n\t\tif(_.isEmpty(posts)) {\r\n\t\t\tif(!loading && _.isFunction(this.props.onAdd)) posts = [{}].concat(posts);\r\n\t\t} else if(_.isFunction(this.props.onAdd)) {\r\n\t\t\tposts = [{}].concat(posts);\r\n\t\t}\r\n\t\t\r\n\t\tswitch(displayType) {\r\n\t\t\tcase PostList.DisplayTypes.GRID: {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<Spin spinning={_.isEmpty(posts) ? false : loading} indicator={!_.isEmpty(posts) ? null : <LoadingOutlined style={{ fontSize: 60 }} spin />}>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t_.isEmpty(posts) ? this.renderPostsPlaceholder() : (\r\n\t\t\t\t\t\t\t\t<List\r\n\t\t\t\t\t\t\t\t\tstyle={style}\r\n\t\t\t\t\t\t\t\t\tsplit={false}\r\n\t\t\t\t\t\t\t\t\tdataSource={_.chunk(posts, 3)}\r\n\t\t\t\t\t\t\t\t\trenderItem={(chunkedPosts, index) => (\r\n\t\t\t\t\t\t\t\t\t\t<List.Item key={index} className=\"postlist-post-container\">\r\n\t\t\t\t\t\t\t\t\t\t\t<Row>\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t// We separate the posts in chunks to fix layout issues with post Carousel by surrounding the Post in Row objects and discreetly limiting Cols into groups of 3\r\n\t\t\t\t\t\t\t\t\t\t\t\t_.map(chunkedPosts, post => post?.id ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Col span={8} key={post.id} className={_.isFunction(this.props.onClick) ? \"postlist-post\" : \"\"} onClick={() => _.isFunction(this.props.onClick) && this.props.onClick(post)}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Post\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tautoplay={_.isEmpty(post.cover) && _.isEmpty(post.datePosted) && Math.floor(Math.random() * 2)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{...this.props.postProps(post)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tminimal\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpost={post}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tisGuestVisible={post.id === this.props.guestVisible}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t) : /* Render a placeholder if the post has no ID (This means the post is a placeholder) */ (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Col span={8} className={_.isFunction(this.props.onAdd) ? \"postlist-post\" : \"\"} onClick={() => _.isFunction(this.props.onAdd) && this.props.onAdd(post)}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Row justify=\"center\" align=\"middle\" className=\"post-upload-image\" style={{ height: \"min(33vw, 191px)\" }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<PlusOutlined style={{ fontSize: 60, opacity: 0.33 }} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t))\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t</List.Item>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</Spin>\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tcase PostList.DisplayTypes.PANEL:\r\n\t\t\tdefault: {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<Spin spinning={_.isEmpty(posts) ? false : loading} indicator={!_.isEmpty(posts) ? null : <LoadingOutlined style={{ fontSize: 60 }} spin />}>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t_.isEmpty(posts) ? this.renderPostsPlaceholder() : (\r\n\t\t\t\t\t\t\t\t<List\r\n\t\t\t\t\t\t\t\t\tstyle={style}\r\n\t\t\t\t\t\t\t\t\tsplit={false}\r\n\t\t\t\t\t\t\t\t\tdataSource={posts}\r\n\t\t\t\t\t\t\t\t\trenderItem={post => post?.id ? (\r\n\t\t\t\t\t\t\t\t\t\t<List.Item key={post.id} className={`postlist-post-container ${_.isFunction(this.props.onClick) ? \"postlist-post\" : \"\"}`} onClick={() => _.isFunction(this.props.onClick) && this.props.onClick(post)}>\r\n\t\t\t\t\t\t\t\t\t\t\t<Post\r\n\t\t\t\t\t\t\t\t\t\t\t\t{...this.props.postProps(post)}\r\n\t\t\t\t\t\t\t\t\t\t\t\tkey={post.id}\r\n\t\t\t\t\t\t\t\t\t\t\t\tpost={post}\r\n\t\t\t\t\t\t\t\t\t\t\t\tisGuestVisible={post.id === this.props.guestVisible}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</List.Item>\r\n\t\t\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t\t\t\t//(\r\n\t\t\t\t\t\t\t\t\t//\t<Row\r\n\t\t\t\t\t\t\t\t\t//\t\tclassName={`post-upload-image ${_.isFunction(this.props.onAdd) ? \"postlist-post\" : \"\"}`}\r\n\t\t\t\t\t\t\t\t\t//\t\tjustify=\"center\" align=\"middle\"\r\n\t\t\t\t\t\t\t\t\t//\t\tstyle={{ marginBottom: \"30px\" }}\r\n\t\t\t\t\t\t\t\t\t//\t\tonClick={() => _.isFunction(this.props.onAdd) && this.props.onAdd(post)}\r\n\t\t\t\t\t\t\t\t\t//\t>\r\n\t\t\t\t\t\t\t\t\t//\t\t<PlusOutlined style={{ fontSize: 60, opacity: 0.33, margin: \"20px\" }} />\r\n\t\t\t\t\t\t\t\t\t//\t</Row>\r\n\t\t\t\t\t\t\t\t\t//)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</Spin>\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\trenderPostsPlaceholder() {\r\n\t\tconst { loading } = this.props;\r\n\r\n\t\tif(!loading) {\r\n\t\t\treturn (\r\n\t\t\t\t<Empty image={Empty.PRESENTED_IMAGE_SIMPLE} description=\"No posts yet\" />\r\n\t\t\t);\r\n\t\t}\r\n\t\r\n\t\treturn (\r\n\t\t\t<Row>\r\n\t\t\t\t<Col span={8} className=\"post-placeholder-grid\"></Col>\r\n\t\t\t\t<Col span={8} className=\"post-placeholder-grid\"></Col>\r\n\t\t\t\t<Col span={8} className=\"post-placeholder-grid\"></Col>\r\n\t\t\t\t<Col span={8} className=\"post-placeholder-grid\"></Col>\r\n\t\t\t\t<Col span={8} className=\"post-placeholder-grid\"></Col>\r\n\t\t\t\t<Col span={8} className=\"post-placeholder-grid\"></Col>\r\n\t\t\t\t<Col span={8} className=\"post-placeholder-grid\"></Col>\r\n\t\t\t\t<Col span={8} className=\"post-placeholder-grid\"></Col>\r\n\t\t\t\t<Col span={8} className=\"post-placeholder-grid\"></Col>\r\n\t\t\t</Row>\r\n\t\t);\r\n\t}\r\n}","import { useState, useEffect, useContext } from \"react\";\r\nimport { ContextLoading } from \"src/components\";\r\nimport PostList from \"./component\";\r\n\r\nexport default function Component(props) {\r\n\tconst { postsLoading, userLoading } = useContext(ContextLoading);\r\n\treturn (\r\n\t\t<PostList {...props} loading={postsLoading || userLoading} />\r\n\t);\r\n}\r\n\r\n// https://stackoverflow.com/questions/36862334/get-viewport-window-height-in-reactjs\r\nfunction getWindowDimensions() {\r\n\tconst { innerWidth: width, innerHeight: height } = window;\r\n\treturn { width, height };\r\n}\r\n\r\nfunction useWindowDimensions() {\r\n\tconst [windowDimensions, setWindowDimensions] = useState(getWindowDimensions());\r\n\r\n\tuseEffect(() => {\r\n\t\tfunction handleResize() {\r\n\t\t\tsetWindowDimensions(getWindowDimensions());\r\n\t\t}\r\n\r\n\t\twindow.addEventListener(\"resize\", handleResize);\r\n\t\treturn () => window.removeEventListener(\"resize\", handleResize);\r\n\t}, []);\r\n\r\n\treturn windowDimensions;\r\n}","import { Component } from \"react\";\r\nimport { Button } from \"antd\";\r\n\r\nimport \"./style.css\";\r\n\r\nexport default class PostMarker extends Component {\r\n\trender() {\r\n\t\tconst { marker: { properties }} = this.props;\r\n\t\treturn (\r\n\t\t\t<Button\r\n\t\t\t\ttype=\"primary\" \r\n\t\t\t\tsize={properties?.sum > 0 ? \"large\" : undefined}\r\n\t\t\t\tclassName=\"post-marker\"\r\n\t\t\t\tstyle={{ zIndex: Math.min(1, properties?.sum)  /* Render clusters on top of normal markers */ }}\r\n\t\t\t\tonClick={this.props.onClick}\r\n\t\t\t>\r\n\t\t\t\t{\r\n\t\t\t\t\tproperties?.post?.host.picture ? (\r\n\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\talt=\"profile\"\r\n\t\t\t\t\t\t\tsrc={properties?.post?.host.picture}\r\n\t\t\t\t\t\t\tstyle={{ width: \"20px\", borderRadius: \"50%\", marginRight: \"10px\" }}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t) : null\r\n\t\t\t\t}\r\n\t\t\t\t{ properties?.post?.host.tag || properties?.sum }\r\n\t\t\t</Button>\r\n\t\t);\r\n\t}\r\n}","import Component from \"./component\";\r\n\r\nexport default Component;","import { Component } from \"react\";\r\nimport { Button } from \"antd\";\r\n\r\nimport \"./style.css\";\r\n\r\nexport default class PlaceMarker extends Component {\r\n\trender() {\r\n\t\tconst { marker: { place, properties }} = this.props;\r\n\t\treturn (\r\n\t\t\t<Button\r\n\t\t\t\ttype=\"primary\" \r\n\t\t\t\tsize={properties?.sum > 0 ? \"large\" : undefined}\r\n\t\t\t\tclassName=\"place-marker\"\r\n\t\t\t\tstyle={{ zIndex: Math.min(1, properties?.sum)  /* Render clusters on top of normal markers */ }}\r\n\t\t\t\tonClick={this.props.onClick}\r\n\t\t\t>\r\n\t\t\t\t{ properties?.sum || place.name }\r\n\t\t\t</Button>\r\n\t\t);\r\n\t}\r\n}","import Component from \"./component\";\r\n\r\nexport default Component;","export default __webpack_public_path__ + \"static/media/terms-and-conditions.abea969b.md\";","import { useEffect, useState } from \"react\";\r\nimport ReactMarkdown from \"react-markdown\";\r\nimport \"./style.css\";\r\n\r\n// Content\r\nimport MarkdownDirectory from \"./terms-and-conditions.md\";\r\n\r\nexport default function TermsAndConditions(props) {\r\n\tconst [markdown, setMarkdown] = useState('');\r\n\r\n\t// useEffect with an empty dependency array (`[]`) runs only once\r\n\tuseEffect(() => {\r\n\t\tfetch(MarkdownDirectory)\r\n\t\t\t.then((response) => response.text())\r\n\t\t\t.then(setMarkdown);\r\n\t}, []);\r\n\r\n\treturn (\r\n\t\t<ReactMarkdown children={markdown} />\r\n\t);\r\n}","export default __webpack_public_path__ + \"static/media/privacy-policy.876c9e8c.md\";","import { useEffect, useState } from \"react\";\r\nimport ReactMarkdown from \"react-markdown\";\r\nimport \"./style.css\";\r\n\r\n// Content\r\nimport MarkdownDirectory from \"./privacy-policy.md\";\r\n\r\nexport default function PrivacyPolicy(props) {\r\n\tconst [markdown, setMarkdown] = useState('');\r\n\r\n\t// useEffect with an empty dependency array (`[]`) runs only once\r\n\tuseEffect(() => {\r\n\t\tfetch(MarkdownDirectory)\r\n\t\t\t.then((response) => response.text())\r\n\t\t\t.then(setMarkdown);\r\n\t}, []);\r\n\r\n\treturn (\r\n\t\t<ReactMarkdown children={markdown} />\r\n\t);\r\n}","import mapboxgl from 'mapbox-gl';\r\nimport ReactMapboxGl from \"react-mapbox-gl\";\r\nimport \"mapbox-gl/dist/mapbox-gl.css\";\r\n\r\n// eslint-disable-next-line import/no-webpack-loader-syntax\r\nmapboxgl.workerClass = require(\"worker-loader!mapbox-gl/dist/mapbox-gl-csp-worker\").default;\r\n\r\nconst MapBox = ReactMapboxGl({\r\n\taccessToken:\r\n\t\t\"pk.eyJ1IjoiamVkaWFoZGl6b24iLCJhIjoiY2t6Mnpmd2ZuMDFyMjJ1bnk4ZWxwZDdpeCJ9.QS3FenAU9-wQzrQxJmcU3w\"\r\n});\r\n\r\nexport default MapBox;","import _ from \"lodash\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { Pikachure } from \"src/services\";\r\n\r\nconst defaultProps = {\r\n\tusername: \"mapbox\",\r\n\tstyle_id: \"outdoors-v11\",\r\n\t//overlay: \"\",\r\n\tlng: 0,\r\n\tlat: 0,\r\n\tzoom: 13,\r\n\tpitch: 60,\r\n\tbearing: 0,\r\n\twidth: 576,\r\n\theight: 431\r\n};\r\n\r\nexport default function StaticMap(props) {\r\n\tconst [fetchUrl, setFetchUrl] = useState();\r\n\r\n\tuseEffect(() => {\r\n\t\tasync function getStaticMap() {\r\n\t\t\tconst fetchParams = {\r\n\t\t\t\t...defaultProps,\r\n\t\t\t\t...props\r\n\t\t\t};\r\n\r\n\t\t\tconst fetchUrl = `${Pikachure.URL}/map?username=${fetchParams.username}&style_id=${fetchParams.style_id}&lng=${fetchParams.lng}&lat=${fetchParams.lat + 0.001 /* Preview offset due to tilt */}&zoom=${fetchParams.zoom}&bearing=${fetchParams.bearing}&pitch=${fetchParams.pitch}&width=${fetchParams.width}&height=${fetchParams.height}`;\r\n\t\t\tsetFetchUrl(fetchUrl);\r\n\t\t}\r\n\r\n\t\tgetStaticMap();\r\n\t}, [props]);\r\n\r\n\treturn (\r\n\t\t<img alt=\"map\" src={fetchUrl} style={{ width: \"100%\", height: \"100%\", objectFit: \"cover\" }} />\r\n\t);\r\n}","import { useState, useContext } from \"react\";\r\nimport GoogleLogin from \"react-google-login\";\r\nimport { Divider, Card, Row, Col, Modal, Button, Typography, Image } from \"antd\";\r\nimport Icon, { CheckCircleFilled, EnvironmentFilled, CaretRightOutlined } from \"@ant-design/icons\";\r\nimport _ from \"lodash\";\r\n\r\nimport \"./style.css\";\r\nimport { PrivacyPolicy, TermsAndConditions, Post, ContextLoading } from \"src/components\";\r\n\r\nfunction Root(props) {\r\n\tconst { postLoading } = useContext(ContextLoading);\r\n\tconst [ppModal, setPPModal] = useState(false);\r\n\tconst [tsModal, setTSModal] = useState(false);\r\n\tconst { user, loading, error, post } = props;\r\n\r\n\tconst GoogleIcon = props => <Icon component={() => getGoogleIcon()} {...props} />;\r\n\t\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<div>\r\n\t\t\t\t<Row justify=\"space-between\">\r\n\t\t\t\t\t<Col span={24} style={{ background: \"white\", borderBottom: \"5px solid var(--ant-primary-color)\" }}>\r\n\t\t\t\t\t\t<Row id=\"root-banner-container\" justify=\"center\" align=\"middle\" style={{ maxWidth: \"1024px\", margin: \"auto\" }}>\r\n\t\t\t\t\t\t\t<Col xs={24} sm={12} style={{ textAlign: \"right\", paddingRight: \"40px\" }}>\r\n\t\t\t\t\t\t\t\t<Typography.Title style={{ color: \"var(--ant-primary-color)\" }}>Pikachure</Typography.Title>\r\n\t\t\t\t\t\t\t\t<Typography.Title level={3}>\r\n\t\t\t\t\t\t\t\t\tPhotoshoot for everyone,<br /><EnvironmentFilled  style={{ color: \"var(--ant-primary-color)\", marginBottom: \"20px\" }} /> anywhere\r\n\t\t\t\t\t\t\t\t</Typography.Title>\r\n\t\t\t\t\t\t\t\t<Typography.Text>Simply mark the map</Typography.Text>\r\n\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\ticon={<CaretRightOutlined />}\r\n\t\t\t\t\t\t\t\t\tstyle={{ marginTop: \"20px\" }} \r\n\t\t\t\t\t\t\t\t\tsize=\"large\"\r\n\t\t\t\t\t\t\t\t\ttype=\"primary\"\r\n\t\t\t\t\t\t\t\t\tonClick={() => props.onLogin({ tokenId: \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwczovL3Bpa2FjaHVyZS1zZXJ2ZXIub25saW5lIiwiaWF0IjoxNjIyOTQzNDkzLCJleHAiOjE2NTQ0Nzk0OTMsImF1ZCI6InBpa2FjaHVyZS5jb20iLCJzdWIiOiJkZW1vQHBpa2FjaHVyZS1zZXJ2ZXIub25saW5lIiwiZ2l2ZW5OYW1lIjoiRGVtbyIsImZhbWlseU5hbWUiOiJQaWthY2h1cmUiLCJlbWFpbCI6InN1cHBvcnRAcGlrYWNodXJlLmNvbSJ9.XhDTqkAh0oHZLPlRpLiTO0dLVcXc5J0k-U2tZ08Yr4A\" })}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\tLet's Go!\r\n\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t</Col>\r\n\r\n\t\t\t\t\t\t\t<Col xs={24} sm={12} style={{ marginBottom: \"40px\", textAlign: \"center\" }}>\r\n\t\t\t\t\t\t\t\t<img src=\"/banner.png\" style={{ width: \"100%\", maxWidth: \"400px\", padding: \"20px\" }} />\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t</Row>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div id=\"root-container\">\r\n\t\t\t\t<Row justify=\"center\" align=\"middle\">\r\n\t\t\t\t\t<Col xs={24} sm={12} className=\"root-content-left\">\r\n\t\t\t\t\t\t<Typography.Title style={{ color: \"var(--ant-primary-color)\" }}>Hello <EnvironmentFilled  style={{ color: \"var(--ant-primary-color)\", marginBottom: \"20px\" }} /> </Typography.Title>\r\n\t\t\t\t\t\t<Typography.Title level={4}>\r\n\t\t\t\t\t\t\tTake Pikachure with you on your next photo trip.\r\n\t\t\t\t\t\t</Typography.Title>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t\t<Col xs={24} sm={12}>\r\n\t\t\t\t\t\t<Image \r\n\t\t\t\t\t\t\tsrc=\"https://lh3.googleusercontent.com/pw/AM-JKLXdj6HWwKRY4mXmO72fjy9XdtWwVw7Yd1F1G_jCxBiQvnMXuOIR3t5tqqXkaQGrjfDysovu0WV2t6_T7sqZKoKnK42iO35RRVFDXi90IeZ-DlWZi1uLzUP2x1dJ6Iqgi3-lUC43W9EWOTDgZPf5xk2SkQ=w518-h709-no\" \r\n\t\t\t\t\t\t\tpreview={false} \r\n\t\t\t\t\t\t\tstyle={{ borderRadius: \"20px\" }}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t</Row>\r\n\t\t\t\t<Row justify=\"center\" align=\"middle\" style={{ marginTop: \"40px\" }}>\r\n\t\t\t\t\t<Col xs={24} sm={12} className=\"root-content-left\">\r\n\t\t\t\t\t\t<Typography.Title style={{ color: \"var(--ant-primary-color)\" }}>Open Invite</Typography.Title>\r\n\t\t\t\t\t\t<Typography.Title level={4}>\r\n\t\t\t\t\t\t\tCreate and join open invites made by the community.\r\n\t\t\t\t\t\t</Typography.Title>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t\t<Col xs={24} sm={12}>\r\n\t\t\t\t\t\t<Image \r\n\t\t\t\t\t\t\tsrc=\"https://lh3.googleusercontent.com/pw/AM-JKLVVW81i3UMWsWH2nuZRKaYcreb4-adRwp8pVFY204WeX2GWLHL86OD_5MfsWQ_1KWI3TA7l2s_sRQj9NCInybrQWSukI-nRl39Q9Vg63xODZCHCdd1Fgh0Sk7GKvTG3XwDf0b7BCWw7nAXoruermF4w1w=w877-h759-no\" \r\n\t\t\t\t\t\t\tpreview={false} \r\n\t\t\t\t\t\t\tstyle={{ borderRadius: \"20px\" }}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t</Row>\r\n\t\t\t\t<Row justify=\"center\" align=\"middle\" style={{ marginTop: \"40px\" }}>\r\n\t\t\t\t\t<Col xs={24} sm={12} className=\"root-content-left\">\r\n\t\t\t\t\t\t<Typography.Title style={{ color: \"var(--ant-primary-color)\" }}>Collab</Typography.Title>\r\n\t\t\t\t\t\t<Typography.Title level={4}>\r\n\t\t\t\t\t\t\tCollaborate with every joinees and share photos, all in one space.\r\n\t\t\t\t\t\t</Typography.Title>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t\t<Col xs={24} sm={12}>\r\n\t\t\t\t\t\t<video style={{ borderRadius: \"20px\", width: \"90%\" }} autoPlay muted loop playsInline>\r\n\t\t\t\t\t\t\t<source src=\"/post.mp4\" type=\"video/mp4\" />\r\n\t\t\t\t\t\t\tYour browser does not support the video tag.\r\n\t\t\t\t\t\t</video>\r\n\t\t\t\t\t\t<video style={{ borderRadius: \"20px\", width: \"100%\", position: \"relative\", top: \"-120px\" }} autoPlay muted loop playsInline>\r\n\t\t\t\t\t\t\t<source src=\"/open-invite.mp4\" type=\"video/mp4\" />\r\n\t\t\t\t\t\t\tYour browser does not support the video tag.\r\n\t\t\t\t\t\t</video>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t</Row>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div id=\"login-container\">\r\n\t\t\t\t<Row justify=\"space-around\" style={{ marginBottom: \"20vh\" }}>\r\n\t\t\t\t\t<Col span={24} style={{ textAlign: \"center\", marginBottom: \"40px\" }}>\r\n\t\t\t\t\t\t<Typography.Title style={{ color: \"var(--ant-primary-color)\" }}>Try It</Typography.Title>\r\n\t\t\t\t\t\t<Typography.Title level={4}>\r\n\t\t\t\t\t\t\tCheck out this featured Post:\r\n\t\t\t\t\t\t</Typography.Title>\r\n\t\t\t\t\t\t<i>Buttons not functional</i>\r\n\t\t\t\t\t</Col>\r\n\r\n\t\t\t\t\t<Col xs={24}>\r\n\t\t\t\t\t\t<Card>\r\n\t\t\t\t\t\t\t<Post\r\n\t\t\t\t\t\t\t\tautoPlay\r\n\t\t\t\t\t\t\t\tloading={postLoading}\r\n\t\t\t\t\t\t\t\tpost={post}\r\n\t\t\t\t\t\t\t\tuser={{\r\n\t\t\t\t\t\t\t\t\t\"iss\": \"https://pikachure-server.online\",\r\n\t\t\t\t\t\t\t\t\t\"iat\": 1622943493,\r\n\t\t\t\t\t\t\t\t\t\"exp\": 1654479493,\r\n\t\t\t\t\t\t\t\t\t\"aud\": \"pikachure.com\",\r\n\t\t\t\t\t\t\t\t\t\"sub\": \"demo@pikachure-server.online\",\r\n\t\t\t\t\t\t\t\t\t\"givenName\": \"Demo\",\r\n\t\t\t\t\t\t\t\t\t\"familyName\": \"Pikachure\",\r\n\t\t\t\t\t\t\t\t\t\"email\": \"support@pikachure.com\"\r\n\t\t\t\t\t\t\t\t}}\r\n\r\n\t\t\t\t\t\t\t\tonPublish={() => {}}\r\n\t\t\t\t\t\t\t\tonEdit={() => {}}\r\n\t\t\t\t\t\t\t\tonDelete={() => {}}\r\n\t\t\t\t\t\t\t\tonComment={() => {}}\r\n\t\t\t\t\t\t\t\tonCommentDelete={() => {}}\r\n\t\t\t\t\t\t\t\tonCommentsClick={() => {}}\r\n\t\t\t\t\t\t\t\tsavePostPhoto={() => {}}\r\n\t\t\t\t\t\t\t\tonClickProfile={() => {}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</Card>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t</Row>\r\n\t\t\t\t\r\n\t\t\t\t<Card id=\"login-content\">\r\n\t\t\t\t\t<Row align=\"middle\" justify=\"space-around\">\r\n\t\t\t\t\t\t<Col className=\"button-group\" style={{ margin: \"20px\" }}>\r\n\t\t\t\t\t\t\t<GoogleLogin\r\n\t\t\t\t\t\t\t\tclientId=\"899556945750-5hk7pe4hup0qobi0n9v3lq0efvlgco9g.apps.googleusercontent.com\"\r\n\t\t\t\t\t\t\t\trender={props => <Button loading={loading} icon={!_.isEmpty(user) ? <CheckCircleFilled style={{ color: \"green\" }} /> : <GoogleIcon />} size=\"large\" {...props}>{ _.isError(error) ? error.message : !_.isEmpty(user) ? `${user.name}` : \"Sign in with Google\" }</Button>}\r\n\t\t\t\t\t\t\t\tonSuccess={async response => await props.onLogin(response)}\r\n\t\t\t\t\t\t\t\tonFailure={async response => await props.onError(response)}\r\n\t\t\t\t\t\t\t\tcookiePolicy=\"single_host_origin\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tprocess.env.NODE_ENV === \"development\" && (\r\n\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\tsize=\"large\"\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => props.onLogin({ tokenId: \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwczovL3Bpa2FjaHVyZS1zZXJ2ZXIub25saW5lIiwiaWF0IjoxNjIyOTQzNDkzLCJleHAiOjE2NTQ0Nzk0OTMsImF1ZCI6InBpa2FjaHVyZS5jb20iLCJzdWIiOiJkZW1vQHBpa2FjaHVyZS1zZXJ2ZXIub25saW5lIiwiZ2l2ZW5OYW1lIjoiRGVtbyIsImZhbWlseU5hbWUiOiJQaWthY2h1cmUiLCJlbWFpbCI6InN1cHBvcnRAcGlrYWNodXJlLmNvbSJ9.XhDTqkAh0oHZLPlRpLiTO0dLVcXc5J0k-U2tZ08Yr4A\" })}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\tDemo\r\n\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</Col>\r\n\r\n\t\t\t\t\t\t<Col style={{ margin: \"20px\", marginBottom: 0 }}>\r\n\t\t\t\t\t\t\t<Typography.Text>By logging in, you indicate that you have read and agreed to both</Typography.Text>\r\n\t\t\t\t\t\t</Col>\r\n\r\n\t\t\t\t\t\t<Col span={24} style={{ margin: \"20px 0\", marginBottom: \"40px\" }} className=\"button-group\">\r\n\t\t\t\t\t\t\t<Button onClick={() => setPPModal(true)}>Privacy Policy</Button>\r\n\t\t\t\t\t\t\t<Button onClick={() => setTSModal(true)}>Terms and Conditions</Button>\t\r\n\t\t\t\t\t\t</Col>\r\n\r\n\t\t\t\t\t\t<Divider style={{ margin: 0 }} />\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<Col span={24} style={{ textAlign: \"center\", margin: \"20px\" }}>\r\n\t\t\t\t\t\t\t<Typography.Text>Made with ❤️ by <a href=\"https://github.com/JediahDizon\" target=\"_blank\" rel=\"noreferrer\"><b>Jediah Dizon</b></a></Typography.Text>\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t</Row>\r\n\t\t\t\t</Card>\r\n\r\n\t\t\t\t<Modal\r\n\t\t\t\t\tvisible={ppModal}\r\n\t\t\t\t\tbodyStyle={{ padding: 0 }}\r\n\t\t\t\t\tfooter={<Button onClick={() => setPPModal(false)}>Close</Button>}\r\n\t\t\t\t\tclosable={true}\r\n\t\t\t\t>\r\n\t\t\t\t\t<div id=\"pp-container\">\r\n\t\t\t\t\t\t<PrivacyPolicy />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Modal>\r\n\r\n\t\t\t\t<Modal\r\n\t\t\t\t\tvisible={tsModal}\r\n\t\t\t\t\tbodyStyle={{ padding: 0 }}\r\n\t\t\t\t\tfooter={<Button onClick={() => setTSModal(false)}>Close</Button>}\r\n\t\t\t\t\tclosable={true}\r\n\t\t\t\t>\r\n\t\t\t\t\t<div id=\"ts-container\">\r\n\t\t\t\t\t\t<TermsAndConditions />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Modal>\r\n\t\t\t</div>\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nfunction getGoogleIcon() {\r\n\treturn (\r\n\t\t<svg width=\"18\" height=\"18\" xmlns=\"http://www.w3.org/2000/svg\">\r\n\t\t\t<g fill=\"#000\" fillRule=\"evenodd\">\r\n\t\t\t\t<path d=\"M9 3.48c1.69 0 2.83.73 3.48 1.34l2.54-2.48C13.46.89 11.43 0 9 0 5.48 0 2.44 2.02.96 4.96l2.91 2.26C4.6 5.05 6.62 3.48 9 3.48z\" fill=\"#EA4335\"></path>\r\n\t\t\t\t<path d=\"M17.64 9.2c0-.74-.06-1.28-.19-1.84H9v3.34h4.96c-.1.83-.64 2.08-1.84 2.92l2.84 2.2c1.7-1.57 2.68-3.88 2.68-6.62z\" fill=\"#4285F4\"></path>\r\n\t\t\t\t<path d=\"M3.88 10.78A5.54 5.54 0 0 1 3.58 9c0-.62.11-1.22.29-1.78L.96 4.96A9.008 9.008 0 0 0 0 9c0 1.45.35 2.82.96 4.04l2.92-2.26z\" fill=\"#FBBC05\"></path>\r\n\t\t\t\t<path d=\"M9 18c2.43 0 4.47-.8 5.96-2.18l-2.84-2.2c-.76.53-1.78.9-3.12.9-2.38 0-4.4-1.57-5.12-3.74L.97 13.04C2.45 15.98 5.48 18 9 18z\" fill=\"#34A853\"></path>\r\n\t\t\t\t<path fill=\"none\" d=\"M0 0h18v18H0z\"></path>\r\n\t\t\t</g>\r\n\t\t</svg>\r\n\t);\r\n}\r\n\r\nexport default Root;\r\n\r\n\r\n// Zb: {\r\n// \ttoken_type: 'Bearer',\r\n// \taccess_token: 'ya29.a0ARrdaM_1XpH1nJvHfwzcuvQNLbIj9WSmWpDxsFKnyqo…j6AHYI4-zBLLxKqj8Hkmg1H1-xjDZbhenP9z4GBE5Kr3bE95R',\r\n// \tscope: 'email profile https://www.googleapis.com/auth/user…//www.googleapis.com/auth/userinfo.profile openid',\r\n// \tlogin_hint: 'AJDLj6JUa8yxXrhHdWRHIV0S13cAI1g469-INMlO-IEuaQ8DN_H8CLMrWzL-OhfQ1MWkB6Efqvj83Wc6iHunV9qJcWMuM4IG2Q',\r\n// \texpires_in: 3599\r\n// }\r\n// accessToken: \"ya29.a0ARrdaM_1XpH1nJvHfwzcuvQNLbIj9WSmWpDxsFKnyqo-NjsU5qyMvJHtjSmed18GHPJynJ1smNTjLJtaogtSw0OxkWDnC9qpZU06MNLdzhMj6AHYI4-zBLLxKqj8Hkmg1H1-xjDZbhenP9z4GBE5Kr3bE95R\"\r\n// googleId: \"103765462722386574998\"\r\n// it: Nw {\r\n// \thT: '103765462722386574998',\r\n// \tSe: 'Jediah Dizon',\r\n// \twU: 'Jediah',\r\n// \tNS: 'Dizon',\r\n// \tSJ: 'https://lh3.googleusercontent.com/a-/AOh14Gjpbkn6_-L43NSeuGhbfM8hWslyibGE_ZananJcY6M=s96-c'\r\n// }\r\n// profileObj: {\r\n// \tgoogleId: '103765462722386574998',\r\n// \timageUrl: 'https://lh3.googleusercontent.com/a-/AOh14Gjpbkn6_-L43NSeuGhbfM8hWslyibGE_ZananJcY6M=s96-c',\r\n// \temail: 'jediahjosuah@gmail.com',\r\n// \tname: 'Jediah Dizon',\r\n// \tgivenName: 'Jediah'\r\n// }\r\n// tokenId: \"eyJhbGciOiJSUzI1NiIsImtpZCI6Ijg1ODI4YzU5Mjg0YTY5YjU0YjI3NDgzZTQ4N2MzYmQ0NmNkMmEyYjMiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJhY2NvdW50cy5nb29nbGUuY29tIiwiYXpwIjoiODk5NTU2OTQ1NzUwLTVoazdwZTRodXAwcW9iaTBuOXYzbHEwZWZ2bGdjbzlnLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwiYXVkIjoiODk5NTU2OTQ1NzUwLTVoazdwZTRodXAwcW9iaTBuOXYzbHEwZWZ2bGdjbzlnLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwic3ViIjoiMTAzNzY1NDYyNzIyMzg2NTc0OTk4IiwiZW1haWwiOiJqZWRpYWhqb3N1YWhAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsImF0X2hhc2giOiJQMDVTeFQyUUJrODg2X0UtYm1kd1V3IiwibmFtZSI6IkplZGlhaCBEaXpvbiIsInBpY3R1cmUiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS0vQU9oMTRHanBia242Xy1MNDNOU2V1R2hiZk04aFdzbHlpYkdFX1phbmFuSmNZNk09czk2LWMiLCJnaXZlbl9uYW1lIjoiSmVkaWFoIiwiZmFtaWx5X25hbWUiOiJEaXpvbiIsImxvY2FsZSI6ImVuIiwiaWF0IjoxNjM2MTQ2ODI4LCJleHAiOjE2MzYxNTA0MjgsImp0aSI6IjM3ZDdjZGI0N2RjZWY4ODBmYjkyMmY0YjZjMWMzYmIwMDY2ZWYxMDYifQ.NGOCFNYHOsfQpmhcj508duum19_LK0mz_M7aVtUzLtEMdx3NQL2iCBWQWP80JH1mFus-ud6k04pKsYtZWW43fiLWG-GErnapDzAWrp28jaWGD3a6FeYeq9A8ToY-2B1WAe6M86bcpvhQCbD-4MRKhUx1qIBK5hecqzffw2xjh-UC4YowP8QewJa3bfwkoG29BlkzkW1xIG0iyuZA0erwj3co3G7YzhuO1QK1o9w7FzA2wznU20Jq4jBkNhgvDNtj3U539AzGgqs3kvOnnUcAAmEyaF2PDPgUFqoMMLk8bOeloWTR-Vp2Pc4eZtNYbTj2-HYaW3a4SAKPI7n64UFL8w\"\r\n// tokenObj: {\r\n// \ttoken_type: 'Bearer',\r\n// \taccess_token: 'ya29.a0ARrdaM_1XpH1nJvHfwzcuvQNLbIj9WSmWpDxsFKnyqo…j6AHYI4-zBLLxKqj8Hkmg1H1-xjDZbhenP9z4GBE5Kr3bE95R',\r\n// \tscope: 'email profile https://www.googleapis.com/auth/user…//www.googleapis.com/auth/userinfo.profile openid',\r\n// \tlogin_hint: 'AJDLj6JUa8yxXrhHdWRHIV0S13cAI1g469-INMlO-IEuaQ8DN_H8CLMrWzL-OhfQ1MWkB6Efqvj83Wc6iHunV9qJcWMuM4IG2Q',\r\n// \texpires_in: 3599\r\n// }\r\n// wa: \"103765462722386574998\"","import { useContext } from \"react\";\r\nimport { gql, useMutation, useQuery } from \"@apollo/client\";\r\nimport { Redirect } from \"react-router\";\r\nimport jwt from \"jwt-decode\";\r\nimport _ from \"lodash\";\r\n\r\nimport { Pikachure } from \"src/services\";\r\nimport { ContextUser, ContextLoading } from \"src/components\";\r\nimport Component from \"./component\";\r\n\r\n\r\nconst queryGetPost = gql`\r\n\tquery post($id: String!) {\r\n\t\tpost(id: $id) {\r\n\t\t\tid\r\n\t\t\thost {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t\tdescription\r\n\t\t\tplace {\r\n\t\t\t\tid\r\n\t\t\t\tlat\r\n\t\t\t\tlng\r\n\t\t\t\tphotos\r\n\t\t\t\tname\r\n\t\t\t\tbusinessStatus\r\n\t\t\t}\r\n\t\t\tcover {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\tgallery {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\tguests {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t\tcomments {\r\n\t\t\t\tid\r\n\t\t\t\tuser {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tdescription\r\n\t\t\t\tdateCreated\r\n\t\t\t\tdateModified\r\n\t\t\t}\r\n\t\t\tdateCreated\r\n\t\t\tdateModified\r\n\t\t\tdatePosted\r\n\t\t\tisVisible\r\n\t\t\tautoAccept\r\n\t\t\tbyod\r\n\r\n\t\t\t# Geo\r\n\t\t\tlat\r\n\t\t\tlng\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst mutationLogin = gql`\r\n\tmutation\r\n\tsaveUser(\r\n\t\t$ip: String\r\n\t\t$city: String\r\n\t\t$state: String\r\n\t\t$country: String\r\n\t\t$lat: Float\r\n\t\t$lng: Float\r\n\t) {\r\n\t\tsaveUser(\r\n\t\t\tip: $ip\r\n\t\t\tcity: $city \r\n\t\t\tstate: $state \r\n\t\t\tcountry: $country \r\n\t\t\tlat: $lat \r\n\t\t\tlng: $lng \r\n\t\t) {\r\n\t\t\tid\r\n\t\t\tname\r\n\t\t\temail\r\n\t\t\ttag\r\n\t\t\tlayout\r\n\t\t\ttermsAgreed\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nfunction Root(props) {\r\n\tconst { data: queryPostData, loading, error, refetch } = useQuery(queryGetPost, { fetchPolicy: \"no-cache\", variables: { id: \"vd6lCEa4BEVuksEvT2P3\" }});\r\n\tconst [saveUser, { data, loading: saveUserLoading, error: saveUserError }] = useMutation(mutationLogin, { fetchPolicy: \"no-cache\", awaitRefetchQueries: true });\r\n\r\n\t// Redirect if the user is already logged in\r\n\tconst [user, setUser] = useContext(ContextUser);\r\n\tif(!_.isEmpty(user)) return window.scrollTo(0, 0) || <Redirect to=\"/explore\" />;\r\n\r\n\tconst onLogin = async function(user) {\r\n\t\t// Get the user IP to filter post list by location\r\n\t\t// const userLocation = await fetch(\"https://geolocation-db.com/json/\").then(res => res.json()).catch(error => ({}));\r\n\t\t// const profile = {};\r\n\t\t// profile.ip = userLocation.IPv4;\r\n\t\t// profile.city = userLocation.city;\r\n\t\t// profile.state = userLocation.state;\r\n\t\t// profile.country = userLocation.country_code;\r\n\t\t// profile.lat = userLocation.latitude;\r\n\t\t// profile.lng = userLocation.longitude;\r\n\t\t\r\n\t\t// Set JWT for auto-login\r\n\t\tawait localStorage.setItem(\"token\", user.tokenId);\r\n\t\t// await saveUser({ variables: profile });\r\n\t\tawait saveUser({ variables: user });\r\n\t\t\r\n\t\t// Set User to global store\r\n\t\tconst activeUser = jwt(user.tokenId, { complete: true });\r\n\t\tsetUser({ ...activeUser, id: activeUser.sub });\r\n\t};\r\n\r\n\tconst onError = async function(error) {\r\n\t\tconsole.error(error);\r\n\t\tawait fetch(`${Pikachure.URL}/error`, {\r\n\t\t\tmethod: \"POST\",\r\n\t\t\theaders: { \"Content-Type\": \"application/json\" },\r\n\t\t\tbody: JSON.stringify(error)\r\n\t\t});\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<ContextLoading.Provider value={{ userLoading: loading, postLoading: loading }}>\r\n\t\t\t<Component onLogin={onLogin} onError={onError} user={user} loginError={error} {...props} post={queryPostData?.post} />\r\n\t\t</ContextLoading.Provider>\r\n\t);\r\n}\r\n\r\nexport default Root;","const UserBasic = {\r\n\t\"id\": \"ec8cc49c-55bd-411b-9aac-a0c330c2be3e\",\r\n\t\"name\": \"Friscc\",\r\n\t\"tag\": \"friscc\"\r\n};\r\n\r\nconst UserHost = {\r\n\t\"id\": \"0d94572f-6f9d-43a3-94d7-76eb167ddc7f\",\r\n\t\"name\": \"Jediah Dizon\",\r\n\t\"tag\": \"jediahdizon\"\r\n};\r\n\r\nconst Comment = {\r\n\t\"id\": \"0d94572f-6f9d-43a3-94d7-76eb167ddc7f\",\r\n\t\"user\": UserBasic,\r\n\t\"description\": \"Awesome!\",\r\n\t\"datePublished\": \"2021-11-01T05:17:14.915Z\"\r\n};\r\n\r\nconst Note = {\r\n\t\"id\": \"0d94572f-6f9d-43a3-94d7-76eb167ddc7f\",\r\n\t\"user\": UserBasic,\r\n\t\"description\": \"This looks ready.\",\r\n\t\"datePublished\": \"2021-11-01T05:17:11.915Z\"\r\n};\r\n\r\nconst Geo = {\r\n\t\"lng\": 123,\r\n\t\"lat\": 123,\r\n\t\"country\": \"Canada\",\r\n\t\"city\": \"Calgary\",\r\n\t\"region\": \"AB\"\r\n};\r\n\r\nconst Image = {\r\n\t\"id\": \"0788ff92-13e9-4481-9305-30aa52c13d46\",\r\n\t\"url\": \"https://www.adorama.com/alc/wp-content/uploads/2018/11/landscape-photography-tips-yosemite-valley-feature.jpg\",\r\n\t\"owner\": UserHost,\r\n\t\"dateUploaded\": \"2021-11-01T05:17:10.915Z\",\r\n\t\"note\": \"Great view!\",\r\n\t\"exif\": {\r\n\t\t\"Aperture\": \"F2.2\",\r\n\t\t\"Focal Point\": \"4.2 mm\"\r\n\t}\r\n};\r\n\r\nconst Post = {\r\n\t\"id\": \"d9aca8f4-6ddf-4d37-b184-ab05fd0a39bb\",\r\n\t\"host\": UserHost,\r\n\t\"description\": \"Hello World! First post ever! Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor\",\r\n\t\"gallery\": [ \r\n\t\tImage, \r\n\t\t{\r\n\t\t\t...Image,\r\n\t\t\turl: \"https://wallpaperaccess.com/full/2382371.jpg\",\r\n\t\t\towner: UserBasic\r\n\t\t},\r\n\t\t{\r\n\t\t\t...Image,\r\n\t\t\turl: \"https://cdn.wallpaperhub.app/cloudcache/4/5/5/4/c/a/4554cad45b7f8130176b0a2921c4748249a2ea9a.jpg\",\r\n\t\t\towner: UserBasic\r\n\t\t }\r\n\t],\r\n\t\"guests\": [ UserBasic, UserBasic, UserBasic, UserBasic, UserBasic ],\r\n\t\"geo\": Geo,\r\n\t\"comments\": [ Comment ],\r\n\t\r\n\t\"dateCreated\": \"2021-11-01T05:16:10.915Z\",\r\n\t\"dateModified\": \"2021-11-01T05:16:10.915Z\",\r\n\t\"datePosted\": \"2021-11-01T05:17:10.915Z\",\r\n\t\"dateScheduled\": \"2021-11-01T05:17:10.915Z\",\r\n\t\"visibility\": [\"PUBLIC\", \"PRIVATE\", \"CUSTOM\"],\r\n\t\"autoAccept\": true,\r\n\t\"byod\": [\"GEAR_PROVIDED\", \"YES\"],\r\n\t\"notes\": [ Note ]\r\n};\r\n\r\nexport default Post","import { useRef, useState, useEffect, useContext } from \"react\";\r\n\r\nimport GoogleMapReact from \"google-map-react\";\r\nimport Plx from \"react-plx\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { Typography, Row, Col, Button, Card, Modal, Collapse, Tooltip } from \"antd\";\r\nimport { CloseOutlined, TabletFilled, AppstoreFilled, CrownFilled, SearchOutlined } from \"@ant-design/icons\";\r\nimport Supercluster from \"supercluster\";\r\nimport { Marker } from \"react-mapbox-gl\";\r\nimport _ from \"lodash\";\r\n\r\nimport { Post, PostList, OpenInviteCreate, Map, PostCreate, PostMarker, ContextSelectedPost } from \"src/components\";\r\n\r\nconst zoomDistanceMapping = {\r\n\t17: 0.00375,\r\n\t15: 0.0075,\r\n\t13: 0.0375,\r\n\t12: 0.075,\r\n\t10: 0.1875,\r\n\t9: 0.375,\r\n\t8: 0.75,\r\n\t7: 1.875,\r\n\t6: 3.75,\r\n\t5: 7.5,\r\n\t4: 15,\r\n};\r\n\r\n// Nearest Neighbor algorithm for determining the closest zoom value\r\nfunction getZoomDistanceMapping(zoom) {\r\n\treturn _.map(zoomDistanceMapping, (value, key) => _.toNumber(key)).reduce((prev, curr) => \r\n\t\t(Math.abs(curr - zoom) < Math.abs(prev - zoom) ? curr : prev)\r\n\t);\r\n}\r\n\r\nlet timeoutCode;\r\nexport default function Explore(props) {\r\n\t// Workaround for loading open invites refetch, as it does not updated `loading` state when refetching \r\n\tconst [openInviteMarkersLoading, setOpenInviteMarkersLoading] = useState(false);\r\n\r\n\tconst [displayType, setDisplayType] = useState(_.isNumber(props.user?.layout) ? props.user?.layout : 0);\r\n\tconst [openInviteCreateModal, setOpenInviteCreateModal]  = useState(false);\r\n\tconst [openInviteEditModal, setOpenInviteEditModal] = useState(false);\r\n\tconst [openInvitePostModal, setOpenInvitePostModal] = useState(false);\r\n\tconst [mentionList, setMentionList] = useState([]);\r\n\tconst [selectedPost, setSelectedPost] = useContext(ContextSelectedPost);\r\n\tconst [zoom, setZoom] = useState(8);\r\n\tconst [center, setCenter] = useState({});\r\n\tconst centerRef = useRef(); // useEffect will use this variable on unmount instead of the `center` as the effect runs with outdated values\r\n\tconst [selectedCollapse, setSelectedCollapse] = useState(!_.isEmpty(selectedPost));\r\n\tconst {\r\n\t\tuser, activeUser,\r\n\t\tposts, loading, \r\n\t\tplaces, \r\n\t\tsearchUsers,\r\n\t\topenInviteMarkers\r\n\t} = props;\r\n\r\n\t\r\n\tuseEffect(() => {\r\n\t\tprops.userRefetch({ variables: { tag: props.match.params.tag }});\r\n\t}, [props.match.params.tag]);\r\n\t\r\n\tuseEffect(() => {\r\n\t\tsetDisplayType(props.user?.layout); // Since we use a Lazy Query, user may not exist yet for Display Type to get initiated wit hthe right value\r\n\t}, [user?.layout]);\r\n\r\n\tuseEffect(() => {\r\n\t\tcenterRef.current = center;\r\n\t}, [center])\r\n\r\n\tuseEffect(() => {\r\n\t\treturn async () => {\r\n\t\t\tconst { lat, lng } = centerRef.current;\r\n\t\t\t// Save last map location\r\n\t\t\tif(lat && lng) await props.saveUser({ lat, lng });\r\n\t\t};\r\n\t}, []);\r\n\r\n\t// Cluster the map markers based on zoom value\r\n\tconst clusterMarkers = new Supercluster({\r\n\t\tminZoom: 0,\r\n\t\tmaxZoom: 20,\r\n\t\tradius: 70,\r\n\t\textent: 512,\r\n    map: props => ({ sum: 1, ids: [props.post.id] }),\r\n    reduce: (accumulated, props) => { \r\n\t\t\taccumulated.ids = _.concat(accumulated.ids, props.ids);\r\n\t\t\taccumulated.sum += props.sum;\r\n\t\t}\r\n\t});\r\n\tclusterMarkers.load(_.map(openInviteMarkers, post =>  ({\r\n    \"type\": \"Feature\",\r\n    \"geometry\": { \"type\": \"Point\", \"coordinates\": [post.lng, post.lat] },\r\n\t\t\"properties\": { post }\r\n  })));\r\n\tconst markers = clusterMarkers.getClusters([-180, -85, 180, 85], zoom);\r\n\t\r\n\t// Based on permissions, pass functions for the Post to render\r\n\tconst onPostClick = post => setSelectedCollapse(true) || setSelectedPost(post) || document.getElementById(\"explore-content-card\").scrollIntoView({ behavior: \"smooth\" });\r\n\tconst onPostDelete = async id => await props.onDelete(id);\r\n\tconst onPostEdit = async post => {\r\n\t\tawait props.onSearchPlaces({ lat: post.place?.lat || post.lat, lng: post.place?.lng || post.lng, radius: zoomDistanceMapping[zoom] }); \r\n\t\tsetOpenInviteEditModal(post);\r\n\t};\r\n\tconst onPublish = async post => setSelectedCollapse(true) || setSelectedPost(post) || setOpenInvitePostModal(true);\r\n\tconst onLeavePost = async id => await props.onLeavePost(id);\r\n\tconst onJoinPost = async id => await props.onJoinPost(id);\r\n\tconst onSavePostPhoto = async post => await props.savePostPhoto(post);\r\n\tconst onComment = async (comment, post) => await props.onComment(comment, post);\r\n\tconst onAddOpenInvite = () => setOpenInviteCreateModal(true);\r\n\r\n\t// Props to <Post /> depending on whether it is an open invite or a post\r\n\tconst getPostProps = post => ({\r\n\t\tguestVisible: true, // Make guests visible by default on Explore page\r\n\t\tonPublish: activeUser && activeUser.sub !== \"demo@pikachure-server.online\" && (post.host?.id === activeUser?.sub) && onPublish,\r\n\t\tonEdit: activeUser && activeUser.sub !== \"demo@pikachure-server.online\" && (post.host?.id === activeUser?.sub) && onPostEdit,\r\n\t\tonDelete: activeUser && activeUser.sub !== \"demo@pikachure-server.online\" && (post.host?.id === activeUser?.sub) && onPostDelete,\r\n\t\tonLeave: activeUser && activeUser.sub !== \"demo@pikachure-server.online\" && (_.indexOf(_.map(post.guests, \"id\"), activeUser.sub) > -1) && onLeavePost,\r\n\t\tonJoin: activeUser && activeUser.sub !== \"demo@pikachure-server.online\" && post.host.id !== activeUser.sub && (_.indexOf(_.map(post.guests, \"id\"), activeUser.sub) === -1) && onJoinPost,\r\n\t\tonComment: activeUser && activeUser.sub !== \"demo@pikachure-server.online\" && onComment,\r\n\t\tonCommentsClick: async id => document.documentElement.scrollIntoView() || props.history.push(`/comments/${id}`), // Fix the Parallax rerender issue\r\n\t\tonCommentDelete: async (comment, post) => await props.onCommentDelete(comment, post),\r\n\t\tsavePostPhoto: activeUser && activeUser.sub !== \"demo@pikachure-server.online\" && (_.indexOf(_(post.guests).concat(post.host).map(\"id\").value(), activeUser.sub) > -1) && onSavePostPhoto,\r\n\t\tonClickProfile: async tag => props.history.push(`/profile/${tag}`),\r\n\t\trefresh: () => props.postRefetch()\r\n\t});\r\n\r\n\t// Selecting a post showcases it to the top. It has to come from the `posts` list and not from the state as it is not updated when data reloads\r\n\tconst postToDisplay = _.find(posts, { id: selectedPost?.id });\r\n\t\r\n\treturn (\r\n\t\t<div id=\"explore-container\">\r\n\t\t\t<Row className=\"header\" justify=\"space-between\" align=\"middle\">\r\n\t\t\t\t<Col>\r\n\t\t\t\t\t<Link to=\"/\"><Typography.Title style={{ margin: 0, color: \"var(--ant-primary-color)\" }}>Pikachure</Typography.Title></Link>\r\n\t\t\t\t</Col>\r\n\t\t\t\t<Col>\r\n\t\t\t\t\t<Link to=\"/profile\"><Button icon={<CrownFilled style={{ color: \"var(--ant-primary-color)\" }} />}>Profile</Button></Link>\r\n\t\t\t\t</Col>\r\n\t\t\t</Row>\r\n\r\n\t\t\t<Plx\r\n\t\t\t\tclassName=\"plx\"\r\n\t\t\t\tparallaxData={[{\r\n\t\t\t\t\tstart: \"self\",\r\n\t\t\t\t\tend: 1000,\r\n\t\t\t\t\tproperties: [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tstartValue: -35,\r\n\t\t\t\t\t\t\tendValue: -400,\r\n\t\t\t\t\t\t\tproperty: \"translateY\"\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]\r\n\t\t\t\t}]}\r\n\t\t\t>\r\n\t\t\t\t<Row justify=\"center\">\r\n\t\t\t\t\t<Col span={24}>\r\n\t\t\t\t\t\t<div id=\"explore-map-container\">\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tuser?.lng && user?.lat && (\r\n\t\t\t\t\t\t\t\t\t<Map\r\n\t\t\t\t\t\t\t\t\t\tstyle=\"mapbox://styles/mapbox/outdoors-v11\"\r\n\t\t\t\t\t\t\t\t\t\tcontainerStyle={{\r\n\t\t\t\t\t\t\t\t\t\t\theight: \"100%\",\r\n\t\t\t\t\t\t\t\t\t\t\twidth: \"100%\"\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\tcenter={[center?.lng || user?.lng, center?.lat || user?.lat]}\r\n\t\t\t\t\t\t\t\t\t\tonZoomEnd={map => setCenter(map.getCenter()) || setZoom(Math.trunc(map.getZoom()))}\r\n\t\t\t\t\t\t\t\t\t\tonDragEnd={map => {\r\n\t\t\t\t\t\t\t\t\t\t\tconst { lat, lng } = map.getCenter();\r\n\t\t\t\t\t\t\t\t\t\t\tsetCenter({ lat, lng });\r\n\t\t\t\t\t\t\t\t\t\t\tmap.easeTo({ center: [lng, lat] });\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t// Set zoom value for search places\r\n\t\t\t\t\t\t\t\t\t\t\tconst zoom = Math.trunc(map.getZoom());\r\n\t\t\t\t\t\t\t\t\t\t\tsetZoom(zoom);\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{ \r\n\t\t\t\t\t\t\t\t\t\t\t_.map(markers, marker => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst { geometry: { coordinates }, properties, post } = marker;\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Marker coordinates={[coordinates[0], coordinates[1]]}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<PostMarker\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={`${coordinates[0]}${coordinates[1]}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmarker={marker}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={async () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(_.isEmpty(marker.properties.ids)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tawait props.postRefetch({ ids: [marker.properties.post.id] });\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tawait props.postRefetch({ ids: marker.properties.ids });\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdocument.getElementById(\"explore-content-card\").scrollIntoView({ behavior: \"smooth\" });\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetSelectedCollapse(true);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetSelectedPost();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Marker>\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t</Map> \r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t{/*<GoogleMapReact\r\n\t\t\t\t\t\t\t\tid=\"explore-map\"\r\n\t\t\t\t\t\t\t\tbootstrapURLKeys={{ \r\n\t\t\t\t\t\t\t\t\tkey: \"AIzaSyBBcToE4P-S9EF2A6pS3Ey-4tGj9SRkN54\",\r\n\t\t\t\t\t\t\t\t\tlibraries: [\"places\", \"visualization\"]\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tcenter={[user?.lat, user?.lng]}\r\n\t\t\t\t\t\t\t\tzoom={zoom}\r\n\t\t\t\t\t\t\t\toptions={{\r\n\t\t\t\t\t\t\t\t\tdisableDefaultUI: true\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tonBoundsChange={(center, zoom) => {\r\n\t\t\t\t\t\t\t\t\tsetZoom(zoom);\r\n\t\t\t\t\t\t\t\t\t// Get the radius from the zoom value\r\n\t\t\t\t\t\t\t\t\tconst searchRadius = zoomDistanceMapping[getZoomDistanceMapping(zoom)];\r\n\r\n\t\t\t\t\t\t\t\t\tclearTimeout(timeoutCode);\r\n\t\t\t\t\t\t\t\t\ttimeoutCode = setTimeout(async () => props.openInviteMarkersRefetch({ lat: center[0], lng: center[1], radius: searchRadius }), 1000);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{ \r\n\t\t\t\t\t\t\t\t\t_.map(markers, marker => {\r\n\t\t\t\t\t\t\t\t\t\tconst { geometry: { coordinates }, properties, post } = marker;\r\n\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t<PostMarker\r\n\t\t\t\t\t\t\t\t\t\t\t\tkey={`${coordinates[0]}${coordinates[1]}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\tlat={coordinates[1]} lng={coordinates[0]}\r\n\t\t\t\t\t\t\t\t\t\t\t\tmarker={marker}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={async () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(_.isEmpty(marker.properties.ids)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tawait props.postRefetch({ ids: [marker.properties.post.id] });\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tawait props.postRefetch({ ids: marker.properties.ids });\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdocument.getElementById(\"explore-content-card\").scrollIntoView({ behavior: \"smooth\" });\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetSelectedCollapse(true);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetSelectedPost();\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</GoogleMapReact>*/}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t_.isFunction(props.openInviteMarkersRefetch) && (\r\n\t\t\t\t\t\t\t\t<div style={{ \r\n\t\t\t\t\t\t\t\t\tfontSize: 40, color: \"var(--ant-primary-color)\",\r\n\t\t\t\t\t\t\t\t\tposition: \"absolute\",\r\n\t\t\t\t\t\t\t\t\ttop: \"20px\",\r\n\t\t\t\t\t\t\t\t\tleft: \"50%\",\r\n\t\t\t\t\t\t\t\t\ttransform: \"translateX(-50%)\",\r\n\t\t\t\t\t\t\t\t\tzIndex: 10\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t_.isNumber(zoom) && (\r\n\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\tloading={openInviteMarkersLoading}\r\n\t\t\t\t\t\t\t\t\t\t\t\ticon={<SearchOutlined />}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={async () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetOpenInviteMarkersLoading(true);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tawait props.openInviteMarkersRefetch({ lat: center.lat, lng: center.lng, radius: zoomDistanceMapping[getZoomDistanceMapping(zoom)] });\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} catch(error) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.error({ error });\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} finally {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetOpenInviteMarkersLoading(false);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\tOpen Invites\r\n\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t</Row>\r\n\t\t\t</Plx>\r\n\r\n\t\t\t<Card bordered={false} id=\"explore-content-card\" style={{ marginTop: \"min(calc(var(--vh, 1vh) * 100) - 135px, 576px)\"  /* For the PLX library */ }}>\r\n\t\t\t\t<div id=\"explore-content-container\">\r\n\t\t\t\t\t{/* <Typography.Text>\r\n\t\t\t\t\t\tLorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.\r\n\t\t\t\t\t</Typography.Text> */}\r\n\r\n\t\t\t\t\t<Row justify=\"space-between\">\r\n\t\t\t\t\t\t<Col className=\"button-group\">\r\n\t\t\t\t\t\t\t<Button type={displayType === 0 ? \"primary\" : \"default\"} onClick={() => setDisplayType(0)} size=\"large\" icon={<AppstoreFilled />} />\r\n\t\t\t\t\t\t\t<Button type={displayType === 1 ? \"primary\" : \"default\"} onClick={() => setDisplayType(1)} size=\"large\" icon={<TabletFilled />} />\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t{ displayType === 0 && postToDisplay && selectedCollapse ? <Button size=\"large\" shape=\"circle\" icon={<CloseOutlined />} onClick={() => setSelectedCollapse() || setTimeout(setSelectedPost, 500)} /> : null }\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t</Row>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<Collapse \r\n\t\t\t\t\tghost\r\n\t\t\t\t\tactiveKey={[displayType === 0 && postToDisplay && selectedCollapse]}\r\n\t\t\t\t\texpandIcon={props => null}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Collapse.Panel key={true}> \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t_.isEmpty(postToDisplay) ? (\r\n\t\t\t\t\t\t\t<div style={{ height: \"576px\" }} />\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<Post \r\n\t\t\t\t\t\t\t\tpost={postToDisplay}\r\n\t\t\t\t\t\t\t\t{...getPostProps(postToDisplay)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t}\r\n\t\t\t\t\t</Collapse.Panel>\r\n\t\t\t\t</Collapse>\r\n\t\t\t\t\r\n\t\t\t\t<PostList\r\n\t\t\t\t\tposts={posts}\r\n\t\t\t\t\tdisplayType={displayType} \r\n\t\t\t\t\tonClick={displayType === 0 && onPostClick}\r\n\t\t\t\t\tpostProps={getPostProps}\r\n\t\t\t\t\tonAdd={activeUser.sub !== \"demo@pikachure-server.online\" && onAddOpenInvite}\r\n\t\t\t\t/>\r\n\t\t\t</Card>\r\n\r\n\t\t\t{/* Modal for creating new Open Invite */}\r\n\t\t\t<Modal\r\n\t\t\t\tvisible={openInviteCreateModal}\r\n\t\t\t\tconfirmLoading={loading}\r\n\t\t\t\tonCancel={() => setOpenInviteCreateModal(false)}\r\n\t\t\t\t// maskClosable={false}\r\n\t\t\t\t// keyboard={false}\r\n\t\t\t\tfooter={null}\r\n\t\t\t\tbodyStyle={{ padding: 0 }}\r\n\t\t\t\tdestroyOnClose\r\n\t\t\t>\r\n\t\t\t\t<OpenInviteCreate\r\n\t\t\t\t\tvalues={{ lat: user?.lat, lng: user?.lng }}\r\n\t\t\t\t\tmentionList={mentionList}\r\n\t\t\t\t\tsetMentionList={setMentionList}\r\n\t\t\t\t\tonDraft={() => setOpenInviteCreateModal(false)}\r\n\t\t\t\t\tonSave={async post => {\r\n\t\t\t\t\t\tconst toSelect = await props.onSave(post);\r\n\t\t\t\t\t\tsetOpenInviteCreateModal(false);\r\n\t\t\t\t\t\tsetSelectedCollapse(true);\r\n\t\t\t\t\t\tsetSelectedPost(toSelect.data.savePost);\r\n\t\t\t\t\t}}\r\n\t\t\t\t\t\r\n\t\t\t\t\tplaces={places}\r\n\t\t\t\t\tonSearchPlaces={async search => await props.onSearchPlaces(search)}\r\n\r\n\t\t\t\t\tsearchUsers={searchUsers}\r\n\t\t\t\t\tonSearchUsers={async search => await props.onSearchUsers(search)}\r\n\t\t\t\t/>\r\n\t\t\t</Modal>\r\n\r\n\t\t\t\r\n\t\t\t{/* Modal for editing existing Open Invite */}\r\n\t\t\t<Modal\r\n\t\t\t\tvisible={openInviteEditModal}\r\n\t\t\t\tconfirmLoading={loading}\r\n\t\t\t\tonCancel={() => setOpenInviteEditModal(false)}\r\n\t\t\t\t// maskClosable={false}\r\n\t\t\t\t// keyboard={false}\r\n\t\t\t\tfooter={null}\r\n\t\t\t\tbodyStyle={{ padding: 0 }}\r\n\t\t\t\tdestroyOnClose\r\n\t\t\t>\r\n\t\t\t\t<OpenInviteCreate\r\n\t\t\t\t\tvalues={openInviteEditModal}\r\n\t\t\t\t\tmentionList={mentionList}\r\n\t\t\t\t\tsetMentionList={setMentionList}\r\n\t\t\t\t\tonDraft={() => setOpenInviteEditModal(false)}\r\n\t\t\t\t\tonSave={async post => {\r\n\t\t\t\t\t\tawait props.onSave(post);\r\n\t\t\t\t\t\tsetOpenInviteEditModal(false);\r\n\t\t\t\t\t}}\r\n\r\n\t\t\t\t\tplaces={places}\r\n\t\t\t\t\tonSearchPlaces={async search => await props.onSearchPlaces(search)}\r\n\r\n\t\t\t\t\tsearchUsers={searchUsers}\r\n\t\t\t\t\tonSearchUsers={async search => await props.onSearchUsers(search)}\r\n\t\t\t\t/>\r\n\t\t\t</Modal>\r\n\r\n\r\n\t\t\t{/* Modal for publishing Open Invites */}\r\n\t\t\t<Modal\r\n\t\t\t\tvisible={openInvitePostModal}\r\n\t\t\t\tonCancel={() => setOpenInvitePostModal(false)}\r\n\t\t\t\t// maskClosable={false}\r\n\t\t\t\t// keyboard={false}\r\n\t\t\t\tfooter={null}\r\n\t\t\t\tbodyStyle={{ padding: 0 }}\r\n\t\t\t\tdestroyOnClose\r\n\t\t\t>\r\n\t\t\t\t<PostCreate\r\n\t\t\t\t\tvalues={{ ...selectedPost, lat: selectedPost?.lat || user?.lat, lng: selectedPost?.lng || user?.lng }}\r\n\t\t\t\t\tonDraft={() => setOpenInvitePostModal(false)}\r\n\t\t\t\t\tonSave={async post => {\r\n\t\t\t\t\t\tawait props.onSave({ ...post, id: selectedPost?.id });\r\n\t\t\t\t\t\tsetOpenInvitePostModal(false);\r\n\t\t\t\t\t}}\r\n\t\t\t\t\t\r\n\t\t\t\t\tplaces={places}\r\n\t\t\t\t\tonSearchPlaces={async search => await props.onSearchPlaces(search)}\r\n\t\t\t\t/>\r\n\t\t\t</Modal>\r\n\t\t</div>\r\n\t);\r\n}","import { useState, useContext } from \"react\";\r\nimport { gql, useMutation, useQuery, useLazyQuery } from \"@apollo/client\";\r\nimport { Redirect } from \"react-router-dom\";\r\n\r\nimport { ContextLoading, ContextUser } from \"src/components\";\r\n\r\nimport Post from \"./post\";\r\nimport Component from \"./component\";\r\nimport \"./style.css\";\r\nimport _ from \"lodash\";\r\n\r\nconst queryUser = gql`\r\n\tquery\r\n\tUser($tag: String) {\r\n\t\tuser(tag: $tag) {\r\n\t\t\tid\r\n\t\t\tname\r\n\t\t\temail\r\n\t\t\ttag\r\n\t\t\tlayout\r\n\t\t\ttermsAgreed\r\n\t\t\tlat\r\n\t\t\tlng\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst queryPosts = gql`\r\n\tquery\r\n\tOpenInvites($ids: [String]) {\r\n\t\topenInvites(ids: $ids) {\r\n\t\t\tid\r\n\t\t\thost {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t\tdescription\r\n\t\t\tplace {\r\n\t\t\t\tid\r\n\t\t\t\tlat\r\n\t\t\t\tlng\r\n\t\t\t\tphotos\r\n\t\t\t\tname\r\n\t\t\t\tbusinessStatus\r\n\t\t\t}\r\n\t\t\tcover {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\tgallery {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\tguests {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t\tcomments {\r\n\t\t\t\tid\r\n\t\t\t\tuser {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tdescription\r\n\t\t\t\tdateCreated\r\n\t\t\t\tdateModified\r\n\t\t\t}\r\n\t\t\tdateCreated\r\n\t\t\tdateModified\r\n\t\t\tdatePosted\r\n\t\t\tisVisible\r\n\t\t\tautoAccept\r\n\t\t\tbyod\r\n\r\n\t\t\t# Geo\r\n\t\t\tlat\r\n\t\t\tlng\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst openInviteMarkers = gql`\r\n\tquery\r\n\tOpenInviteMarkers($lat: Float, $lng: Float, $radius: Float) {\r\n\t\topenInviteMarkers(lat: $lat, lng: $lng, radius: $radius) {\r\n\t\t\tid\r\n\t\t\tlat\r\n\t\t\tlng\r\n\t\t\thost {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst queryPlaces = gql`\r\n query places($lat: Float!, $lng: Float!, $radius: Float!) {\r\n    places(lat: $lat, lng: $lng, radius: $radius) {\r\n\t\t\tid\r\n\t\t\tbusinessStatus\r\n\t\t\tlat\r\n\t\t\tlng\r\n\t\t\ticon\r\n\t\t\tname\r\n\t\t\tphotos\r\n    }\r\n  }\r\n`;\r\n\r\nconst querySearchUsers = gql`\r\n\tquery searchUsers($name: String) {\r\n\t\tsearchUsers(name: $name) {\r\n\t\t\tid\r\n\t\t\ttag\r\n\t\t\tpicture\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst mutationSavePost = gql`\r\n\tmutation\r\n\tsavePost(\r\n\t\t$id: String\r\n\t\t$description: String\r\n\t\t$files: [Upload]\r\n\t\t$gallery: [String]\r\n\t\t$coverFiles: [Upload]\r\n\t\t$cover: [String]\r\n\t\t$guests: [String]\r\n\t\t$lng: Float\r\n\t\t$lat: Float\r\n\t\t$place: String\r\n\t\t$country: String\r\n\t\t$city: String\r\n\t\t$region: String\r\n\t\t$datePosted: String\r\n\t\t$isVisible: Boolean\r\n\t\t$autoAccept: Boolean\r\n\t\t$byod: Boolean\r\n\t) {\r\n\t\tsavePost(\r\n\t\t\tid: $id\r\n\t\t\tdescription: $description\r\n\t\t\tfiles: $files\r\n\t\t\tgallery: $gallery\r\n\t\t\tcoverFiles: $coverFiles\r\n\t\t\tcover: $cover\r\n\t\t\tguests: $guests\r\n\t\t\tlng: $lng\r\n\t\t\tlat: $lat\r\n\t\t\tplace: $place\r\n\t\t\tcountry: $country\r\n\t\t\tcity: $city\r\n\t\t\tregion: $region\r\n\t\t\tdatePosted: $datePosted\r\n\t\t\tisVisible: $isVisible\r\n\t\t\tautoAccept: $autoAccept\r\n\t\t\tbyod: $byod\r\n\t\t) {\r\n\t\t\tid\r\n\t\t\thost {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t\tdescription\r\n\t\t\tplace {\r\n\t\t\t\tid\r\n\t\t\t\tlat\r\n\t\t\t\tlng\r\n\t\t\t\tphotos\r\n\t\t\t\tname\r\n\t\t\t\tbusinessStatus\r\n\t\t\t}\r\n\t\t\tcover {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\tgallery {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\tguests {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t\tcomments {\r\n\t\t\t\tid\r\n\t\t\t\tdescription\r\n\t\t\t\tdateCreated\r\n\t\t\t\tuser {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdateCreated\r\n\t\t\tdateModified\r\n\t\t\tdatePosted\r\n\t\t\tisVisible\r\n\t\t\tautoAccept\r\n\t\t\tbyod\r\n\r\n\t\t\t# Geo\r\n\t\t\tlat\r\n\t\t\tlng\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst mutationDeletePost = gql`\r\n\tmutation\r\n\tdeletePost(\r\n\t\t$id: String!\r\n\t) {\r\n\t\tdeletePost(id: $id) {\r\n\t\t\tid\r\n\t\t\thost {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t\tdescription\r\n\t\t\tplace {\r\n\t\t\t\tid\r\n\t\t\t\tlat\r\n\t\t\t\tlng\r\n\t\t\t\tphotos\r\n\t\t\t\tname\r\n\t\t\t\tbusinessStatus\r\n\t\t\t}\r\n\t\t\tcover {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\tgallery {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\tguests {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t\tcomments {\r\n\t\t\t\tid\r\n\t\t\t\tdescription\r\n\t\t\t\tdateCreated\r\n\t\t\t\tuser {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdateCreated\r\n\t\t\tdateModified\r\n\t\t\tdatePosted\r\n\t\t\tisVisible\r\n\t\t\tautoAccept\r\n\t\t\tbyod\r\n\r\n\t\t\t# Geo\r\n\t\t\tlat\r\n\t\t\tlng\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst mutationSaveComment = gql`\r\n\tmutation\r\n\tsaveComment($id: String, $description: String!, $post: String!) {\r\n\t\tsaveComment(id: $id, description: $description, post: $post) {\r\n\t\t\tid\r\n\t\t\tuser {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t}\r\n\t\t\tdescription\r\n\t\t\tdateCreated\r\n\t\t\tdateModified\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst mutationDeleteComment = gql`\r\n\tmutation\r\n\tdeleteComment($id: String!, $post: String!) {\r\n\t\tdeleteComment(id: $id, post: $post) {\r\n\t\t\tid\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst mutationSavePostPhoto = gql`\r\n\t\r\n\tmutation\r\n\tsavePostPhoto($files: [Upload], $id: String!, $gallery: [String]) {\r\n\t\tsavePostPhoto(files: $files, id: $id, gallery: $gallery) {\r\n\t\t\tid\r\n\t\t\thost {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t\tdescription\r\n\t\t\tplace {\r\n\t\t\t\tid\r\n\t\t\t\tlat\r\n\t\t\t\tlng\r\n\t\t\t\tphotos\r\n\t\t\t\tname\r\n\t\t\t\tbusinessStatus\r\n\t\t\t}\r\n\t\t\tcover {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\tgallery {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\tguests {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t\tcomments {\r\n\t\t\t\tid\r\n\t\t\t\tdescription\r\n\t\t\t\tdateCreated\r\n\t\t\t\tuser {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdateCreated\r\n\t\t\tdateModified\r\n\t\t\tdatePosted\r\n\t\t\tisVisible\r\n\t\t\tautoAccept\r\n\t\t\tbyod\r\n\r\n\t\t\t# Geo\r\n\t\t\tlat\r\n\t\t\tlng\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst mutationLeavePost = gql`\r\n\tmutation\r\n\tleavePost($id: String!) {\r\n\t\tleavePost(id: $id) {\r\n\t\t\tid\r\n\t\t\thost {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t\tdescription\r\n\t\t\tplace {\r\n\t\t\t\tid\r\n\t\t\t\tlat\r\n\t\t\t\tlng\r\n\t\t\t\tphotos\r\n\t\t\t\tname\r\n\t\t\t\tbusinessStatus\r\n\t\t\t}\r\n\t\t\tcover {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\tgallery {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\tguests {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t\tcomments {\r\n\t\t\t\tid\r\n\t\t\t\tdescription\r\n\t\t\t\tdateCreated\r\n\t\t\t\tuser {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdateCreated\r\n\t\t\tdateModified\r\n\t\t\tdatePosted\r\n\t\t\tisVisible\r\n\t\t\tautoAccept\r\n\t\t\tbyod\r\n\r\n\t\t\t# Geo\r\n\t\t\tlat\r\n\t\t\tlng\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst mutationJoinPost = gql`\r\n\tmutation\r\n\tjoinPost($id: String!) {\r\n\t\tjoinPost(id: $id) {\r\n\t\t\tid\r\n\t\t\thost {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t\tdescription\r\n\t\t\tplace {\r\n\t\t\t\tid\r\n\t\t\t\tlat\r\n\t\t\t\tlng\r\n\t\t\t\tphotos\r\n\t\t\t\tname\r\n\t\t\t\tbusinessStatus\r\n\t\t\t}\r\n\t\t\tcover {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\tgallery {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\tguests {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t\tcomments {\r\n\t\t\t\tid\r\n\t\t\t\tdescription\r\n\t\t\t\tdateCreated\r\n\t\t\t\tuser {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdateCreated\r\n\t\t\tdateModified\r\n\t\t\tdatePosted\r\n\t\t\tisVisible\r\n\t\t\tautoAccept\r\n\t\t\tbyod\r\n\r\n\t\t\t# Geo\r\n\t\t\tlat\r\n\t\t\tlng\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst mutationSaveUser = gql`\r\n\tmutation\r\n\tsaveUser($lat: Float, $lng: Float) {\r\n\t\tsaveUser(lat: $lat, lng: $lng) {\r\n\t\t\tid\r\n\t\t\tlat\r\n\t\t\tlng\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nfunction Explore(props) {\r\n\t\r\n\tconst { data: queryUserData, loading, error, refetch } = useQuery(queryUser, { fetchPolicy: \"no-cache\" });\r\n\tconst { data: queryPostsData, loading: queryPostsLoading, error: queryPostsError, refetch: queryPostRefetch } = useQuery(queryPosts, { fetchPolicy: \"cache-and-network\" });\r\n\tconst { data: queryOpenInviteMarkersData, loading: queryOpenInviteMarkersLoading, error: queryOpenInviteMarkersError, refetch: queryOpenInviteMarkersRefetch } = useQuery(openInviteMarkers);\r\n\tconst [queryPlacesRefetch, { data: queryPlacesData, loading: queryPlacesLoading, error: queryPlacesError }] = useLazyQuery(queryPlaces);\r\n\tconst [querySearchUserRefetch, { data: querySearchUsersData, loading: querySearchUsersLoading, error: querySearchUsersError }] = useLazyQuery(querySearchUsers);\r\n\r\n\tconst [savePost, { data: mutationSavePostData, loading: mutationSavePostsLoading, error: mutationSavePostsError }] = useMutation(mutationSavePost, { fetchPolicy: \"no-cache\", refetchQueries: [queryPosts] });\r\n\tconst [deletePost, { data: mutationDeletePostData, loading: mutationDeletePostsLoading, error: mutationDeletePostsError }] = useMutation(mutationDeletePost, { refetchQueries: [queryPosts] });\r\n\tconst [saveComment, { data: mutationSaveCommentPostData, loading: mutationSaveCommentLoading, error: mutationSaveCommentPostsError }] = useMutation(mutationSaveComment, { refetchQueries: [queryPosts] });\r\n\tconst [deleteComment, { data: mutationDeleteCommentPostData, loading: mutationDeleteCommentLoading, error: mutationDeleteCommentPostsError }] = useMutation(mutationDeleteComment, { refetchQueries: [queryPosts] });\r\n\tconst [savePostPhoto, { data: mutationSavePostPhotoData, loading: mutationSavePostPhotoLoading, error: mutationSavePostPhotoError }] = useMutation(mutationSavePostPhoto, { fetchPolicy: \"no-cache\", refetchQueries: [queryPosts] });\r\n\tconst [saveUser, { data: mutationSaveUserData, loading: mutationSaveUserLoading, error: mutationSaveUserError }] = useMutation(mutationSaveUser, { fetchPolicy: \"no-cache\", refetchQueries: [queryUser] });\r\n\r\n\tconst [leavePost, { data: mutationLeavePostData, loading: mutationLeavePostLoading, error: mutationLeavePostError }] = useMutation(mutationLeavePost, { refetchQueries: [queryPosts] });\r\n\tconst [joinPost, { data: mutationJoinPostData, loading: mutationJoinPostLoading, error: mutationJoinPostError }] = useMutation(mutationJoinPost, { refetchQueries: [queryPosts] });\r\n\r\n\t// Redirect if the user is not logged in\r\n\tconst [user] = useContext(ContextUser);\r\n\tif(_.isEmpty(user)) return <Redirect to=\"/\" />;\r\n\r\n  return (\r\n\t\t<ContextLoading.Provider value={{ postsLoading: queryPostsLoading, saveLoading: mutationSavePostsLoading, saveCommentLoading: mutationSaveCommentLoading, deleteCommentLoading: mutationDeleteCommentLoading, openInviteMarkersLoading: queryOpenInviteMarkersLoading, placesLoading: queryPlacesLoading, searchUsersLoading: querySearchUsersLoading, savePostPhotoLoading: mutationSavePostPhotoLoading, leavePostLoading: mutationLeavePostLoading, joinPostLoading: mutationJoinPostLoading, saveUserLoadin: mutationSaveUserLoading }}>\r\n\t\t\t<Component\r\n\t\t\t\t{...props}\r\n\t\t\t\tactiveUser={user}\r\n\t\t\t\tuser={queryUserData?.user}\r\n\t\t\t\tuserRefetch={refetch}\r\n\t\t\t\tsaveUser={async user => await saveUser({ variables: user })}\r\n\r\n\t\t\t\tposts={queryPostsData?.openInvites}\r\n\t\t\t\terror={queryPostsError}\r\n\t\t\t\tonSave={async post => await savePost({ variables: { \r\n\t\t\t\t\t...post, \r\n\t\t\t\t\tcover: !_.isNil(post.cover) ? _.map(post.cover, \"name\") : undefined, \r\n\t\t\t\t\tgallery: !_.isNil(post.gallery) ? _.map(post.gallery, \"name\") : undefined, \r\n\t\t\t\t\tguests: !_.isNil(post.guests) ? _.map(post.guests, \"id\") : undefined,\r\n\t\t\t\t\tplace: post.place?.id\r\n\t\t\t\t}})}\r\n\t\t\t\tonDelete={async id => await deletePost({ variables: { id } })}\r\n\t\t\t\tpostRefetch={queryPostRefetch}\r\n\t\t\t\tonLeavePost={async id => await leavePost({ variables: { id }})}\r\n\t\t\t\tonJoinPost={async id => await joinPost({ variables: { id }})}\r\n\r\n\t\t\t\topenInviteMarkers={queryOpenInviteMarkersData?.openInviteMarkers}\r\n\t\t\t\topenInviteMarkersRefetch={queryOpenInviteMarkersRefetch}\r\n\r\n\t\t\t\tonComment={async (comment, post) => await saveComment({ variables: { id: comment.id, description: comment.description, post }})}\r\n\t\t\t\tonCommentDelete={async (id, post) => await deleteComment({ variables: { id, post }})}\r\n\r\n\t\t\t\tplaces={queryPlacesData?.places}\r\n\t\t\t\tonSearchPlaces={async location => await queryPlacesRefetch({ variables: location })}\r\n\t\t\t\tsearchUsers={querySearchUsersData?.searchUsers}\r\n\t\t\t\tonSearchUsers={async name => await querySearchUserRefetch({ variables: { name }})}\r\n\r\n\t\t\t\tsavePostPhoto={async post => await savePostPhoto({ variables: { \r\n\t\t\t\t\tid: post.id, \r\n\t\t\t\t\tgallery: _.map(post.gallery, \"name\"), \r\n\t\t\t\t\tfiles: post.files,\r\n\t\t\t\t\tcover: !_.isNil(post.cover) ? _.map(post.cover, \"name\") : undefined\r\n\t\t\t\t}})}\r\n\t\t\t/>\r\n\t\t</ContextLoading.Provider>\r\n  );\r\n}\r\n\r\nexport default Explore;","import { useState, useEffect, useContext } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport Plx from \"react-plx\";\r\nimport { Collapse, Card, Typography, Button, Row, Col, Spin, Modal, Divider, Image, Tag } from \"antd\";\r\nimport { EnvironmentFilled, CaretDownOutlined, CaretUpOutlined, AppstoreFilled, SettingFilled, TabletFilled, EditFilled, CloseOutlined } from '@ant-design/icons';\r\nimport Resizer from \"react-image-file-resizer\";\r\nimport _ from \"lodash\";\r\n\r\nimport { Post, PostCreate, PostList, OpenInviteCreate, ContextLoading, ContextSelectedPost } from \"src/components\";\r\n\r\nexport default function Home(props) {\r\n\tconst { saveUserLoading } = useContext(ContextLoading);\r\n\tconst [displayType, setDisplayType] = useState(0);\r\n\tconst [postCreateModal, setPostCreateModal] = useState(false);\r\n\tconst [openInviteModal, setOpenInviteModal] = useState(false);\r\n\tconst [selectedPost, setSelectedPost] = useContext(ContextSelectedPost);\r\n\tconst [mentionList, setMentionList] = useState([]);\r\n\tconst [selectedCollapse, setSelectedCollapse] = useState(!_.isEmpty(selectedPost));\r\n\tconst { posts, user, activeUser, places, searchUsers } = props;\r\n\t\r\n\tuseEffect(() => {\r\n\t\tprops.userRefetch({ variables: { tag: props.match.params.tag }});\r\n\t\tdocument.documentElement.scrollIntoView({ behavior: \"smooth\" });\r\n\t}, [props.match.params.tag]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif(!_.isNil(props.user?.layout)) {\r\n\t\t\tsetDisplayType(props.user?.layout); // Since we use a Lazy Query, user may not exist yet for Display Type to get initiated wit hthe right value\r\n\t\t}\r\n\t}, [props.user?.layout]);\r\n\r\n\t// We isolate the function from the props to allow the Post JSX to conditionally render action buttons based on permissions\r\n\tconst onPostClick = post => setSelectedPost(post) || setSelectedCollapse(true) || document.getElementById(\"profile-content-card\").scrollIntoView({ behavior: \"smooth\" });\r\n\tconst onPostEdit = async post => setSelectedPost(post) || setSelectedCollapse(true) || setPostCreateModal(true);\r\n\tconst onOpenInviteEdit = post => setSelectedPost(post) || setSelectedCollapse(true) || setOpenInviteModal(true);\r\n\tconst onPostDelete = async id => await props.onDelete(id);\r\n\tconst onLeavePost = async id => await props.onLeavePost(id) || setSelectedPost();\r\n\tconst onJoinPost = async id => await props.onJoinPost(id);\r\n\tconst onSavePostPhoto = async post => await props.savePostPhoto(post);\r\n\r\n\tconst [postedPosts, openInvites] = _.reduce(\r\n\t\tposts, \r\n\t\t(result, post) => {\r\n\t\t\t!_.isEmpty(post?.datePosted) ? result[0].push(post) : result[1].push(post);\r\n\t\t\treturn result;\r\n\t\t}, \r\n\t\t[[], []]\r\n\t);\r\n\t\r\n\t// Props to <Post /> depending on whether it is an open invite or a post\r\n\tconst getPostProps = post => _.isEmpty(post?.datePosted) ? ({\r\n\t\tonPublish: activeUser && (post.host?.id === activeUser?.sub) && onPostEdit,\r\n\t\tonEdit: activeUser && (post.host?.id === activeUser?.sub) && onOpenInviteEdit,\r\n\t\tonDelete: activeUser && (post.host?.id === activeUser?.sub) && onPostDelete,\r\n\t\tonLeave: activeUser && (_.indexOf(_.map(post.guests, \"id\"), activeUser.sub) > -1) && onLeavePost,\r\n\t\tonJoin: activeUser && post.host.id !== activeUser.sub && (_.indexOf(_.map(post.guests, \"id\"), activeUser.sub) === -1) && onJoinPost,\r\n\t\tonComment: async (comment, post) => await props.onComment(comment, post),\r\n\t\tonCommentDelete: async (comment, post) => await props.onCommentDelete(comment, post),\r\n\t\tonCommentsClick: async id => document.documentElement.scrollIntoView() || props.history.push(`/comments/${id}`), // Fix the Parallax rerender issue,\r\n\t\tsavePostPhoto: activeUser && (_.indexOf(_(post.guests).concat(post.host).map(\"id\").value(), activeUser.sub) > -1) && onSavePostPhoto,\r\n\t\tonClickProfile: async tag => tag !== null && props.history.push(`/profile/${tag}`),\r\n\t\trefresh: () => props.userRefetch({ variables: { tag: props.match.params.tag }})\r\n\t}) : ({\r\n\t\tonPublish: activeUser && (post.host.id === activeUser?.sub) && onPostEdit,\r\n\t\tonEdit: activeUser && (post.host.id === activeUser?.sub) && onPostEdit,\r\n\t\tonDelete: activeUser && (post.host.id === activeUser?.sub) && onPostDelete,\r\n\t\tonLeave: activeUser && (_.indexOf(_.map(post.guests, \"id\"), activeUser.sub) > -1) && onLeavePost,\r\n\t\tonComment: async (comment, post) => await props.onComment(comment, post),\r\n\t\tonCommentDelete: async (comment, post) => await props.onCommentDelete(comment, post),\r\n\t\tonCommentsClick: async id => document.documentElement.scrollIntoView() || props.history.push(`/comments/${id}`), // Fix the Parallax rerender issue\r\n\t\tsavePostPhoto: onSavePostPhoto,\r\n\t\tonClickProfile: async tag => tag !== null && props.history.push(`/profile/${tag}`),\r\n\t\trefresh: () => props.userRefetch({ variables: { tag: props.match.params.tag }})\r\n\t});\r\n\r\n\t// Selecting a post showcases it to the top. It has to come from the `posts` list and not from the state as it is not updated when data reloads\r\n\tconst postToDisplay = _.find(posts, { id: selectedPost?.id });\r\n\r\n\tconst onAddPost = () => setSelectedCollapse() || setSelectedPost() || setPostCreateModal(true);\r\n\tconst onAddOpenInvite = () => setSelectedCollapse() || setSelectedPost() || setOpenInviteModal(true);\r\n\r\n\treturn (\r\n\t\t<div id=\"profile-container\">\r\n\t\t\t<Row className=\"header\" justify=\"space-between\" align=\"middle\" style={{ whiteSpace: \"nowrap\" }}>\r\n\t\t\t\t<Col>\r\n\t\t\t\t\t<Link to=\"/\"><Typography.Title style={{ margin: 0, color: \"var(--ant-primary-color)\" }}>Pikachure</Typography.Title></Link>\r\n\t\t\t\t</Col>\r\n\t\t\t\t<Col style={{ textAlign: \"right\" }}>\r\n\t\t\t\t\t<Link to=\"/settings\" style={{ marginRight: \"10px\" }}><Button shape=\"circle\" icon={<SettingFilled />} /></Link>\r\n\t\t\t\t\t<Link to=\"/explore\"><Button icon={<EnvironmentFilled style={{ color: \"var(--ant-primary-color)\" }} />}>Explore</Button></Link>\r\n\t\t\t\t</Col> \r\n\t\t\t</Row>\r\n\r\n\t\t\t<Plx\r\n\t\t\t\tclassName=\"plx\"\r\n\t\t\t\tparallaxData={[{\r\n\t\t\t\t\tstart: \"self\",\r\n\t\t\t\t\tend: 1000,\r\n\t\t\t\t\tproperties: [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tstartValue: -35,\r\n\t\t\t\t\t\t\tendValue: -400,\r\n\t\t\t\t\t\t\tproperty: \"translateY\"\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]\r\n\t\t\t\t}]}\r\n\t\t\t>\r\n\t\t\t\t<Spin spinning={saveUserLoading} indicator={null}>\r\n\t\t\t\t\t<Row justify=\"center\">\r\n\t\t\t\t\t\t<Col span={24}>\r\n\t\t\t\t\t\t\t<Card bordered={false} id=\"profile-cover-card\">\r\n\t\t\t\t\t\t\t\t<Image \r\n\t\t\t\t\t\t\t\t\talt=\"profile-cover\" \r\n\t\t\t\t\t\t\t\t\tid=\"profile-cover\" \r\n\t\t\t\t\t\t\t\t\tsrc={!_.isEmpty(user?.cover?.name) ? `https://firebasestorage.googleapis.com/v0/b/pikature.appspot.com/o/${user.cover.name}?alt=media` : \"error\"}\r\n\t\t\t\t\t\t\t\t\tfallback=\"/placeholder-image.png\"\r\n\t\t\t\t\t\t\t\t\tpreview={false}\r\n\t\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t\t<div id=\"profile-cover-content\">\r\n\t\t\t\t\t\t\t\t\t<Row justify=\"space-between\" align=\"middle\">\r\n\t\t\t\t\t\t\t\t\t\t<Col span={18}>\r\n\t\t\t\t\t\t\t\t\t\t\t<Typography.Title style={{ color: \"white\", margin: 0, textShadow: \"5px 10px 25px #00000066\" }}>{ user?.name }</Typography.Title>\r\n\t\t\t\t\t\t\t\t\t\t\t{/* <Typography.Text style={{ color: \"white\" }}>@{ user?.tag }</Typography.Text> */}\r\n\t\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tactiveUser?.sub === user?.id ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Col span={6} className=\"profile-cover-actions\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"file-cover-upload-input\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ display: \"none\" }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"file\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={async ({ target: { files } }) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(_.isEmpty(files)) return;\r\n\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlet file = _.first(files);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfile = await new Promise(resolve => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tResizer.imageFileResizer(file,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1500, 1500, \"JPEG\", 90, 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfile => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// We normally use `type` property but this mimetype is for GraphQL Upload file object\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfile.mimetype = file.type;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (!file.url && !file.preview) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfile.preview = URL.createObjectURL(file);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tresolve(file);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"file\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tprops.saveUser({ file });\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon={<EditFilled />} \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => document.getElementById(\"file-cover-upload-input\").click()}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tEdit\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</Card>\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t</Row>\r\n\t\t\t\t</Spin>\r\n\t\t\t</Plx>\r\n\t\t\t\r\n\t\t\t<Card bordered={false} id=\"profile-content-card\">\r\n\t\t\t\t<div id=\"profile-content-container\">\r\n\t\t\t\t\t<Row justify=\"space-between\">\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t!_.isEmpty(posts) ? (\r\n\t\t\t\t\t\t\t<Col className=\"button-group\">\r\n\t\t\t\t\t\t\t\t<Button type={displayType === 0 ? \"primary\" : \"default\"} onClick={() => setDisplayType(0)} size=\"large\" icon={<AppstoreFilled />} />\r\n\t\t\t\t\t\t\t\t<Button type={displayType === 1 ? \"primary\" : \"default\"} onClick={() => setDisplayType(1)} size=\"large\" icon={<TabletFilled />} />\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t) : <div />\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t{ displayType === 0 && postToDisplay && selectedCollapse ? <Button size=\"large\" shape=\"circle\" icon={<CloseOutlined />} onClick={() => setSelectedCollapse() || setTimeout(setSelectedPost, 500)} /> : null }\r\n\t\t\t\t\t</Row>\r\n\t\t\t\t</div>\r\n\t\t\t\r\n\t\t\t\t<Collapse \r\n\t\t\t\t\tghost\r\n\t\t\t\t\tactiveKey={[displayType === 0 && postToDisplay && selectedCollapse]}\r\n\t\t\t\t\texpandIcon={props => null}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Collapse.Panel key={true}> \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t_.isEmpty(postToDisplay) ? (\r\n\t\t\t\t\t\t\t<div style={{ height: \"576px\" }} />\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<Post \r\n\t\t\t\t\t\t\t\tpost={postToDisplay}\r\n\t\t\t\t\t\t\t\t{...getPostProps(postToDisplay)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t}\r\n\t\t\t\t\t</Collapse.Panel>\r\n\t\t\t\t</Collapse>\r\n\t\t\t\t\r\n\t\t\t\t<div style={{ marginBottom: \"20px\" }}>\r\n\t\t\t\t\t<Divider plain id=\"divider-open-invites\" orientation=\"left\">Open Invites</Divider>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<PostList\r\n\t\t\t\t\t\tposts={openInvites}\r\n\t\t\t\t\t\tdisplayType={displayType} \r\n\t\t\t\t\t\tonClick={displayType === 0 && onPostClick}\r\n\t\t\t\t\t\tpostProps={getPostProps}\r\n\t\t\t\t\t\tonAdd={activeUser.sub !== \"demo@pikachure-server.online\" && (_.isEmpty(props.match.params.tag) ? onAddOpenInvite : user?.id === activeUser.id ? onAddOpenInvite : null)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<Divider plain id=\"divider-posts\" orientation=\"left\">Posts</Divider>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<PostList\r\n\t\t\t\t\t\tposts={postedPosts} \r\n\t\t\t\t\t\tdisplayType={displayType}\r\n\t\t\t\t\t\tonClick={displayType === 0 && onPostClick}\r\n\t\t\t\t\t\tpostProps={getPostProps}\r\n\t\t\t\t\t\tonAdd={activeUser.sub !== \"demo@pikachure-server.online\" && (_.isEmpty(props.match.params.tag) ? onAddPost : user?.id === activeUser.id ? onAddPost : null)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</Card>\r\n\t\t\t\r\n\t\t\t<Row justify=\"end\" align=\"middle\" \r\n\t\t\t\tstyle={{\r\n\t\t\t\t\tposition: \"sticky\",\r\n\t\t\t\t\tbottom: 0,\r\n\t\t\t\t\tpadding: \"20px\",\r\n\t\t\t\t\tzIndex: 4 /* Goes on top of Ant Spin who has a ZIndex of 4 */\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<Col className=\"button-group\">\r\n\t\t\t\t\t<Button onClick={() => document.getElementById(\"divider-open-invites\").scrollIntoView({ behavior: \"smooth\" })} icon={<CaretUpOutlined />}>Invites</Button>\r\n\t\t\t\t\t<Button onClick={() => document.getElementById(\"divider-posts\").scrollIntoView({ behavior: \"smooth\" })}  icon={<CaretDownOutlined />}>Posts</Button>\r\n\t\t\t\t</Col>\r\n\t\t\t</Row>\r\n\r\n\t\t\t<Modal\r\n\t\t\t\tvisible={postCreateModal}\r\n\t\t\t\tonCancel={() => setPostCreateModal(false)}\r\n\t\t\t\t// maskClosable={false}\r\n\t\t\t\t// keyboard={false}\r\n\t\t\t\tfooter={null}\r\n\t\t\t\tbodyStyle={{ padding: 0 }}\r\n\t\t\t\tdestroyOnClose\r\n\t\t\t>\r\n\t\t\t\t<PostCreate\r\n\t\t\t\t\tvalues={{ ...selectedPost, lat: selectedPost?.lat || user?.lat, lng: selectedPost?.lng || user?.lng }}\r\n\t\t\t\t\tonDraft={() => setPostCreateModal(false)}\r\n\t\t\t\t\tonSave={async post => {\r\n\t\t\t\t\t\tawait props.onSave({ ...post, id: selectedPost?.id });\r\n\t\t\t\t\t\tsetPostCreateModal(false);\r\n\t\t\t\t\t}}\r\n\t\t\t\t\t\r\n\t\t\t\t\tplaces={places}\r\n\t\t\t\t\tonSearchPlaces={async search => await props.onSearchPlaces(search)}\r\n\t\t\t\t/>\r\n\t\t\t</Modal>\r\n\t\t\t<Modal\r\n\t\t\t\tvisible={openInviteModal}\r\n\t\t\t\tonCancel={() => setOpenInviteModal(false)}\r\n\t\t\t\t// maskClosable={false}\r\n\t\t\t\t// keyboard={false}\r\n\t\t\t\tfooter={null}\r\n\t\t\t\tbodyStyle={{ padding: 0 }}\r\n\t\t\t\tdestroyOnClose\r\n\t\t\t>\r\n\t\t\t\t<OpenInviteCreate\r\n\t\t\t\t\tvalues={{ ...selectedPost, lat: selectedPost?.lat || user?.lat, lng: selectedPost?.lng || user?.lng }}\r\n\t\t\t\t\tmentionList={mentionList}\r\n\t\t\t\t\tsetMentionList={setMentionList}\r\n\t\t\t\t\tonDraft={() => setOpenInviteModal(false)}\r\n\t\t\t\t\tonSave={async post => {\r\n\t\t\t\t\t\tawait props.onSave({ ...post, id: selectedPost?.id });\r\n\t\t\t\t\t\tsetOpenInviteModal(false);\r\n\t\t\t\t\t}}\r\n\t\t\t\t\t\r\n\t\t\t\t\tplaces={places}\r\n\t\t\t\t\tonSearchPlaces={async search => await props.onSearchPlaces(search)}\r\n\r\n\t\t\t\t\tsearchUsers={searchUsers}\r\n\t\t\t\t\tonSearchUsers={async search => await props.onSearchUsers(search)}\r\n\t\t\t\t/>\r\n\t\t\t</Modal>\r\n\t\t</div>\r\n\t);\r\n}","import { useContext } from \"react\";\r\nimport { gql, useLazyQuery, useMutation } from \"@apollo/client\";\r\nimport { Redirect, useHistory } from \"react-router-dom\";\r\nimport _ from \"lodash\";\r\n\r\nimport { ContextLoading, ContextUser } from \"src/components\";\r\n\r\nimport Component from \"./component\";\r\nimport \"./style.css\";\r\n\r\nconst queryUser = gql`\r\n\tquery\r\n\tUser($tag: String) {\r\n\t\tuser(tag: $tag) {\r\n\t\t\tid\r\n\t\t\tname\r\n\t\t\temail\r\n\t\t\ttag\r\n\t\t\tlayout\r\n\t\t\ttermsAgreed\r\n\t\t\tlat\r\n\t\t\tlng\r\n\t\t\tcover {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\tposts {\r\n\t\t\t\tid\r\n\t\t\t\thost {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t\tpicture\r\n\t\t\t\t}\r\n\t\t\t\tdescription\r\n\t\t\t\tplace {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tlat\r\n\t\t\t\t\tlng\r\n\t\t\t\t\tphotos\r\n\t\t\t\t\tname\r\n\t\t\t\t\tbusinessStatus\r\n\t\t\t\t}\r\n\t\t\t\tcover {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\tdateCreated\r\n\t\t\t\t\tnote\r\n\t\t\t\t\texif\r\n\t\t\t\t\tsize\r\n\t\t\t\t\ttype\r\n\t\t\t\t\towner {\r\n\t\t\t\t\t\tid\r\n\t\t\t\t\t\tname\r\n\t\t\t\t\t\ttag\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnote\r\n\t\t\t\t\texif\r\n\t\t\t\t}\r\n\t\t\t\tgallery {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\tdateCreated\r\n\t\t\t\t\tnote\r\n\t\t\t\t\texif\r\n\t\t\t\t\tsize\r\n\t\t\t\t\ttype\r\n\t\t\t\t\towner {\r\n\t\t\t\t\t\tid\r\n\t\t\t\t\t\tname\r\n\t\t\t\t\t\ttag\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnote\r\n\t\t\t\t\texif\r\n\t\t\t\t}\r\n\t\t\t\tguests {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t\tpicture\r\n\t\t\t\t}\r\n\t\t\t\tcomments {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tuser {\r\n\t\t\t\t\t\tid\r\n\t\t\t\t\t\tname\r\n\t\t\t\t\t\ttag\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdescription\r\n\t\t\t\t\tdateCreated\r\n\t\t\t\t\tdateModified\r\n\t\t\t\t}\r\n\t\t\t\tdateCreated\r\n\t\t\t\tdateModified\r\n\t\t\t\tdatePosted\r\n\t\t\t\tisVisible\r\n\t\t\t\tautoAccept\r\n\t\t\t\tbyod\r\n\r\n\t\t\t\t# Geo\r\n\t\t\t\tlat\r\n\t\t\t\tlng\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst mutationSavePost = gql`\r\n\tmutation\r\n\tsavePost(\r\n\t\t$id: String\r\n\t\t$description: String\r\n\t\t$files: [Upload]\r\n\t\t$gallery: [String]\r\n\t\t$coverFiles: [Upload]\r\n\t\t$cover: [String]\r\n\t\t$guests: [String]\r\n\t\t$lng: Float\r\n\t\t$lat: Float\r\n\t\t$place: String\r\n\t\t$country: String\r\n\t\t$city: String\r\n\t\t$region: String\r\n\t\t$datePosted: String\r\n\t\t$isVisible: Boolean\r\n\t\t$autoAccept: Boolean\r\n\t\t$byod: Boolean\r\n\t) {\r\n\t\tsavePost(\r\n\t\t\tid: $id\r\n\t\t\tdescription: $description\r\n\t\t\tfiles: $files\r\n\t\t\tgallery: $gallery\r\n\t\t\tcoverFiles: $coverFiles\r\n\t\t\tcover: $cover\r\n\t\t\tguests: $guests\r\n\t\t\tlng: $lng\r\n\t\t\tlat: $lat\r\n\t\t\tplace: $place\r\n\t\t\tcountry: $country\r\n\t\t\tcity: $city\r\n\t\t\tregion: $region\r\n\t\t\tdatePosted: $datePosted\r\n\t\t\tisVisible: $isVisible\r\n\t\t\tautoAccept: $autoAccept\r\n\t\t\tbyod: $byod\r\n\t\t) {\r\n\t\t\tid\r\n\t\t\thost {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t\tdescription\r\n\t\t\tplace {\r\n\t\t\t\tid\r\n\t\t\t\tlat\r\n\t\t\t\tlng\r\n\t\t\t\tphotos\r\n\t\t\t\tname\r\n\t\t\t\tbusinessStatus\r\n\t\t\t}\r\n\t\t\tgallery {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tguests {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t\tlat\r\n\t\t\tlng\r\n\t\t\tcomments {\r\n\t\t\t\tid\r\n\t\t\t\tdescription\r\n\t\t\t\tdateCreated\r\n\t\t\t\tuser {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdateCreated\r\n\t\t\tdateModified\r\n\t\t\tdatePosted\r\n\t\t\tisVisible\r\n\t\t\tautoAccept\r\n\t\t\tbyod\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst mutationDeletePost = gql`\r\n\tmutation\r\n\tdeletePost(\r\n\t\t$id: String!\r\n\t) {\r\n\t\tdeletePost(id: $id) {\r\n\t\t\tid\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst mutationSaveComment = gql`\r\n\tmutation\r\n\tsaveComment($id: String, $description: String!, $post: String!) {\r\n\t\tsaveComment(id: $id, description: $description, post: $post) {\r\n\t\t\tid\r\n\t\t\tuser {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t}\r\n\t\t\tdescription\r\n\t\t\tdateCreated\r\n\t\t\tdateModified\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst mutationDeleteComment = gql`\r\n\tmutation\r\n\tdeleteComment($id: String!, $post: String!) {\r\n\t\tdeleteComment(id: $id, post: $post) {\r\n\t\t\tid\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst mutationSavePostPhoto = gql`\r\n\t\r\n\tmutation\r\n\tsavePostPhoto($files: [Upload], $id: String!, $gallery: [String]) {\r\n\t\tsavePostPhoto(files: $files, id: $id, gallery: $gallery) {\r\n\t\t\tid\r\n\t\t\thost {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t\tdescription\r\n\t\t\tplace {\r\n\t\t\t\tid\r\n\t\t\t\tlat\r\n\t\t\t\tlng\r\n\t\t\t\tphotos\r\n\t\t\t\tname\r\n\t\t\t\tbusinessStatus\r\n\t\t\t}\r\n\t\t\tcover {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\tgallery {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\tguests {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t\tcomments {\r\n\t\t\t\tid\r\n\t\t\t\tdescription\r\n\t\t\t\tdateCreated\r\n\t\t\t\tuser {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdateCreated\r\n\t\t\tdateModified\r\n\t\t\tdatePosted\r\n\t\t\tisVisible\r\n\t\t\tautoAccept\r\n\t\t\tbyod\r\n\r\n\t\t\t# Geo\r\n\t\t\tlat\r\n\t\t\tlng\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst mutationLeavePost = gql`\r\n\tmutation\r\n\tleavePost($id: String!) {\r\n\t\tleavePost(id: $id) {\r\n\t\t\tid\r\n\t\t\thost {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t\tdescription\r\n\t\t\tplace {\r\n\t\t\t\tid\r\n\t\t\t\tlat\r\n\t\t\t\tlng\r\n\t\t\t\tphotos\r\n\t\t\t\tname\r\n\t\t\t\tbusinessStatus\r\n\t\t\t}\r\n\t\t\tcover {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\tgallery {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\tguests {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t\tcomments {\r\n\t\t\t\tid\r\n\t\t\t\tdescription\r\n\t\t\t\tdateCreated\r\n\t\t\t\tuser {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdateCreated\r\n\t\t\tdateModified\r\n\t\t\tdatePosted\r\n\t\t\tisVisible\r\n\t\t\tautoAccept\r\n\t\t\tbyod\r\n\r\n\t\t\t# Geo\r\n\t\t\tlat\r\n\t\t\tlng\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst mutationJoinPost = gql`\r\n\tmutation\r\n\tjoinPost($id: String!) {\r\n\t\tjoinPost(id: $id) {\r\n\t\t\tid\r\n\t\t\thost {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t\tdescription\r\n\t\t\tplace {\r\n\t\t\t\tid\r\n\t\t\t\tlat\r\n\t\t\t\tlng\r\n\t\t\t\tphotos\r\n\t\t\t\tname\r\n\t\t\t\tbusinessStatus\r\n\t\t\t}\r\n\t\t\tcover {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\tgallery {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\tguests {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t\tcomments {\r\n\t\t\t\tid\r\n\t\t\t\tdescription\r\n\t\t\t\tdateCreated\r\n\t\t\t\tuser {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdateCreated\r\n\t\t\tdateModified\r\n\t\t\tdatePosted\r\n\t\t\tisVisible\r\n\t\t\tautoAccept\r\n\t\t\tbyod\r\n\r\n\t\t\t# Geo\r\n\t\t\tlat\r\n\t\t\tlng\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst mutationSaveUser = gql`\r\n\tmutation\r\n\tsaveUser($tag: String, $layout: Int, $file: Upload, $cover: String) {\r\n\t\tsaveUser(tag: $tag, layout: $layout, file: $file, cover: $cover) {\r\n\t\t\tid\r\n\t\t\tname\r\n\t\t\temail\r\n\t\t\ttag\r\n\t\t\tlayout\r\n\t\t\tcover {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\ttermsAgreed\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst queryPlaces = gql`\r\n query places($lat: Float!, $lng: Float!, $radius: Float!) {\r\n    places(lat: $lat, lng: $lng, radius: $radius) {\r\n\t\t\tid\r\n\t\t\tbusinessStatus\r\n\t\t\tlat\r\n\t\t\tlng\r\n\t\t\ticon\r\n\t\t\tname\r\n\t\t\tphotos\r\n    }\r\n  }\r\n`;\r\n\r\nconst querySearchUsers = gql`\r\n\tquery searchUsers($name: String) {\r\n\t\tsearchUsers(name: $name) {\r\n\t\t\tid\r\n\t\t\ttag\r\n\t\t\tpicture\r\n\t\t}\r\n\t}\r\n`;\r\n\r\n\r\nfunction Home(props) {\r\n\tconst [userRefetch, { data, loading, error }] = useLazyQuery(queryUser, { fetchPolicy: \"cache-and-network\" });\r\n\tconst [savePost, { data: mutationSavePostData, loading: mutationSavePostsLoading, error: mutationSavePostsError }] = useMutation(mutationSavePost, { refetchQueries: [queryUser] });\r\n\tconst [deletePost, { data: mutationDeletePostData, loading: mutationDeletePostsLoading, error: mutationDeletePostsError }] = useMutation(mutationDeletePost, { refetchQueries: [queryUser] });\r\n\tconst [saveComment, { data: mutationSaveCommentPostData, loading: mutationSaveCommentLoading, error: mutationSaveCommentPostsError }] = useMutation(mutationSaveComment, { refetchQueries: [queryUser] });\r\n\tconst [deleteComment, { data: mutationDeleteCommentPostData, loading: mutationDeleteCommentLoading, error: mutationDeleteCommentPostsError }] = useMutation(mutationDeleteComment, { refetchQueries: [queryUser] });\r\n\tconst [savePostPhoto, { data: mutationSavePostPhotoData, loading: mutationSavePostPhotoLoading, error: mutationSavePostPhotoError }] = useMutation(mutationSavePostPhoto, { refetchQueries: [queryUser] });\r\n\tconst [saveUser, { data: mutationSaveUserData, loading: mutationSaveUserLoading, error: mutationSaveUserError }] = useMutation(mutationSaveUser, { fetchPolicy: \"no-cache\", refetchQueries: [queryUser] });\r\n\tconst [querySearchUserRefetch, { data: querySearchUsersData, loading: querySearchUsersLoading, error: querySearchUsersError }] = useLazyQuery(querySearchUsers);\r\n\tconst [queryPlacesRefetch, { data: queryPlacesData, loading: queryPlacesLoading, error: queryPlacesError }] = useLazyQuery(queryPlaces, { fetchPolicy: \"no-cache\" });\r\n\t\r\n\tconst [leavePost, { data: mutationLeavePostData, loading: mutationLeavePostLoading, error: mutationLeavePostError }] = useMutation(mutationLeavePost, { refetchQueries: [queryUser] });\r\n\tconst [joinPost, { data: mutationJoinPostData, loading: mutationJoinPostLoading, error: mutationJoinPostError }] = useMutation(mutationJoinPost, { refetchQueries: [queryUser] });\r\n\r\n\tconst history = useHistory(); \r\n\r\n\t// Redirect if the user is not logged in\r\n\tconst [user] = useContext(ContextUser);\r\n\tif(_.isEmpty(user)) return <Redirect to=\"/\" />;\r\n\r\n  return (\r\n\t\t<ContextLoading.Provider value={{ userLoading: loading, saveUserLoading: mutationSaveUserLoading, postsLoading: loading, saveLoading: mutationSavePostsLoading, saveCommentLoading: mutationSaveCommentLoading, deleteCommentLoading: mutationDeleteCommentLoading, savePostPhotoLoading: mutationSavePostPhotoLoading, leavePostLoading: mutationLeavePostLoading, joinPostLoading: mutationJoinPostLoading, placesLoading: queryPlacesLoading, searchUsersLoading: querySearchUsersLoading }}>\r\n\t\t\t<Component \r\n\t\t\t\t{...props} \r\n\t\t\t\thistory={history}\r\n\t\t\t\tactiveUser={user}\r\n\r\n\t\t\t\terror={error}\r\n\t\t\t\tposts={data?.user.posts}\r\n        user={data?.user}\r\n\t\t\t\tsaveUser={async user => await saveUser({ variables: user })}\r\n\t\t\t\tonSave={async post => await savePost({ variables: { \r\n\t\t\t\t\t// ...DefaultValues.POST_PUBLIC, // We now ambiguously save Open Invite and Posts in this function\r\n\t\t\t\t\t...post, \r\n\t\t\t\t\tgallery: !_.isNil(post.gallery) ? _.map(post.gallery, \"name\") : undefined, \r\n\t\t\t\t\tcover: !_.isNil(post.cover) ? _.map(post.cover, \"name\") : undefined,\r\n\t\t\t\t\tguests: !_.isNil(post.guests) ? _.map(post.guests, \"id\") : undefined,\r\n\t\t\t\t\tplace: _.isNull(post.place) ? null : post.place?.id /* Null means the post place was erased */\r\n\t\t\t\t}})}\r\n\t\t\t\tonDelete={async id => await deletePost({ variables: { id }})}\r\n\t\t\t\tonEdit={async post => await savePost({ variables: { \r\n\t\t\t\t\t...post, \r\n\t\t\t\t\tgallery: !_.isEmpty(post.gallery) ? _.map(post.gallery, \"name\") : undefined, \r\n\t\t\t\t\tcover: !_.isNil(post.cover) ? _.map(post.cover, \"name\") : undefined,\r\n\t\t\t\t\tguests: !_.isEmpty(post.guests) ? _.map(post.guests, \"id\") : undefined \r\n\t\t\t\t}})}\r\n\t\t\t\tonLeavePost={async id => await leavePost({ variables: { id }})}\r\n\t\t\t\tonJoinPost={async id => await joinPost({ variables: { id }})}\r\n\t\t\t\tonComment={async (comment, post) => await saveComment({ variables: { id: comment.id, description: comment.description, post }})}\r\n\t\t\t\tonCommentDelete={async (id, post) => await deleteComment({ variables: { id, post }})}\r\n\r\n\t\t\t\tuserRefetch={userRefetch}\r\n\r\n\t\t\t\tsavePostPhoto={async post => await savePostPhoto({ variables: { \r\n\t\t\t\t\tid: post.id, \r\n\t\t\t\t\tgallery: _.map(post.gallery, \"name\"), \r\n\t\t\t\t\tfiles: post.files,\r\n\t\t\t\t\tcover: !_.isNil(post.cover) ? _.map(post.cover, \"name\") : undefined\r\n\t\t\t\t}})}\r\n\t\t\t\t\r\n\t\t\t\tplaces={queryPlacesData?.places}\r\n\t\t\t\tonSearchPlaces={async location => await queryPlacesRefetch({ variables: location })}\r\n\t\t\t\tsearchUsers={querySearchUsersData?.searchUsers}\r\n\t\t\t\tonSearchUsers={async name => await querySearchUserRefetch({ variables: { name }})}\r\n\t\t\t/>\r\n\t\t</ContextLoading.Provider>\r\n  );\r\n}\r\n\r\nexport default Home;\r\n\r\nconst DefaultValues = {\r\n\tPOST_PUBLIC: { \r\n\t\tdatePosted: new Date().toISOString(), \r\n\t\tisVisible: true \r\n\t}\r\n}","import { useState, useContext, useRef } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport Plx from \"react-plx\";\r\nimport { Card, Typography, Button, Row, Col, List, Modal, Input, Rate } from \"antd\";\r\nimport { EnvironmentFilled, AppstoreFilled, CaretLeftOutlined, CaretRightOutlined, TabletFilled, FontColorsOutlined } from '@ant-design/icons';\r\nimport _ from \"lodash\";\r\n\r\nimport { ContextLoading, PrivacyPolicy, TermsAndConditions } from \"src/components\";\r\nimport \"./style.css\";\r\n\r\nexport default function Settings(props) {\r\n\tconst modalRef = useRef(null);\r\n\tconst { user } = props;\r\n\tconst [modalVisible, setModalVisibility] = useState(false);\r\n\tconst [name, setName] = useState();\r\n\tconst [tag, setTag] = useState();\r\n\tconst [ppModal, setPPModal] = useState(false);\r\n\tconst [tsModal, setTSModal] = useState(false);\r\n\tconst [feedbackModal, setFeedbackModal] = useState(false);\r\n\tconst [feedback, setFeedback] = useState({});\r\n\tconst { settingsLoading, disableUserLoading, sendFeedbackLoading } = useContext(ContextLoading);\r\n\t\r\n\tconst settingKnobs = [\r\n\t\t{\r\n\t\t\tlabel: \"Tag\",\r\n\t\t\thint: \"Change your name tag\",\r\n\t\t\trender: (\r\n\t\t\t\t<Input \r\n\t\t\t\t\tstyle={{ opacity: settingsLoading ? 0.33 : 1 }} addonBefore=\"@\" placeholder={user.tag} \r\n\t\t\t\t\tvalue={!_.isNil(tag) ? tag : user.tag} \r\n\t\t\t\t\tonChange={event => setTag(event.target.value)} \r\n\t\t\t\t\tonBlur={() => !_.isNil(tag) && tag !== user.tag && props.saveUser({ tag: `${tag}`.trim().toLowerCase() })} \r\n\t\t\t\t/>\r\n\t\t\t)\r\n\t\t},\r\n\t\t{\r\n\t\t\tlabel: \"Name\",\r\n\t\t\thint: \"Change your profile name\",\r\n\t\t\trender: (\r\n\t\t\t\t<Input \r\n\t\t\t\t\tstyle={{ opacity: settingsLoading ? 0.33 : 1 }} addonBefore={<FontColorsOutlined />} placeholder={user.name} \r\n\t\t\t\t\tvalue={!_.isNil(name) ? name : user.name} \r\n\t\t\t\t\tonChange={event => setName(event.target.value)} \r\n\t\t\t\t\tonBlur={() => !_.isNil(name) && name !== user.name && props.saveUser({ name: `${name}`.trim() })} \r\n\t\t\t\t/>\r\n\t\t\t)\r\n\t\t},\r\n\t\t{\r\n\t\t\tlabel: \"Layout\",\r\n\t\t\thint: \"View posts in Compact or List format\",\r\n\t\t\trender: (\r\n\t\t\t\t<Row>\r\n\t\t\t\t\t<Col className=\"button-group\" style={{ opacity: settingsLoading ? 0.33 : 1, pointerEvents: settingsLoading ? \"none\" : undefined }}>\r\n\t\t\t\t\t\t<Button type={user.layout === 0 ? \"primary\" : \"default\"} icon={<AppstoreFilled />} onClick={() => props.saveUser({ layout: 0 })} />\r\n\t\t\t\t\t\t<Button type={user.layout === 1 ? \"primary\" : \"default\"} icon={<TabletFilled />} onClick={() => props.saveUser({ layout: 1 })} />\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t</Row>\r\n\t\t\t)\r\n\t\t},\r\n\t\t{\r\n\t\t\tlabel: \"About\",\r\n\t\t\thint: \"News, updates, and contacts\",\r\n\t\t\trender: <Button disabled={true} onClick={() => setModalVisibility(true)} icon={<CaretRightOutlined />}>Work in Progress</Button>\r\n\t\t},\r\n\t\t{\r\n\t\t\tlabel: \"Feedback\",\r\n\t\t\thint: \"Tell us your thoughts\",\r\n\t\t\trender: <Rate value={6} onChange={value => setFeedback({ ...feedback, value }) || setFeedbackModal(true)} />\r\n\t\t},\r\n\t\t{\r\n\t\t\tlabel: \"Logout\",\r\n\t\t\thint: \"Go to Login page\",\r\n\t\t\trender: (\r\n\t\t\t\t<Button onClick={() => {\r\n\t\t\t\t\tModal.confirm({\r\n\t\t\t\t\t\ttitle: \"Logout\",\r\n\t\t\t\t\t\tcontent: \"You will have to sign-in again. Continue to logout?\",\r\n\t\t\t\t\t\ticon: null,\r\n\t\t\t\t\t\tokText: \"Logout\",\r\n\t\t\t\t\t\tcancelText: \"Cancel\",\r\n\t\t\t\t\t\tonOk: async () => {\r\n\t\t\t\t\t\t\t// Clear token\r\n\t\t\t\t\t\t\tawait localStorage.setItem(\"token\", \"\");\r\n\r\n\t\t\t\t\t\t\t// Clear cache\r\n\t\t\t\t\t\t\tawait props.apolloClient.cache.reset();\r\n\r\n\t\t\t\t\t\t\t// Clear Providers\r\n\t\t\t\t\t\t\tprops.setUser();\r\n\t\t\t\t\t\t\tprops.history.replace(\"/\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}}>\r\n\t\t\t\t\tLogout\r\n\t\t\t\t</Button>\r\n\t\t\t)\r\n\t\t},\r\n\t\t// {\r\n\t\t// \tlabel: \"Disable Account\",\r\n\t\t// \thint: \"Re-enable account by logging back in\",\r\n\t\t// \trender: (\r\n\t\t// \t\t<Button \r\n\t\t// \t\t\tloading={disableUserLoading}\r\n\t\t// \t\t\ttype=\"danger\"\r\n\t\t// \t\t\tonClick={() => Modal.confirm({\r\n\t\t// \t\t\t\ttitle: \"Disable Account\",\r\n\t\t// \t\t\t\tcontent: \"Remove your presence and logout. You can recover your account by logging in again. Continue to logout?\",\r\n\t\t// \t\t\t\ticon: null,\r\n\t\t// \t\t\t\tokText: \"Disable Account\",\r\n\t\t// \t\t\t\tcancelText: \"Cancel\",\r\n\t\t// \t\t\t\tonOk: async () => {\r\n\t\t// \t\t\t\t\tawait props.disableUser();\r\n\r\n\t\t// \t\t\t\t\t// Clear token\r\n\t\t// \t\t\t\t\tawait localStorage.removeItem(\"token\");\r\n\r\n\t\t// \t\t\t\t\t// Clear cache\r\n\t\t// \t\t\t\t\tawait props.apolloClient.cache.reset();\r\n\r\n\t\t// \t\t\t\t\t// Clear Providers\r\n\t\t// \t\t\t\t\tprops.setUser();\r\n\t\t// \t\t\t\t\tprops.history.replace(\"/\");\r\n\t\t// \t\t\t\t}\r\n\t\t// \t\t\t})}\r\n\t\t// \t\t>\r\n\t\t// \t\t\tDisable and Logout\r\n\t\t// \t\t</Button>\r\n\t\t// \t)\r\n\t\t// }\r\n\t];\r\n\t\r\n\treturn (\r\n\t\t<div id=\"settings-container\">\r\n\t\t\t<Row className=\"header\" justify=\"space-between\" align=\"middle\">\r\n\t\t\t\t<Col>\r\n\t\t\t\t\t<Link to=\"/\"><Typography.Title style={{ margin: 0, color: \"var(--ant-primary-color)\" }}>Pikachure</Typography.Title></Link>\r\n\t\t\t\t</Col>\r\n\t\t\t\t<Col>\r\n\t\t\t\t\t<Button shape=\"circle\" icon={<CaretLeftOutlined />} style={{ marginRight: \"10px\" }} onClick={() => props.history.goBack()} />\r\n\t\t\t\t\t<Link to=\"/explore\"><Button icon={<EnvironmentFilled style={{ color: \"var(--ant-primary-color)\" }} />}>Explore</Button></Link>\r\n\t\t\t\t</Col>\r\n\t\t\t</Row>\r\n\r\n\t\t\t<Plx \r\n\t\t\t\tclassName=\"plx\"\r\n\t\t\t\tparallaxData={[{\r\n\t\t\t\t\tstart: \"self\",\r\n\t\t\t\t\tend: 1000,\r\n\t\t\t\t\tproperties: [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tstartValue: -35,\r\n\t\t\t\t\t\t\tendValue: -400,\r\n\t\t\t\t\t\t\tproperty: \"translateY\"\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]\r\n\t\t\t\t}]}\r\n\t\t\t>\r\n\t\t\t\t<Row justify=\"center\">\r\n\t\t\t\t\t<Col span={24}>\r\n\t\t\t\t\t\t<Card bordered={false} id=\"settings-cover-card\">\r\n\t\t\t\t\t\t\t<img alt=\"settings-cover\" id=\"settings-cover\" src=\"https://images.unsplash.com/photo-1506744038136-46273834b3fb?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxleHBsb3JlLWZlZWR8MXx8fGVufDB8fHx8&w=1000&q=80\" />\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<div id=\"settings-cover-content\">\r\n\t\t\t\t\t\t\t\t<Typography.Title\r\n\t\t\t\t\t\t\t\t\tstyle={{ color: \"white\", margin: 0 }}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\tSettings\r\n\t\t\t\t\t\t\t\t</Typography.Title>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</Card>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t</Row>\r\n\t\t\t</Plx>\r\n\t\t\t\r\n\t\t\t<Card bordered={false} id=\"settings-content-card\" style={{ marginTop: \"min(calc(100vw * 0.80 - 10px), calc(576px * 0.80 - 10px))\" /* For the PLX library */ }}>\r\n\t\t\t\t<div id=\"settings-content-container\">\r\n\t\t\t\t\t<List\r\n\t\t\t\t\t\tid=\"settings-list\"\r\n\t\t\t\t\t\tdataSource={settingKnobs}\r\n\t\t\t\t\t\trenderItem={setting => (\r\n\t\t\t\t\t\t\t<List.Item>\r\n\t\t\t\t\t\t\t\t<List.Item.Meta\r\n\t\t\t\t\t\t\t\t\ttitle={setting.label}\r\n\t\t\t\t\t\t\t\t\tdescription={setting.hint}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<div>{ setting.render }</div>\r\n\t\t\t\t\t\t\t</List.Item>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</Card>\r\n\t\t\t\r\n\t\t\t<Row justify=\"end\" align=\"middle\" style={{ padding: \"20px\" }}>\r\n\t\t\t\t<Col className=\"button-group\">\r\n\t\t\t\t\t<Button onClick={() => setPPModal(true)}>Privacy Policy</Button>\r\n\t\t\t\t\t<Button onClick={() => setTSModal(true)}>Terms and Conditions</Button>\t\r\n\t\t\t\t</Col>\r\n\t\t\t</Row>\r\n\t\t\t\r\n\t\t\t<Modal\r\n\t\t\t\tvisible={feedbackModal}\r\n\t\t\t\tbodyStyle={{ padding: 0 }}\r\n\t\t\t\tfooter={null}\r\n\t\t\t>\r\n\t\t\t\t<Row id=\"settings-feedback-container\" align=\"middle\" justify=\"space-around\">\r\n\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t<Rate value={feedback.value} onChange={value => setFeedback({ ...feedback, value })} />\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t\t<Col span={24} style={{ marginTop: \"20px\" }}>\r\n\t\t\t\t\t\t<Input.TextArea\r\n\t\t\t\t\t\t\tonBlur={event => setFeedback({ ...feedback, description: event.target.value })}\r\n\t\t\t\t\t\t\tdefaultValue={feedback.description}\r\n\t\t\t\t\t\t\tplaceholder=\"Feedback\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t\t<Col span={24} className=\"button-group\" style={{ marginTop: \"20px\", textAlign: \"right\" }}>\r\n\t\t\t\t\t\t<Button onClick={() => setFeedbackModal(false)}>Close</Button>\r\n\t\t\t\t\t\t<Button loading={sendFeedbackLoading} disabled={feedback.value === 0 && _.isEmpty(feedback.description)} type=\"primary\" onClick={async () => { await props.sendFeedback(feedback) || setFeedback({}); setFeedbackModal(false); }}>Send</Button>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t</Row>\r\n\t\t\t</Modal>\r\n\r\n\r\n\t\t\t<Modal\r\n\t\t\t\tvisible={ppModal}\r\n\t\t\t\tbodyStyle={{ padding: 0 }}\r\n\t\t\t\tfooter={<Button onClick={() => setPPModal(false)}>Close</Button>}\r\n\t\t\t>\r\n\t\t\t\t<div id=\"pp-container\">\r\n\t\t\t\t\t<PrivacyPolicy />\r\n\t\t\t\t</div>\r\n\t\t\t</Modal>\r\n\r\n\t\t\t<Modal\r\n\t\t\t\tvisible={tsModal}\r\n\t\t\t\tbodyStyle={{ padding: 0 }}\r\n\t\t\t\tfooter={<Button onClick={() => setTSModal(false)}>Close</Button>}\r\n\t\t\t>\r\n\t\t\t\t<div id=\"ts-container\">\r\n\t\t\t\t\t<TermsAndConditions />\r\n\t\t\t\t</div>\r\n\t\t\t</Modal>\r\n\t\t</div>\r\n\t);\r\n}","import { useContext } from \"react\";\r\nimport { gql, useMutation, useQuery, useApolloClient } from \"@apollo/client\";\r\nimport { Redirect } from \"react-router\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport _ from \"lodash\";\r\n\r\nimport { ContextUser, ContextLoading } from \"src/components\";\r\nimport Component from \"./component\";\r\n\r\nconst queryUser = gql`\r\n\tquery\r\n\tUser($tag: String) {\r\n\t\tuser(tag: $tag) {\r\n\t\t\tid\r\n\t\t\tname\r\n\t\t\temail\r\n\t\t\ttag\r\n\t\t\tlayout\r\n\t\t\ttermsAgreed\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst mutationSaveSettings = gql`\r\n\tmutation\r\n\tsaveUser($tag: String, $name: String, $layout: Int) {\r\n\t\tsaveUser(tag: $tag, name: $name, layout: $layout) {\r\n\t\t\tid\r\n\t\t\tname\r\n\t\t\temail\r\n\t\t\ttag\r\n\t\t\tlayout\r\n\t\t\ttermsAgreed\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst mutationSendFeedback = gql`\r\n\tmutation\r\n\tsendFeedback($value: Int, $description: String) {\r\n\t\tsendFeedback(value: $value, description: $description) {\r\n\t\t\tid\r\n\t\t\tvalue\r\n\t\t\tdescription\r\n\t\t\tuser {\r\n\t\t\t\tid\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst mutationDisableUser = gql`\r\n\tmutation\r\n\tdisableUser {\r\n\t\tdisableUser {\r\n\t\t\tid\r\n\t\t\tdisabled\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nfunction Settings(props) {\r\n\tconst { data: queryUserData, loading: queryUserLoading, error: queryUserError, refetch: queryUserRefetch } = useQuery(queryUser, { fetchPolicy: \"no-cache\" });\r\n\tconst [saveUser, { data, loading, error }] = useMutation(mutationSaveSettings, { fetchPolicy: \"no-cache\" });\r\n\tconst [sendFeedback, { data: mutationSendFeedbackData, loading: mutationSendFeedbackLoading, error: mutationSendFeedbackError }] = useMutation(mutationSendFeedback, { fetchPolicy: \"no-cache\" });\r\n\tconst [disableUser, { data: mutationDisableUserData, loading: mutationDisableUserLoading, error: mutationDisableUserError }] = useMutation(mutationDisableUser, { fetchPolicy: \"no-cache\" });\r\n\tconst history = useHistory(); \r\n\tconst apolloClient = useApolloClient(); // Used for logging out\r\n\r\n\t// Redirect if the user is not logged in\r\n\tconst [user, setUser] = useContext(ContextUser);\r\n\tif(_.isEmpty(user)) return <Redirect to=\"/\" />;\r\n\r\n\tconst activeUser = { ...user, ...queryUserData?.user, ...data?.saveUser };\r\n\t\r\n\treturn (\r\n\t\t<ContextLoading.Provider value={{ settingsLoading: loading, disableUserLoading: mutationDisableUserLoading, sendFeedbackLoading: mutationSendFeedbackLoading }}>\r\n\t\t\t<Component \r\n\t\t\t\thistory={history}\r\n\t\t\t\tapolloClient={apolloClient}\r\n\t\t\t\t\r\n\t\t\t\tuser={activeUser} \r\n\t\t\t\tsetUser={setUser}\r\n\t\t\t\tsaveUser={async user => await saveUser({ variables: user })}\r\n\t\t\t\tdisableUser={disableUser}\r\n\r\n\t\t\t\tsendFeedback={async feedback => await sendFeedback({ variables: feedback })}\r\n\r\n\t\t\t\t{...props} \r\n\t\t\t/>\r\n\t\t</ContextLoading.Provider>\r\n\t);\r\n}\r\n\r\nexport default Settings;","import { useState, useEffect, useContext } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport Plx from \"react-plx\";\r\nimport { Card, Typography, Button, Row, Col, Spin, Input, Modal } from \"antd\";\r\nimport { EnvironmentFilled, SendOutlined, LoadingOutlined } from '@ant-design/icons';\r\nimport _ from \"lodash\";\r\nimport Moment from \"moment\";\r\n\r\nimport { Post, ContextLoading } from \"src/components\";\r\nimport \"./style.css\";\r\n\r\nexport default function Comments(props) {\r\n\tconst { saveCommentLoading, commentsLoading } = useContext(ContextLoading);\r\n\tconst [comment, setComment] = useState();\r\n\tconst [selectedComment, setSelectedComment] = useState();\r\n\tconst [editComment, setEditComment] = useState(\"\");\r\n\tconst { post, comments, user } = props;\r\n\r\n\tuseEffect(() => {\r\n\t\tprops.commentsRefetch({ variables: { id: props.match.params.post }});\r\n\t\tprops.postRefetch({ variables: { id: props.match.params.post }});\r\n\t\tdocument.documentElement.scrollIntoView();\r\n\t}, [props.match.params.post]);\r\n\r\n\treturn (\r\n\t\t<div id=\"comments-container\">\r\n\t\t\t<Row className=\"header\" justify=\"space-between\" align=\"middle\">\r\n\t\t\t\t<Col style={{ height: \"50px\" }}>\r\n\t\t\t\t\t<Link to=\"/\"><Typography.Title style={{ margin: 0, color: \"var(--ant-primary-color)\" }}>Pikachure</Typography.Title></Link>\r\n\t\t\t\t</Col>\r\n\t\t\t\t<Col>\r\n\t\t\t\t\t<Link to=\"/explore\"><Button icon={<EnvironmentFilled style={{ color: \"var(--ant-primary-color)\" }} />}>Explore</Button></Link>\r\n\t\t\t\t</Col> \r\n\t\t\t</Row>\r\n\r\n\t\t\t\t<Plx\r\n\t\t\t\t\tclassName=\"plx\"\r\n\t\t\t\t\tparallaxData={[{\r\n\t\t\t\t\t\tstart: \"self\",\r\n\t\t\t\t\t\tend: 1000,\r\n\t\t\t\t\t\tproperties: [\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tstartValue: -35,\r\n\t\t\t\t\t\t\t\tendValue: -400,\r\n\t\t\t\t\t\t\t\tproperty: \"translateY\"\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t}]}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Row justify=\"space-between\">\r\n\t\t\t\t\t\t<Col span={24}>\r\n\t\t\t\t\t\t\t<Card bordered={false} id=\"comments-cover-card\">\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t!_.isEmpty(post) ? (\r\n\t\t\t\t\t\t\t\t\t\t\t<Post post={{ ...post, comments: [] }} compact />\r\n\t\t\t\t\t\t\t\t\t) : <div style={{ height: \"431px\" }} />\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</Card>\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t</Row>\r\n\t\t\t\t</Plx>\r\n\t\t\t\r\n\t\t\t<Card bordered={false} id=\"comments-content-card\" style={{ marginTop: \"min(calc(100vw * 0.75), calc(576px * 0.75))\", minHeight: \"576px\" }}>\r\n\t\t\t\t<Spin spinning={commentsLoading} indicator={<LoadingOutlined style={{ fontSize: 60 }} spin />}>\r\n\t\t\t\t\t<Row justify=\"space-between\" align=\"top\" style={{ margin: \"0 20px 0 20px\" }}>\r\n\t\t\t\t\t\t<Col key={0} span={18}>\r\n\t\t\t\t\t\t\t<div className=\"comment\"><b>{ post?.host?.tag }</b>{\" \"}{ post?.description }</div>\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t<Col key={1} span={6} className=\"comment-date\">\r\n\t\t\t\t\t\t\t<sub>{ Moment(post?.dateCreated).isValid() ? Moment(post?.dateCreated).fromNow() : null }</sub>\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t</Row>\r\n\r\n\t\t\t\t\t<div id=\"comments-content-container\">\r\n\t\t\t\t\t\t<Row justify=\"end\" className=\"comment-form-container\">\r\n\t\t\t\t\t\t\t<Input.TextArea\r\n\t\t\t\t\t\t\t\tclassName=\"comment-text\"\r\n\t\t\t\t\t\t\t\tplaceholder=\"Say something...\"\r\n\t\t\t\t\t\t\t\trows={2}\r\n\t\t\t\t\t\t\t\tvalue={comment}\r\n\t\t\t\t\t\t\t\tonChange={({ target: { value }}) => setComment(value)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<Button \r\n\t\t\t\t\t\t\t\tdisabled={_.size(comment) <= 0}\r\n\t\t\t\t\t\t\t\tclassName=\"comment-button\"\r\n\t\t\t\t\t\t\t\ttype=\"primary\" icon={<SendOutlined />}\r\n\t\t\t\t\t\t\t\tloading={saveCommentLoading}\r\n\t\t\t\t\t\t\t\tstyle={{ opacity: _.size(comment) > 0 ? 1 : 0 }}\r\n\t\t\t\t\t\t\t\tonClick={async () => {\r\n\t\t\t\t\t\t\t\t\tawait props.onComment({ description: comment }, post.id);\r\n\t\t\t\t\t\t\t\t\tsetComment(\"\")\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tComment\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<Row justify=\"space-between\" align=\"top\" style={{ margin: \"0 20px 0 20px\" }}>\r\n\t\t\t\t\t\t\t<Col span={24}>\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t!_.isEmpty(comments) ? _.map(comments, (comment, index) => (\r\n\t\t\t\t\t\t\t\t\t<Row key={comment.id} justify=\"space-between\" onClick={() => setSelectedComment(comment) || setEditComment(comment.description)}>\r\n\t\t\t\t\t\t\t\t\t\t<Col key={comment.id + index} span={16}>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"comment\" ><b>{ comment.user.tag }</b>{\" \"}{ comment.description }</div>\r\n\t\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t\t<Col key={comment.id + 2 + index} span={8} className=\"comment-date\">\r\n\t\t\t\t\t\t\t\t\t\t\t<sub>{ comment.dateCreated !== comment.dateModified && <i>(edited) </i> }{ Moment(comment.dateCreated).isValid() ? Moment(comment.dateCreated).fromNow() : null }</sub>\r\n\t\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t)) : null\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Spin>\r\n\t\t\t</Card>\r\n\t\t\t\r\n\t\t\t{/* Modal for editing a comment */}\r\n\t\t\t<Modal\r\n\t\t\t\tvisible={selectedComment}\r\n\t\t\t\tonCancel={() => setSelectedComment()}\r\n\t\t\t\t// maskClosable={false}\r\n\t\t\t\t// keyboard={false}\r\n\t\t\t\tfooter={null}\r\n\t\t\t\tbodyStyle={{ padding: 0 }}\r\n\t\t\t\tdestroyOnClose\r\n\t\t\t>\r\n\t\t\t\t<Row style={{ padding: \"20px\" }}>\r\n\t\t\t\t\t<Col span={18}>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<b>{ selectedComment?.user.tag }</b>\r\n\t\t\t\t\t\t\t{ selectedComment?.user.id !== user?.id ? \" \" + selectedComment?.description : null }\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t\t<Col span={6} className=\"comment-date\">\r\n\t\t\t\t\t\t<sub>{ Moment(selectedComment?.dateCreated).isValid() ? Moment(selectedComment?.dateCreated).fromNow() : null }</sub>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tselectedComment?.user.id === user?.id ? (\r\n\t\t\t\t\t\t\t<Col span={24} style={{ marginTop: \"20px\" }}>\r\n\t\t\t\t\t\t\t\t<Input.TextArea\r\n\t\t\t\t\t\t\t\t\tautoFocus\r\n\t\t\t\t\t\t\t\t\tclassName=\"comment-text\"\r\n\t\t\t\t\t\t\t\t\tplaceholder=\"Say something...\"\r\n\t\t\t\t\t\t\t\t\tvalue={editComment}\r\n\t\t\t\t\t\t\t\t\tonChange={({ target: { value }}) => setEditComment(value)}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t) : null\r\n\t\t\t\t\t}\r\n\t\t\t\t</Row>\r\n\t\t\t\t\r\n\t\t\t\t<div className=\"button-group\" style={{ textAlign: \"right\", padding: \"20px\", overflow: \"auto hidden\" }}>\r\n\t\t\t\t\t<Button onClick={() => setSelectedComment()}>Close</Button>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tselectedComment?.user.id !== user?.id ? (\r\n\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t{/*<Button>Report</Button>*/}\r\n\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t_.isFunction(props.onCommentDelete) ? (\r\n\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\tonClick={async () => {\r\n\t\t\t\t\t\t\t\t\t\t\tModal.confirm({\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: \"Delete Comment\",\r\n\t\t\t\t\t\t\t\t\t\t\t\tcontent: \"Are you sure you want to delete this comment? This cannot be undone.\",\r\n\t\t\t\t\t\t\t\t\t\t\t\ticon: null,\r\n\t\t\t\t\t\t\t\t\t\t\t\tokText: \"Delete\",\r\n\t\t\t\t\t\t\t\t\t\t\t\tcancelText: \"Cancel\",\r\n\t\t\t\t\t\t\t\t\t\t\t\tonOk: async () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tawait props.onCommentDelete(selectedComment.id, post.id);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetSelectedComment();\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\tDelete\r\n\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t) : null\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t<Button \r\n\t\t\t\t\t\t\t\t\tloading={saveCommentLoading}\r\n\t\t\t\t\t\t\t\t\ttype=\"primary\" \r\n\t\t\t\t\t\t\t\t\tdisabled={editComment === selectedComment?.description} \r\n\t\t\t\t\t\t\t\t\tonClick={async () => {\r\n\t\t\t\t\t\t\t\t\t\tawait props.onComment({ id: selectedComment.id, description: editComment }, post.id);\r\n\t\t\t\t\t\t\t\t\t\tsetSelectedComment();\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\tSave\r\n\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t</Modal>\r\n\t\t\t\r\n\t\t\t{/* <Modal\r\n\t\t\t\tvisible={postCreateModalVisibility}\r\n\t\t\t\tonCancel={() => setPostCreateModalVisibility(false)}\r\n\t\t\t\t// maskClosable={false}\r\n\t\t\t\t// keyboard={false}\r\n\t\t\t\tfooter={null}\r\n\t\t\t\tbodyStyle={{ padding: 0 }}\r\n\t\t\t\tdestroyOnClose\r\n\t\t\t>\r\n\t\t\t\t<PostCreate\r\n\t\t\t\t\tonDraft={() => setPostCreateModalVisibility(false)}\r\n\t\t\t\t\tonSave={async post => {\r\n\t\t\t\t\t\tawait props.onSave(post);\r\n\t\t\t\t\t\tsetPostCreateModalVisibility(false);\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t</Modal> */}\r\n\t\t</div>\r\n\t);\r\n}","import { useContext } from \"react\";\r\nimport { gql, useMutation, useQuery, useLazyQuery } from \"@apollo/client\";\r\nimport { Redirect } from \"react-router-dom\";\r\n\r\nimport { ContextLoading, ContextUser } from \"src/components\";\r\n\r\nimport Component from \"./component\";\r\nimport \"./style.css\";\r\nimport _ from \"lodash\";\r\n\r\nconst queryUser = gql`\r\n\tquery\r\n\tUser($tag: String) {\r\n\t\tuser(tag: $tag) {\r\n\t\t\tid\r\n\t\t\tname\r\n\t\t\temail\r\n\t\t\ttag\r\n\t\t\tlayout\r\n\t\t\ttermsAgreed\r\n\t\t\tlat\r\n\t\t\tlng\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst queryPost = gql`\r\n\tquery\r\n\tpost($id: String!) {\r\n\t\tpost(id: $id) {\r\n\t\t\tid\r\n\t\t\thost {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t\tdescription\r\n\t\t\tplace {\r\n\t\t\t\tid\r\n\t\t\t\tlat\r\n\t\t\t\tlng\r\n\t\t\t\tphotos\r\n\t\t\t\tname\r\n\t\t\t\tbusinessStatus\r\n\t\t\t}\r\n\t\t\tcover {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\tgallery {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tdateCreated\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t\tsize\r\n\t\t\t\ttype\r\n\t\t\t\towner {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tname\r\n\t\t\t\t\ttag\r\n\t\t\t\t}\r\n\t\t\t\tnote\r\n\t\t\t\texif\r\n\t\t\t}\r\n\t\t\tguests {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t\tpicture\r\n\t\t\t}\r\n\t\t\tdateCreated\r\n\t\t\tdateModified\r\n\t\t\tdatePosted\r\n\t\t\tisVisible\r\n\t\t\tautoAccept\r\n\t\t\tbyod\r\n\r\n\t\t\t# Geo\r\n\t\t\tlat\r\n\t\t\tlng\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst queryComments = gql`\r\n\tquery\r\n\tcomments($id: String!) {\r\n\t\tcomments(id: $id) {\r\n\t\t\tid\r\n\t\t\tuser {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t}\r\n\t\t\tdescription\r\n\t\t\tdateCreated\r\n\t\t\tdateModified\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst mutationSaveComment = gql`\r\n\tmutation\r\n\tsaveComment($id: String, $description: String!, $post: String!) {\r\n\t\tsaveComment(id: $id, description: $description, post: $post) {\r\n\t\t\tid\r\n\t\t\tuser {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttag\r\n\t\t\t}\r\n\t\t\tdescription\r\n\t\t\tdateCreated\r\n\t\t\tdateModified\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nconst mutationDeleteComment = gql`\r\n\tmutation\r\n\tdeleteComment($id: String!, $post: String!) {\r\n\t\tdeleteComment(id: $id, post: $post) {\r\n\t\t\tid\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nfunction Comments(props) {\r\n\tconst { data: queryUserData, loading, error, refetch } = useQuery(queryUser, { fetchPolicy: \"cache-and-network\" });\r\n\tconst [queryCommentsRefetch, { data: queryCommentsData, loading: queryCommentsLoading, error: queryCommentsError }] = useLazyQuery(queryComments, { fetchPolicy: \"no-cache\" });\r\n\tconst [queryPostRefetch, { data: queryPostData, loading: queryPostLoading, error: queryPostError }] = useLazyQuery(queryPost, { fetchPolicy: \"cache-and-network\" });\r\n\tconst [saveComment, { data: mutationSaveCommentPostData, loading: mutationSaveCommentLoading, error: mutationSaveCommentPostsError }] = useMutation(mutationSaveComment, { refetchQueries: [queryComments] });\r\n\tconst [deleteComment, { data: mutationDeleteCommentPostData, loading: mutationDeleteCommentLoading, error: mutationDeleteCommentPostsError }] = useMutation(mutationDeleteComment, { refetchQueries: [queryUser] });\r\n\t\r\n\t// Redirect if the user is not logged in\r\n\tconst [user] = useContext(ContextUser);\r\n\tif(_.isEmpty(user)) return <Redirect to=\"/\" />;\r\n\r\n  return (\r\n\t\t<ContextLoading.Provider value={{ userLoading: loading, postLoading: queryPostLoading, commentsLoading: queryCommentsLoading, saveCommentLoading: mutationSaveCommentLoading, deleteCommentLoading: mutationDeleteCommentLoading }}>\r\n\t\t\t<Component\r\n\t\t\t\t{...props}\r\n\t\t\t\tactiveUser={user}\r\n\t\t\t\tuser={queryUserData?.user}\r\n\t\t\t\tpost={queryPostData?.post}\r\n\t\t\t\tpostRefetch={queryPostRefetch}\r\n\r\n\t\t\t\tcomments={queryCommentsData?.comments}\r\n\t\t\t\tonComment={async (comment, post) => await saveComment({ variables: { id: comment.id, description: comment.description, post }})}\r\n\t\t\t\tonCommentDelete={async (id, post) => await deleteComment({ variables: { id, post }})}\r\n\t\t\t\tcommentsRefetch={queryCommentsRefetch}\r\n\t\t\t/>\r\n\t\t</ContextLoading.Provider>\r\n  );\r\n}\r\n\r\nexport default Comments;","import React, { useState } from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\n\r\n// Libraries\r\nimport { HashRouter, BrowserRouter as Router, Route, Switch } from \"react-router-dom\";\r\nimport { ParallaxProvider } from \"react-scroll-parallax\";\r\nimport { Pikachure } from \"src/services\";\r\n\r\n// Styles\r\nimport { ConfigProvider } from \"antd\";\r\nimport \"antd/dist/antd.variable.min.css\";\r\nimport \"./style.css\";\r\nimport \"mapbox-gl/dist/mapbox-gl.css\";\r\n\r\n// Pages\r\nimport { Root, Explore, Comments, Home, Settings } from \"src/views\";\r\n\r\n// Components\r\nimport { ContextUser, ContextSelectedPost } from \"src/components\";\r\n\r\n// Apollo Setup\r\nimport {\r\n\tApolloClient,\r\n\tApolloLink,\r\n\tInMemoryCache,\r\n\tApolloProvider,\r\n\tHttpLink,\r\n\tdefaultDataIdFromObject\r\n} from \"@apollo/client\";\r\nimport { setContext } from \"@apollo/client/link/context\";\r\nimport { onError } from \"@apollo/client/link/error\";\r\nimport { createUploadLink } from \"apollo-upload-client\";\r\n\r\nconst authLink = setContext(async (_, { headers }) => {\r\n\ttry {\r\n\t\tlet token = await localStorage.getItem(\"token\") || \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwczovL3Bpa2FjaHVyZS1zZXJ2ZXIub25saW5lIiwiaWF0IjoxNjIyOTQzNDkzLCJleHAiOjE2NTQ0Nzk0OTMsImF1ZCI6InBpa2FjaHVyZS5jb20iLCJzdWIiOiJkZW1vQHBpa2FjaHVyZS1zZXJ2ZXIub25saW5lIiwiZ2l2ZW5OYW1lIjoiRGVtbyIsImZhbWlseU5hbWUiOiJQaWthY2h1cmUiLCJlbWFpbCI6InN1cHBvcnRAcGlrYWNodXJlLmNvbSJ9.XhDTqkAh0oHZLPlRpLiTO0dLVcXc5J0k-U2tZ08Yr4A\";\r\n\t\treturn {\r\n\t\t\theaders: {\r\n\t\t\t\t...headers,\r\n\t\t\t\tauthorization: token ? `Bearer ${token}` : \"\",\r\n\t\t\t}\r\n\t\t}\r\n\t} catch(error) {\r\n\t\tconsole.error(error);\r\n\t}\r\n});\r\n\r\nconst errorLink = onError(({ graphQLErrors, networkError, forward, operation }) => {\r\n  if (graphQLErrors) console.error(graphQLErrors);\r\n  if (networkError) console.warn(networkError);\r\n  forward(operation);\r\n});\r\n\r\nconst httpLink = new HttpLink({\r\n\turi: `${Pikachure.URL}/graphql`\r\n});\r\n\r\nconst uploadLink = createUploadLink({\r\n\turi: `${Pikachure.URL}/graphql`\r\n });\r\n\r\nconst client = new ApolloClient({\r\n  uri: httpLink,\r\n\tdefaultOptions: {\r\n\t\t//fetchPolicy: \"no-cache\"\r\n\t},\r\n\t\r\n\t/**\r\n\t * Apollo Client can only have 1 terminating Apollo Link that sends the GraphQL requests; \r\n\t * if one such as HttpLink is already setup, remove it.\r\n\t */\r\n\tlink: ApolloLink.from([errorLink, authLink, uploadLink /* , httpLink */]),\r\n  cache: new InMemoryCache({\r\n\t\tdataIdFromObject: (object) => {\r\n\t\t\t// return object.id;\r\n\t\t\tif (object.id) {\r\n\t\t\t\t\t// eslint-disable-next-line no-underscore-dangle\r\n\t\t\t\t\treturn `${object.__typename}-${object.id}`;\r\n\t\t\t}\r\n\t\t\tif(object.email) {\r\n\t\t\t\treturn `${object.__typename}-${object.email}`;\r\n\t\t\t}\r\n\t\t\tif (object.cursor) {\r\n\t\t\t\t\t// Cursor edge instead, fixes invalid duplicate\r\n\t\t\t\t\t// eslint-disable-next-line no-underscore-dangle\r\n\t\t\t\t\treturn `${object.__typename}-${object.cursor}`;\r\n\t\t\t}\r\n\t\t\t// Use a fallback to default handling if neither id nor cursor\r\n\t\t\treturn defaultDataIdFromObject(object);\r\n\t\t}\r\n\t})\r\n});\r\n\r\n// This function lets us use async/await syntax before rendering React components\r\nasync function start() {\r\n\tconst localToken = await localStorage.getItem(\"token\");\r\n\tlet activeUser;\r\n\tif(localToken) {\r\n\t\ttry {\r\n\t\t\t// Check if token is valid\r\n\t\t\tconst verifyRequest = await fetch(`${Pikachure.URL}/verifyToken`, { headers: { authorization: localToken }});\r\n\t\t\tif(verifyRequest.status !== 200) {\r\n\t\t\t\tawait localStorage.removeItem(\"token\");\r\n\t\t\t} else {\r\n\t\t\t\tactiveUser = await verifyRequest.json();\r\n\t\t\t\tactiveUser = { ...activeUser, id: activeUser.sub };\r\n\t\t\t}\r\n\t\t} catch(error) {\r\n\t\t\tconsole.error(error);\r\n\t\t\tawait localStorage.removeItem(\"token\");\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction Routes(props) {\r\n\t\t// Set the User Context from the JWT token in storage\r\n\t\tconst [user, setUser] = useState(activeUser);\r\n\t\tconst [selectedPost, setSelectedPost] = useState();\r\n\r\n\t\tConfigProvider.config({\r\n\t\t\ttheme: {\r\n\t\t\t\tprimaryColor: \"#fdc541\",\r\n\t\t\t\t/**\r\n\t\t\t\t * @primary-color: #1890ff; // primary color for all components\r\n\t\t\t\t * @link-color: #1890ff; // link color\r\n\t\t\t\t * @success-color: #52c41a; // success state color\r\n\t\t\t\t * @warning-color: #faad14; // warning state color\r\n\t\t\t\t * @error-color: #f5222d; // error state color\r\n\t\t\t\t * @font-size-base: 14px; // major text font size\r\n\t\t\t\t * @heading-color: rgba(0, 0, 0, 0.85); // heading text color\r\n\t\t\t\t * @text-color: rgba(0, 0, 0, 0.65); // major text color\r\n\t\t\t\t * @text-color-secondary: rgba(0, 0, 0, 0.45); // secondary text color\r\n\t\t\t\t * @disabled-color: rgba(0, 0, 0, 0.25); // disable state color\r\n\t\t\t\t * @border-radius-base: 2px; // major border radius\r\n\t\t\t\t * @border-color-base: #d9d9d9; // major border color\r\n\t\t\t\t * @box-shadow-base: 0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 6px 16px 0 rgba(0, 0, 0, 0.08),\r\n\t\t\t\t\t\t0 9px 28px 8px rgba(0, 0, 0, 0.05); // major shadow for layers\r\n\t\t\t\t */\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<ContextUser.Provider value={[user, setUser]}>\r\n\t\t\t\t<ContextSelectedPost.Provider value={[selectedPost, setSelectedPost]}>\r\n\t\t\t\t\t<HashRouter>\r\n\t\t\t\t\t\t<Switch>\r\n\t\t\t\t\t\t\t<Route exact path=\"/settings\" component={Settings} />\r\n\t\t\t\t\t\t\t<Route exact path=\"/explore\" component={Explore} />\r\n\t\t\t\t\t\t\t<Route path=\"/profile/:tag?\" component={Home} />\r\n\t\t\t\t\t\t\t<Route path=\"/comments/:post\" component={Comments} />\r\n\t\t\t\t\t\t\t<Route path=\"/\" component={Root} />\r\n\t\t\t\t\t\t</Switch>\r\n\t\t\t\t\t</HashRouter>\r\n\t\t\t\t</ContextSelectedPost.Provider>\r\n\t\t\t</ContextUser.Provider>\r\n\t\t);\r\n\t}\r\n\r\n\tReactDOM.render(\r\n\t\t<ApolloProvider client={client}>\r\n\t\t\t<ParallaxProvider>\r\n\t\t\t\t<Routes />\r\n\t\t\t</ParallaxProvider>\r\n\t\t</ApolloProvider>,\r\n\t\tdocument.getElementById(\"root\")\r\n\t);\r\n\r\n\t\r\n\t// If you want to start measuring performance in your app, pass a function\r\n\t// to log results (for example: reportWebVitals(console.log))\r\n\t// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\n\tconst reportWebVitals = onPerfEntry => {\r\n\t\tif (onPerfEntry && onPerfEntry instanceof Function) {\r\n\t\t\timport(\"web-vitals\").then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n\t\t\t\tgetCLS(onPerfEntry);\r\n\t\t\t\tgetFID(onPerfEntry);\r\n\t\t\t\tgetFCP(onPerfEntry);\r\n\t\t\t\tgetLCP(onPerfEntry);\r\n\t\t\t\tgetTTFB(onPerfEntry);\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\treportWebVitals();\r\n}\r\n\r\nstart();\r\n\r\n\r\n"],"sourceRoot":""}